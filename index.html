<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generador de Contenido YouTube - Ollama</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      height: 100%;
      background: #0f172a;
    }

    body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #581c87 50%, #0f172a 100%);
      background-attachment: fixed;
      background-repeat: no-repeat;
      background-size: 100% 100%;
    }

    #root {
      min-height: 100vh;
      background: transparent;
    }

    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateX(100%);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes progress {
      from {
        width: 100%;
      }

      to {
        width: 0%;
      }
    }

    .animate-fade-in {
      animation: fade-in 0.5s ease-out;
    }

    .animate-progress {
      animation: progress 8s linear;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Iconos simples como componentes
    const Play = () => (
      <svg className="w-8 h-8 text-red-500" viewBox="0 0 24 24" fill="currentColor">
        <path d="M8 5v14l11-7z" />
      </svg>
    );
    const Zap = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
      </svg>
    );
    const Edit3 = () => <span>‚úèÔ∏è</span>;
    const Download = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7,10 12,15 17,10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
    );
    const Loader2 = ({ className }) => (
      <svg
        className={className}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth="2"
      >
        <path d="M21 12a9 9 0 11-6.219-8.56" />
      </svg>
    );
    const ChevronRight = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="9,18 15,12 9,6"></polyline>
      </svg>
    );
    const Eye = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
        <circle cx="12" cy="12" r="3"></circle>
      </svg>
    );
    const EyeOff = () => <span>üôà</span>;
    const X = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );

    const Star = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"></polygon>
      </svg>
    );

    const StarFilled = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2">
        <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"></polygon>
      </svg>
    );

    const History = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
        <path d="M3 3v5h5"></path>
        <path d="M12 7v5l4 2"></path>
      </svg>
    );

    const RotateCcw = () => (
      <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
        <path d="M3 3v5h5"></path>
      </svg>
    );

    // Icono de Dashboard
    const Dashboard = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
        <line x1="9" y1="9" x2="9" y2="15" />
        <line x1="15" y1="9" x2="15" y2="15" />
        <line x1="9" y1="12" x2="15" y2="12" />
      </svg>
    );

    // Icono de TrendingUp
    const TrendingUp = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
        <polyline points="17 6 23 6 23 12" />
      </svg>
    );

    // Icono de BarChart
    const BarChart = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="12" y1="20" x2="12" y2="10" />
        <line x1="18" y1="20" x2="18" y2="4" />
        <line x1="6" y1="20" x2="6" y2="16" />
      </svg>
    );

    // Icono de Users
    const Users = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
        <circle cx="9" cy="7" r="4" />
        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
      </svg>
    );

    // Icono de Clock
    const Clock = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="12" cy="12" r="10" />
        <polyline points="12,6 12,12 16,14" />
      </svg>
    );

    // Icono de Target
    const Target = () => (
      <svg className="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="12" cy="12" r="10" />
        <circle cx="12" cy="12" r="6" />
        <circle cx="12" cy="12" r="2" />
      </svg>
    );

    // Componente StatCard
    const StatCard = ({ title, value, icon, color, subtitle, trend }) => {
      const colorClasses = {
        purple: 'bg-purple-600',
        blue: 'bg-blue-600',
        green: 'bg-green-600',
        yellow: 'bg-yellow-600',
        red: 'bg-red-600',
        orange: 'bg-orange-600'
      };

      return (
        <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 border border-slate-700 hover:border-purple-500/50 transition-all duration-300">
          <div className="flex items-center justify-between mb-4">
            <div className={`w-12 h-12 ${colorClasses[color]} rounded-xl flex items-center justify-center`}>
              {icon}
            </div>
            {trend && (
              <div className={`flex items-center text-sm ${trend > 0 ? 'text-green-400' : trend < 0 ? 'text-red-400' : 'text-slate-400'}`}>
                {trend > 0 ? '‚Üó' : trend < 0 ? '‚Üò' : '‚Üí'} {Math.abs(trend)}%
              </div>
            )}
          </div>
          <div className="space-y-1">
            <div className="text-3xl font-bold text-white">{value}</div>
            <div className="text-slate-300 font-medium">{title}</div>
            {subtitle && <div className="text-slate-400 text-sm">{subtitle}</div>}
          </div>
        </div>
      );
    };

    // Componente QuickAccessButton
    const QuickAccessButton = ({ icon, title, subtitle, onClick, color, disabled = false }) => {
      const colorClasses = {
        purple: 'from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800',
        blue: 'from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800',
        green: 'from-green-600 to-green-700 hover:from-green-700 hover:to-green-800',
        yellow: 'from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800',
        orange: 'from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800',
        red: 'from-red-600 to-red-700 hover:from-red-700 hover:to-red-800'
      };

      return (
        <button
          onClick={onClick}
          disabled={disabled}
          className={`${disabled ? 'opacity-50 cursor-not-allowed' : 'hover:scale-105'} 
        bg-gradient-to-br ${colorClasses[color]} 
        text-white p-6 rounded-2xl transition-all duration-300 
        border border-slate-600 hover:border-slate-500 shadow-lg group`}
        >
          <div className="flex flex-col items-center space-y-3">
            <div className="w-12 h-12 flex items-center justify-center bg-white/20 rounded-xl group-hover:bg-white/30 transition-colors">
              {icon}
            </div>
            <div className="text-center">
              <div className="font-semibold text-lg">{title}</div>
              <div className="text-sm opacity-90">{subtitle}</div>
            </div>
          </div>
        </button>
      );
    };

    // Componente ActivityChart (simple bar chart)
    const ActivityChart = ({ data, language }) => {
      const isSpanish = language === 'espa√±ol';
      const maxValue = Math.max(...data.map(d => d.value), 1);

      // Calcular los d√≠as de la semana en orden, terminando en el d√≠a actual
      const weekDaysEs = ['Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b', 'Dom'];
      const weekDaysEn = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
      const today = new Date();
      const dayIndex = today.getDay(); // 0 (Domingo) ... 6 (S√°bado)
      // Ajustar para que el array termine en el d√≠a actual
      const days = isSpanish
        ? [...weekDaysEs.slice((dayIndex + 6) % 7 + 1), ...weekDaysEs.slice(0, (dayIndex + 6) % 7 + 1)]
        : [...weekDaysEn.slice((dayIndex + 6) % 7 + 1), ...weekDaysEn.slice(0, (dayIndex + 6) % 7 + 1)];

      return (
        <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 border border-slate-700">
          <h3 className="text-xl font-bold text-white mb-6 flex items-center">
            <TrendingUp className="w-5 h-5 mr-2 text-blue-400" />
            {isSpanish ? 'Actividad de la Semana' : 'Weekly Activity'}
          </h3>

          <div className="space-y-4">
            {data.map((item, index) => (
              <div key={index} className="flex items-center space-x-4">
                <div className="w-12 text-sm text-slate-400 font-medium">
                  {days[index] || `D${index + 1}`}
                </div>
                <div className="flex-1 bg-slate-700 rounded-full h-3 relative overflow-hidden">
                  <div
                    className="bg-gradient-to-r from-blue-500 to-purple-500 h-full rounded-full transition-all duration-500"
                    style={{ width: `${(item.value / maxValue) * 100}%` }}
                  />
                </div>
                <div className="w-8 text-sm text-slate-300 font-mono text-right">
                  {item.value}
                </div>
              </div>
            ))}
          </div>

          <div className="mt-4 pt-4 border-t border-slate-600">
            <div className="flex justify-between text-sm text-slate-400">
              <span>{isSpanish ? 'Total:' : 'Total:'} {data.reduce((sum, item) => sum + item.value, 0)}</span>
              <span>{isSpanish ? 'Promedio:' : 'Average:'} {(data.reduce((sum, item) => sum + item.value, 0) / 7).toFixed(1)}</span>
            </div>
          </div>
        </div>
      );
    };

    // Componente RecentGenerations
    const RecentGenerations = ({ generations, onLoad, onShowHistory, language }) => {
      const isSpanish = language === 'espa√±ol';
      const recentGens = generations.slice(0, 5);

      return (
        <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 border border-slate-700">
          <h3 className="text-xl font-bold text-white mb-6 flex items-center">
            <History className="w-5 h-5 mr-2 text-green-400" />
            {isSpanish ? 'Generaciones Recientes' : 'Recent Generations'}
          </h3>

          {recentGens.length === 0 ? (
            <div className="text-center py-8">
              <div className="w-16 h-16 mx-auto mb-4 bg-slate-700 rounded-full flex items-center justify-center">
                <History className="w-8 h-8 text-slate-400" />
              </div>
              <p className="text-slate-400">
                {isSpanish ? 'No hay generaciones a√∫n' : 'No generations yet'}
              </p>
            </div>
          ) : (
            <div className="space-y-3">
              {recentGens.map((gen) => (
                <div className="flex items-start justify-between gap-3">
                  <div className="flex-1 min-w-0">
                    <h4 className="text-white font-medium text-sm mb-1 truncate">
                      {gen.formData.topic}
                    </h4>
                    <div className="flex items-center flex-wrap gap-2 text-xs text-slate-400">
                      <span className="bg-blue-600/20 text-blue-300 px-2 py-1 rounded whitespace-nowrap">
                        {gen.formData.category}
                      </span>
                      <span className="whitespace-nowrap">{new Date(gen.timestamp).toLocaleDateString()}</span>
                      {gen.isFavorite && <span className="text-yellow-400">‚≠ê</span>}
                    </div>
                  </div>
                  <button
                    onClick={() => onLoad(gen)}
                    className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-xs transition-colors flex-shrink-0"
                  >
                    {isSpanish ? 'Ver' : 'View'}
                  </button>
                </div>
              ))}
            </div>
          )}

          {recentGens.length > 0 && (
            <div className="mt-4 pt-4 border-t border-slate-600 text-center">
              <button
                onClick={onShowHistory}  // USAR LA PROP EN SU LUGAR
                className="text-purple-400 hover:text-purple-300 text-sm font-medium transition-colors"
              >
                {isSpanish ? 'Ver todo el historial ‚Üí' : 'View all history ‚Üí'}
              </button>
            </div>
          )}
        </div>
      );
    };

    // Componente CategoryBreakdown
    const CategoryBreakdown = ({ categories, language }) => {
      const isSpanish = language === 'espa√±ol';
      const sortedCategories = Object.entries(categories)
        .sort(([, a], [, b]) => b - a)
        .slice(0, 5);

      const total = Object.values(categories).reduce((sum, val) => sum + val, 0);
      const maxValue = Math.max(...Object.values(categories), 1);

      return (
        <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 border border-slate-700">
          <h3 className="text-xl font-bold text-white mb-6 flex items-center">
            <BarChart className="w-5 h-5 mr-2 text-orange-400" />
            {isSpanish ? 'Categor√≠as Populares' : 'Popular Categories'}
          </h3>

          {sortedCategories.length === 0 ? (
            <div className="text-center py-8">
              <div className="w-16 h-16 mx-auto mb-4 bg-slate-700 rounded-full flex items-center justify-center">
                <BarChart className="w-8 h-8 text-slate-400" />
              </div>
              <p className="text-slate-400">
                {isSpanish ? 'Sin datos a√∫n' : 'No data yet'}
              </p>
            </div>
          ) : (
            <div className="space-y-4">
              {sortedCategories.map(([category, count], index) => {
                const percentage = total > 0 ? (count / total * 100) : 0;
                const colors = ['bg-purple-500', 'bg-blue-500', 'bg-green-500', 'bg-yellow-500', 'bg-red-500'];

                return (
                  <div key={category} className="flex items-center space-x-4">
                    <div className="w-4 text-sm text-slate-400 font-bold">
                      #{index + 1}
                    </div>
                    <div className="flex-1">
                      <div className="flex justify-between items-center mb-1">
                        <span className="text-slate-200 text-sm font-medium">{category}</span>
                        <span className="text-slate-400 text-xs">{count} ({percentage.toFixed(0)}%)</span>
                      </div>
                      <div className="bg-slate-700 rounded-full h-2 overflow-hidden">
                        <div
                          className={`${colors[index]} h-full rounded-full transition-all duration-500`}
                          style={{ width: `${(count / maxValue) * 100}%` }}
                        />
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      );
    };

    // Componente ModelUsage
    const ModelUsage = ({ models, language }) => {
      const isSpanish = language === 'espa√±ol';
      const sortedModels = Object.entries(models)
        .sort(([, a], [, b]) => b - a)
        .slice(0, 3);

      const total = Object.values(models).reduce((sum, val) => sum + val, 0);

      return (
        <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-6 border border-slate-700">
          <h3 className="text-xl font-bold text-white mb-6 flex items-center">
            <svg className="w-5 h-5 mr-2 text-cyan-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
              <rect x="2" y="3" width="20" height="14" rx="2" ry="2" />
              <line x1="8" y1="21" x2="16" y2="21" />
              <line x1="12" y1="17" x2="12" y2="21" />
            </svg>
            {isSpanish ? 'Modelos Utilizados' : 'Models Used'}
          </h3>

          {sortedModels.length === 0 ? (
            <div className="text-center py-8">
              <p className="text-slate-400">
                {isSpanish ? 'Sin datos a√∫n' : 'No data yet'}
              </p>
            </div>
          ) : (
            <div className="space-y-4">
              {sortedModels.map(([model, count], index) => {
                const percentage = total > 0 ? (count / total * 100) : 0;

                return (
                  <div key={model} className="bg-slate-900/50 rounded-lg p-4">
                    <div className="flex justify-between items-center mb-2">
                      <code className="text-cyan-300 text-sm font-mono">{model}</code>
                      <span className="text-slate-400 text-sm">{count} {isSpanish ? 'usos' : 'uses'}</span>
                    </div>
                    <div className="bg-slate-700 rounded-full h-2 overflow-hidden">
                      <div
                        className="bg-gradient-to-r from-cyan-500 to-blue-500 h-full rounded-full transition-all duration-500"
                        style={{ width: `${percentage}%` }}
                      />
                    </div>
                    <div className="text-xs text-slate-500 mt-1">{percentage.toFixed(1)}%</div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      );
    };

    const DashboardMain = ({
      onNavigateToGenerator,
      onShowHistory,
      onShowFavorites,
      onShowIdeaGenerator,
      onShowInstallGuide,
      dashboardData,
      scriptHistory,
      favoriteScripts,
      onLoadFromHistory,
      language
    }) => {
      const isSpanish = language === 'espa√±ol';

      const handleShowIdeaGenerator = () => {
        onShowIdeaGenerator();
      };

      // Calcular estad√≠sticas en tiempo real
      const stats = {
        totalGenerations: scriptHistory.length,
        favoriteCount: favoriteScripts.length,
        totalWords: scriptHistory.reduce((sum, gen) => {
          return sum + (gen.results?.script?.split(' ').length || 0);
        }, 0),
        avgWordsPerScript: scriptHistory.length > 0 ?
          Math.round(scriptHistory.reduce((sum, gen) => {
            return sum + (gen.results?.script?.split(' ').length || 0);
          }, 0) / scriptHistory.length) : 0,
        thisWeekGenerations: scriptHistory.filter(gen => {
          const genDate = new Date(gen.timestamp);
          const weekAgo = new Date();
          weekAgo.setDate(weekAgo.getDate() - 7);
          return genDate >= weekAgo;
        }).length,
        categories: scriptHistory.reduce((acc, gen) => {
          const cat = gen.formData.category;
          acc[cat] = (acc[cat] || 0) + 1;
          return acc;
        }, {}),
        models: scriptHistory.reduce((acc, gen) => {
          const model = gen.formData.model;
          acc[model] = (acc[model] || 0) + 1;
          return acc;
        }, {})
      };

      // Generar datos de actividad semanal
      const weeklyActivity = Array.from({ length: 7 }, (_, i) => {
        const date = new Date();
        date.setDate(date.getDate() - (6 - i)); // Empezar desde hace 6 d√≠as hasta hoy
        const dayGenerations = scriptHistory.filter(gen => {
          const genDate = new Date(gen.timestamp);
          // Comparar solo las fechas sin considerar la hora
          const genDateOnly = new Date(genDate.getFullYear(), genDate.getMonth(), genDate.getDate());
          const checkDateOnly = new Date(date.getFullYear(), date.getMonth(), date.getDate());
          return genDateOnly.getTime() === checkDateOnly.getTime();
        }).length;

        return {
          date: date.toISOString().split('T')[0],
          value: dayGenerations
        };
      });

      // Calcular tendencias
      const lastWeekGens = scriptHistory.filter(gen => {
        const genDate = new Date(gen.timestamp);
        const twoWeeksAgo = new Date();
        twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
        const weekAgo = new Date();
        weekAgo.setDate(weekAgo.getDate() - 7);
        return genDate >= twoWeeksAgo && genDate < weekAgo;
      }).length;

      const weekTrend = lastWeekGens > 0 ?
        Math.round(((stats.thisWeekGenerations - lastWeekGens) / lastWeekGens) * 100) :
        stats.thisWeekGenerations > 0 ? 100 : 0;

      return (
        <div className="space-y-8">
          {/* Header con saludo */}
          <div className="text-center mb-12">
            {stats.totalGenerations > 0 && (
              <div className="mt-4 inline-flex items-center bg-purple-600/20 border border-purple-500/30 rounded-full px-4 py-2">
                <span className="text-purple-300 text-sm">
                  {isSpanish ?
                    `¬°Has generado ${stats.totalGenerations} guiones con ${stats.totalWords.toLocaleString()} palabras!` :
                    `You've generated ${stats.totalGenerations} scripts with ${stats.totalWords.toLocaleString()} words!`
                  }
                </span>
              </div>
            )}
          </div>

          {/* Estad√≠sticas principales */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <StatCard
              title={isSpanish ? "Total Generaciones" : "Total Generations"}
              value={stats.totalGenerations.toLocaleString()}
              subtitle={isSpanish ? "guiones creados" : "scripts created"}
              icon={<Target className="w-6 h-6 text-white" />}
              color="purple"
              trend={weekTrend}
            />

            <StatCard
              title={isSpanish ? "Favoritos" : "Favorites"}
              value={stats.favoriteCount.toLocaleString()}
              subtitle={isSpanish ? "guiones guardados" : "saved scripts"}
              icon={<StarFilled className="w-6 h-6 text-white" />}
              color="yellow"
            />

            <StatCard
              title={isSpanish ? "Esta Semana" : "This Week"}
              value={stats.thisWeekGenerations.toLocaleString()}
              subtitle={isSpanish ? "nuevas generaciones" : "new generations"}
              icon={<TrendingUp className="w-6 h-6 text-white" />}
              color="green"
              trend={weekTrend}
            />

            <StatCard
              title={isSpanish ? "Promedio Palabras" : "Average Words"}
              value={stats.avgWordsPerScript.toLocaleString()}
              subtitle={isSpanish ? "por gui√≥n" : "per script"}
              icon={<Edit3 className="w-6 h-6 text-white" />}
              color="blue"
            />
          </div>

          {/* Botones de acceso r√°pido */}
          <div className="bg-slate-800/30 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
            <h2 className="text-2xl font-bold text-white mb-6 text-center">
              {isSpanish ? "üöÄ Acceso R√°pido" : "üöÄ Quick Access"}
            </h2>

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              <QuickAccessButton
                icon={<Zap className="w-6 h-6" />}
                title={isSpanish ? "Nuevo Proyecto" : "New Project"}
                subtitle={isSpanish ? "Crear contenido desde cero" : "Create content from scratch"}
                onClick={onNavigateToGenerator}
                color="purple"
              />

              <QuickAccessButton
                icon={<svg className="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z" />
                </svg>}
                title={isSpanish ? "Generador Ideas" : "Idea Generator"}
                subtitle={isSpanish ? "10 ideas √∫nicas por tema" : "10 unique ideas per topic"}
                onClick={onShowIdeaGenerator}
                color="orange"
              />

              <QuickAccessButton
                icon={<History className="w-6 h-6" />}
                title={isSpanish ? "Historial" : "History"}
                subtitle={`${scriptHistory.length} ${isSpanish ? 'generaciones' : 'generations'}`}
                onClick={onShowHistory}
                color="blue"
              />

              <QuickAccessButton
                icon={<StarFilled className="w-6 h-6" />}
                title={isSpanish ? "Favoritos" : "Favorites"}
                subtitle={`${favoriteScripts.length} ${isSpanish ? 'guardados' : 'saved'}`}
                onClick={onShowFavorites}
                color="yellow"
              />

              <QuickAccessButton
                icon={<svg className="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                  <polyline points="14,2 14,8 20,8" />
                  <line x1="16" y1="13" x2="8" y2="13" />
                  <line x1="16" y1="17" x2="8" y2="17" />
                  <polyline points="10,9 9,9 8,9" />
                </svg>}
                title={isSpanish ? "Gu√≠a Setup" : "Setup Guide"}
                subtitle={isSpanish ? "Configurar Ollama" : "Configure Ollama"}
                onClick={onShowInstallGuide}
                color="green"
              />

              <QuickAccessButton
                icon={<Download className="w-6 h-6" />}
                title={isSpanish ? "Exportar Todo" : "Export All"}
                subtitle={isSpanish ? "Descargar historial" : "Download history"}
                onClick={() => {
                  const exportData = {
                    totalGenerations: stats.totalGenerations,
                    scriptHistory: scriptHistory,
                    favorites: favoriteScripts,
                    exportDate: new Date().toISOString()
                  };

                  const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                  const url = URL.createObjectURL(blob);
                  const a = document.createElement('a');
                  a.href = url;
                  a.download = `youtube-generator-backup-${new Date().toISOString().split('T')[0]}.json`;
                  document.body.appendChild(a);
                  a.click();
                  document.body.removeChild(a);
                  URL.revokeObjectURL(url);
                }}
                color="red"
              />
            </div>
          </div>

          {/* Secci√≥n de estad√≠sticas detalladas */}
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            {/* Actividad semanal */}
            <ActivityChart data={weeklyActivity} language={language} />

            {/* Generaciones recientes */}
            <RecentGenerations
              generations={scriptHistory}
              onLoad={onLoadFromHistory}
              onShowHistory={onShowHistory}
              language={language}
            />
          </div>

          {/* An√°lisis detallado */}
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            {/* Breakdown de categor√≠as */}
            <CategoryBreakdown categories={stats.categories} language={language} />

            {/* Modelos utilizados */}
            <ModelUsage models={stats.models} language={language} />
          </div>

          {/* Motivaci√≥n y tips */}
          {stats.totalGenerations === 0 ? (
            <div className="bg-gradient-to-r from-purple-900/50 to-pink-900/50 backdrop-blur-sm rounded-2xl p-8 border border-purple-500/30">
              <div className="text-center">
                <div className="w-16 h-16 mx-auto mb-4 bg-purple-600 rounded-full flex items-center justify-center">
                  <Zap className="w-8 h-8 text-white" />
                </div>
                <h3 className="text-2xl font-bold text-white mb-3">
                  {isSpanish ? "¬°Bienvenido al Generador!" : "Welcome to the Generator!"}
                </h3>
                <p className="text-purple-200 mb-6">
                  {isSpanish ?
                    "Est√°s a un clic de crear contenido incre√≠ble. ¬°Comienza tu primer proyecto ahora!" :
                    "You're one click away from creating amazing content. Start your first project now!"
                  }
                </p>
                <button
                  onClick={onNavigateToGenerator}
                  className="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-8 py-3 rounded-lg font-medium transition-colors"
                >
                  {isSpanish ? "üöÄ Crear Mi Primer Gui√≥n" : "üöÄ Create My First Script"}
                </button>
              </div>
            </div>
          ) : stats.totalGenerations >= 10 ? (
            <div className="bg-gradient-to-r from-green-900/50 to-emerald-900/50 backdrop-blur-sm rounded-2xl p-8 border border-green-500/30">
              <div className="text-center">
                <div className="w-16 h-16 mx-auto mb-4 bg-green-600 rounded-full flex items-center justify-center">
                  <Target className="w-8 h-8 text-white" />
                </div>
                <h3 className="text-2xl font-bold text-white mb-3">
                  {isSpanish ? "¬°Eres un Creador Prol√≠fico!" : "You're a Prolific Creator!"}
                </h3>
                <p className="text-green-200">
                  {isSpanish ?
                    `Has generado ${stats.totalGenerations} guiones. ¬°Sigue as√≠, est√°s en racha!` :
                    `You've generated ${stats.totalGenerations} scripts. Keep it up, you're on a roll!`
                  }
                </p>
              </div>
            </div>
          ) : (
            <div className="bg-gradient-to-r from-blue-900/50 to-cyan-900/50 backdrop-blur-sm rounded-2xl p-8 border border-blue-500/30">
              <div className="text-center">
                <div className="w-16 h-16 mx-auto mb-4 bg-blue-600 rounded-full flex items-center justify-center">
                  <TrendingUp className="w-8 h-8 text-white" />
                </div>
                <h3 className="text-2xl font-bold text-white mb-3">
                  {isSpanish ? "¬°Excelente Progreso!" : "Great Progress!"}
                </h3>
                <p className="text-blue-200">
                  {isSpanish ?
                    `Llevas ${stats.totalGenerations} guiones generados. ¬°Cada uno te acerca m√°s a tu meta!` :
                    `You have ${stats.totalGenerations} scripts generated. Each one brings you closer to your goal!`
                  }
                </p>
              </div>
            </div>
          )}
        </div>
      );
    };

    // Componente Matrix Effect
    const MatrixEffect = () => {
      useEffect(() => {
        const canvas = document.getElementById('matrix-canvas');
        if (!canvas) return;

        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const matrix = "ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%+-/~{[|`]}";
        const matrixArray = matrix.split("");

        const fontSize = 10;
        const columns = canvas.width / fontSize;
        const drops = [];

        for (let x = 0; x < columns; x++) {
          drops[x] = 1;
        }

        const draw = () => {
          ctx.fillStyle = 'rgba(0, 0, 0, 0.04)';
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          ctx.fillStyle = '#0F0';
          ctx.font = fontSize + 'px monospace';

          for (let i = 0; i < drops.length; i++) {
            const text = matrixArray[Math.floor(Math.random() * matrixArray.length)];
            ctx.fillText(text, i * fontSize, drops[i] * fontSize);

            if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
              drops[i] = 0;
            }
            drops[i]++;
          }
        };

        const interval = setInterval(draw, 35);

        return () => clearInterval(interval);
      }, []);

      return (
        <canvas
          id="matrix-canvas"
          className="fixed inset-0 z-50 pointer-events-none"
          style={{ background: 'transparent' }}
        />
      );
    };

    // Componente Pong Game Mejorado
    const PongGame = ({ onClose }) => {
      const canvasRef = useRef(null);
      const gameRef = useRef(null);
      const [score, setScore] = useState({ player: 0, computer: 0 });
      const [gameRunning, setGameRunning] = useState(true);

      useEffect(() => {
        const canvas = canvasRef.current;
        if (!canvas) return;

        const ctx = canvas.getContext('2d');
        canvas.width = 800;
        canvas.height = 400;

        // Game objects
        const game = {
          ball: {
            x: canvas.width / 2,
            y: canvas.height / 2,
            dx: 3,
            dy: 3,
            radius: 8,
            baseSpeed: 3,
            maxSpeed: 8
          },
          playerPaddle: {
            x: 10,
            y: canvas.height / 2 - 50,
            width: 10,
            height: 100,
            dy: 0
          },
          computerPaddle: {
            x: canvas.width - 20,
            y: canvas.height / 2 - 50,
            width: 10,
            height: 100
          },
          rallies: 0 // Contador para aumentar velocidad
        };

        gameRef.current = game;

        // Controls
        const keys = {};
        const handleKeyDown = (e) => {
          keys[e.key] = true;
        };
        const handleKeyUp = (e) => {
          keys[e.key] = false;
        };

        window.addEventListener('keydown', handleKeyDown);
        window.addEventListener('keyup', handleKeyUp);

        // Funci√≥n para resetear la pelota
        const resetBall = (toPlayer = false) => {
          game.ball.x = canvas.width / 2;
          game.ball.y = canvas.height / 2;

          // Resetear velocidad al valor base
          game.ball.dx = toPlayer ? -game.ball.baseSpeed : game.ball.baseSpeed;
          game.ball.dy = (Math.random() - 0.5) * 4; // Direcci√≥n Y aleatoria
          game.rallies = 0; // Resetear contador
        };

        // Game loop
        const gameLoop = () => {
          if (!gameRunning) return;

          // Clear canvas
          ctx.fillStyle = '#0f172a';
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // Update player paddle
          if (keys['ArrowUp'] && game.playerPaddle.y > 0) {
            game.playerPaddle.y -= 8;
          }
          if (keys['ArrowDown'] && game.playerPaddle.y < canvas.height - game.playerPaddle.height) {
            game.playerPaddle.y += 8;
          }

          // Update computer paddle (IA m√°s torpe con errores)
          const paddleCenter = game.computerPaddle.y + game.computerPaddle.height / 2;
          const ballCenter = game.ball.y;
          const aiSpeed = 2; // Velocidad a√∫n m√°s reducida
          const aiError = 40; // Mayor margen de error

          // La IA solo "ve" la pelota cuando est√° cerca (simular reacci√≥n lenta)
          const reactionDistance = canvas.width * 0.6; // Solo reacciona cuando la pelota est√° al 60% del campo
          const ballComingToAI = game.ball.dx > 0; // Pelota viene hacia la IA

          // Agregar errores aleatorios a la IA
          const shouldMakeError = Math.random() < 0.15; // 15% de probabilidad de error por frame
          const confusionFactor = shouldMakeError ? (Math.random() - 0.5) * 60 : 0; // Error de hasta 30px en cualquier direcci√≥n

          // La IA a veces se mueve en direcci√≥n contraria (confusi√≥n)
          const shouldConfuse = Math.random() < 0.08; // 8% de probabilidad de confusi√≥n
          const confusionMultiplier = shouldConfuse ? -1 : 1;

          // Solo mover si la pelota est√° lo suficientemente cerca Y viene hacia la IA
          if (ballComingToAI && game.ball.x > reactionDistance) {
            const targetY = ballCenter + confusionFactor;
            const distance = Math.abs(paddleCenter - targetY);

            // Solo mover si la diferencia es significativa
            if (distance > aiError) {
              if (paddleCenter < targetY) {
                game.computerPaddle.y += aiSpeed * confusionMultiplier;
              } else if (paddleCenter > targetY) {
                game.computerPaddle.y -= aiSpeed * confusionMultiplier;
              }
            }
          }

          // A veces la IA se "congela" por un momento
          const shouldFreeze = Math.random() < 0.05; // 5% de probabilidad de congelarse
          if (shouldFreeze) {
            // No mover en este frame (simula lag o indecisi√≥n)
          }

          // Limitar movimiento de la IA
          if (game.computerPaddle.y < 0) game.computerPaddle.y = 0;
          if (game.computerPaddle.y > canvas.height - game.computerPaddle.height) {
            game.computerPaddle.y = canvas.height - game.computerPaddle.height;
          }

          // Update ball
          game.ball.x += game.ball.dx;
          game.ball.y += game.ball.dy;

          // Ball collision with top/bottom
          if (game.ball.y <= game.ball.radius || game.ball.y >= canvas.height - game.ball.radius) {
            game.ball.dy = -game.ball.dy;
          }

          // Ball collision with player paddle
          if (
            game.ball.x <= game.playerPaddle.x + game.playerPaddle.width &&
            game.ball.x >= game.playerPaddle.x &&
            game.ball.y >= game.playerPaddle.y &&
            game.ball.y <= game.playerPaddle.y + game.playerPaddle.height &&
            game.ball.dx < 0
          ) {
            // Calcular nueva direcci√≥n basada en d√≥nde golpea la pelota
            const hitPos = (game.ball.y - game.playerPaddle.y) / game.playerPaddle.height;
            const angle = (hitPos - 0.5) * Math.PI / 3; // √Ångulo m√°ximo de 60 grados

            const speed = Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy);
            game.ball.dx = Math.abs(speed * Math.cos(angle));
            game.ball.dy = speed * Math.sin(angle);

            game.ball.x = game.playerPaddle.x + game.playerPaddle.width + game.ball.radius;
            game.rallies++;

            // Aumentar velocidad gradualmente cada 3 golpes
            if (game.rallies % 3 === 0) {
              const currentSpeed = Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy);
              if (currentSpeed < game.ball.maxSpeed) {
                const speedMultiplier = 1.1;
                game.ball.dx *= speedMultiplier;
                game.ball.dy *= speedMultiplier;
              }
            }
          }

          // Ball collision with computer paddle
          if (
            game.ball.x >= game.computerPaddle.x - game.ball.radius &&
            game.ball.x <= game.computerPaddle.x &&
            game.ball.y >= game.computerPaddle.y &&
            game.ball.y <= game.computerPaddle.y + game.computerPaddle.height &&
            game.ball.dx > 0
          ) {
            // Calcular nueva direcci√≥n basada en d√≥nde golpea la pelota
            const hitPos = (game.ball.y - game.computerPaddle.y) / game.computerPaddle.height;
            const angle = (hitPos - 0.5) * Math.PI / 3;

            const speed = Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy);
            game.ball.dx = -Math.abs(speed * Math.cos(angle));
            game.ball.dy = speed * Math.sin(angle);

            game.ball.x = game.computerPaddle.x - game.ball.radius;
            game.rallies++;

            // Aumentar velocidad gradualmente cada 3 golpes
            if (game.rallies % 3 === 0) {
              const currentSpeed = Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy);
              if (currentSpeed < game.ball.maxSpeed) {
                const speedMultiplier = 1.1;
                game.ball.dx *= speedMultiplier;
                game.ball.dy *= speedMultiplier;
              }
            }
          }

          // Score
          if (game.ball.x < 0) {
            setScore(prev => ({ ...prev, computer: prev.computer + 1 }));
            resetBall(false); // Pelota va hacia la computadora
          }

          if (game.ball.x > canvas.width) {
            setScore(prev => ({ ...prev, player: prev.player + 1 }));
            resetBall(true); // Pelota va hacia el jugador
          }

          // Draw center line
          ctx.setLineDash([5, 15]);
          ctx.beginPath();
          ctx.moveTo(canvas.width / 2, 0);
          ctx.lineTo(canvas.width / 2, canvas.height);
          ctx.strokeStyle = '#475569';
          ctx.stroke();
          ctx.setLineDash([]);

          // Draw paddles
          ctx.fillStyle = '#e2e8f0';
          ctx.fillRect(game.playerPaddle.x, game.playerPaddle.y, game.playerPaddle.width, game.playerPaddle.height);
          ctx.fillRect(game.computerPaddle.x, game.computerPaddle.y, game.computerPaddle.width, game.computerPaddle.height);

          // Draw ball
          ctx.beginPath();
          ctx.arc(game.ball.x, game.ball.y, game.ball.radius, 0, Math.PI * 2);
          ctx.fillStyle = '#f59e0b';
          ctx.fill();

          // Draw speed indicator
          const currentSpeed = Math.sqrt(game.ball.dx * game.ball.dx + game.ball.dy * game.ball.dy);
          const speedPercent = ((currentSpeed - game.ball.baseSpeed) / (game.ball.maxSpeed - game.ball.baseSpeed)) * 100;

          // Draw AI status indicators (para debug/diversi√≥n)
          if (shouldMakeError) {
            ctx.fillStyle = '#ef4444';
            ctx.font = '12px monospace';
          }

          if (shouldConfuse) {
            ctx.fillStyle = '#f59e0b';
            ctx.font = '12px monospace';
          }

          if (shouldFreeze) {
            ctx.fillStyle = '#8b5cf6';
            ctx.font = '12px monospace';
          }

          // Mostrar si la IA puede "ver" la pelota
          if (!ballComingToAI || game.ball.x <= reactionDistance) {
            ctx.fillStyle = '#64748b';
            ctx.font = '10px monospace';
          }

          ctx.fillStyle = '#64748b';
          ctx.font = '14px monospace';
          ctx.fillText(`Speed: ${Math.round(speedPercent)}%`, 10, 30);
          ctx.fillText(`Rallies: ${game.rallies}`, 10, 50);

          requestAnimationFrame(gameLoop);
        };

        gameLoop();

        return () => {
          setGameRunning(false);
          window.removeEventListener('keydown', handleKeyDown);
          window.removeEventListener('keyup', handleKeyUp);
        };
      }, [gameRunning]);

      return (
        <div className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center">
          <div className="bg-slate-800 rounded-2xl p-6 border border-slate-600 max-w-4xl w-full mx-4">
            <div className="flex justify-between items-center mb-4">
              <h2 className="text-2xl font-bold text-white">üéÆ Pong Game</h2>
              <button
                onClick={() => {
                  setGameRunning(false);
                  onClose();
                }}
                className="text-slate-400 hover:text-white transition-colors"
              >
                <X />
              </button>
            </div>

            <div className="flex justify-center items-center space-x-8 mb-4">
              <div className="text-center">
                <div className="text-2xl font-bold text-blue-400">{score.player}</div>
                <div className="text-slate-300 text-sm">Player</div>
              </div>
              <div className="text-slate-500 text-xl font-bold">VS</div>
              <div className="text-center">
                <div className="text-2xl font-bold text-red-400">{score.computer}</div>
                <div className="text-slate-300 text-sm">Computer</div>
              </div>
            </div>

            <div className="flex justify-center mb-4">
              <canvas
                ref={canvasRef}
                className="border border-slate-600 rounded-lg bg-slate-900"
              />
            </div>

            <div className="text-center text-slate-400 text-sm">
              <p className="mb-2">üéØ Use arrow keys ‚Üë ‚Üì to control your paddle</p>
              <p className="mb-1">üí° Hit different parts of your paddle to change ball direction</p>
              <p>‚ö° Speed increases every 3 hits ‚Ä¢ First to 10 points wins!</p>
            </div>
          </div>
        </div>
      );
    };

    // Componente Tip Alert
    const TipAlert = ({ tip, onClose, language }) => {
      useEffect(() => {
        // Auto-cerrar despu√©s de 8 segundos
        const timer = setTimeout(() => {
          onClose();
        }, 8000);

        return () => clearTimeout(timer);
      }, [onClose]);

      return (
        <div className="fixed top-4 right-4 z-40 max-w-sm">
          <div className="bg-green-500 bg-opacity-20 backdrop-blur-sm border border-green-400 border-opacity-50 rounded-xl p-4 shadow-lg animate-fade-in">
            <div className="flex items-start justify-between">
              <div className="flex items-start space-x-3">
                <div className="flex-shrink-0">
                  <div className="w-6 h-6 bg-green-500 bg-opacity-30 rounded-full flex items-center justify-center">
                    <span className="text-green-300 text-sm">üí°</span>
                  </div>
                </div>
                <div className="flex-1">
                  <p className="text-green-100 text-sm font-medium mb-1">
                    {language === 'espa√±ol' ? '¬°Tip del d√≠a!' : 'Tip of the day!'}
                  </p>
                  <p className="text-green-200 text-sm leading-relaxed">
                    {tip}
                  </p>
                </div>
              </div>
              <button
                onClick={onClose}
                className="flex-shrink-0 text-green-300 hover:text-green-100 transition-colors ml-2"
                title={language === 'espa√±ol' ? 'Cerrar' : 'Close'}
              >
                <svg className="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>

            {/* Barra de progreso */}
            <div className="mt-3 w-full bg-green-800 bg-opacity-30 rounded-full h-1">
              <div className="bg-green-400 h-1 rounded-full animate-progress"></div>
            </div>
          </div>
        </div>
      );
    };

    // Componente Gu√≠a de Instalaci√≥n
    const InstallationGuide = ({ onClose, language }) => {
      const isSpanish = language === 'espa√±ol';

      return (
        <div className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4">
          <div className="bg-slate-800 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden border border-slate-600">
            {/* Header */}
            <div className="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-900">
              <h2 className="text-2xl font-bold text-white flex items-center">
                üìñ {isSpanish ? "Gu√≠a de Instalaci√≥n" : "Installation Guide"}
              </h2>
              <button
                onClick={onClose}
                className="text-slate-400 hover:text-white transition-colors"
              >
                <X />
              </button>
            </div>

            {/* Content */}
            <div className="p-6 overflow-y-auto max-h-[calc(90vh-80px)]">
              {isSpanish ? (
                <div className="space-y-8 text-slate-200">
                  {/* Paso 1 */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      üöÄ Paso 1: Preparar el Entorno de Desarrollo
                    </h3>

                    <div className="space-y-4">
                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">1. Instalar Visual Studio Code</h4>
                        <p className="text-sm mb-2">Descarga VS Code desde:</p>
                        <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">
                          https://code.visualstudio.com/
                        </code>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">2. Instalar Live Server</h4>
                        <ul className="text-sm space-y-1 list-disc list-inside">
                          <li>Abrir VS Code</li>
                          <li>Ir a Extensions (Ctrl+Shift+X)</li>
                          <li>Buscar "Live Server" por Ritwick Dey</li>
                          <li>Hacer clic en "Install"</li>
                        </ul>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">3. Ejecutar la aplicaci√≥n</h4>
                        <ul className="text-sm space-y-1 list-disc list-inside">
                          <li>Abrir el archivo <code className="bg-slate-800 px-1 rounded">index.html</code> en VS Code</li>
                          <li>Hacer clic en "Go Live" en la esquina inferior derecha</li>
                          <li>La aplicaci√≥n se abrir√° autom√°ticamente en tu navegador</li>
                        </ul>
                      </div>
                    </div>
                  </section>

                  {/* Paso 2 */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      ü§ñ Paso 2: Configurar Ollama
                    </h3>

                    <div className="space-y-4">
                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">1. Instalar Ollama</h4>
                        <div className="space-y-2 text-sm">
                          <div>
                            <strong>macOS:</strong>
                            <code className="bg-slate-800 px-2 py-1 rounded ml-2 text-blue-300">brew install ollama</code>
                          </div>
                          <div>
                            <strong>Linux:</strong>
                            <code className="bg-slate-800 px-2 py-1 rounded ml-2 text-blue-300">curl -fsSL https://ollama.com/install.sh | sh</code>
                          </div>
                          <div>
                            <strong>Windows:</strong> Descargar desde <code className="bg-slate-800 px-1 rounded text-blue-300">https://ollama.com/download/windows</code>
                          </div>
                        </div>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">2. Iniciar Ollama</h4>
                        <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama serve</code>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">3. Descargar modelos</h4>
                        <div className="space-y-2 text-sm">
                          <div>
                            <strong>Modelo principal (mejor para espa√±ol):</strong><br />
                            <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama pull gemma3n:e4b</code>
                          </div>
                          <div>
                            <strong>Modelos alternativos:</strong><br />
                            <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama pull mistral:7b</code><br />
                            <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama pull mistral-nemo:12b</code>
                          </div>
                        </div>
                      </div>
                    </div>
                  </section>

                  {/* Comandos */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      ‚å®Ô∏è Comandos y Atajos
                    </h3>

                    <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                          <h4 className="font-semibold text-green-400 mb-2">Atajos de la aplicaci√≥n:</h4>
                          <ul className="space-y-1">
                            <li><code className="bg-slate-800 px-1 rounded">Cmd/Ctrl + H</code> - Acerca de</li>
                            <li><code className="bg-slate-800 px-1 rounded">Cmd/Ctrl + K</code> - Matrix</li>
                            <li><code className="bg-slate-800 px-1 rounded">Cmd/Ctrl + P</code> - Pong</li>
                          </ul>
                        </div>
                        <div>
                          <h4 className="font-semibold text-green-400 mb-2">Comandos Ollama:</h4>
                          <ul className="space-y-1">
                            <li><code className="bg-slate-800 px-1 rounded">ollama list</code> - Ver modelos</li>
                            <li><code className="bg-slate-800 px-1 rounded">ollama ps</code> - Procesos activos</li>
                            <li><code className="bg-slate-800 px-1 rounded">ollama serve</code> - Iniciar</li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </section>

                  {/* Troubleshooting */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      üõ†Ô∏è Soluci√≥n de Problemas
                    </h3>

                    <div className="space-y-4">
                      <div className="bg-red-900/20 p-4 rounded-lg border border-red-700">
                        <h4 className="font-semibold text-red-400 mb-2">Error de JSON</h4>
                        <p className="text-sm">Si aparece error de formato JSON, usa el editor manual que aparece autom√°ticamente para corregir el contenido.</p>
                      </div>

                      <div className="bg-yellow-900/20 p-4 rounded-lg border border-yellow-700">
                        <h4 className="font-semibold text-yellow-400 mb-2">Conexi√≥n con Ollama</h4>
                        <p className="text-sm">Verifica que Ollama est√© ejecut√°ndose: <code className="bg-slate-800 px-1 rounded">ollama serve</code></p>
                      </div>

                      <div className="bg-blue-900/20 p-4 rounded-lg border border-blue-700">
                        <h4 className="font-semibold text-blue-400 mb-2">Rendimiento</h4>
                        <p className="text-sm">Para equipos menos potentes, reduce la ventana de contexto o usa modelos m√°s peque√±os.</p>
                      </div>
                    </div>
                  </section>
                </div>
              ) : (
                <div className="space-y-8 text-slate-200">
                  {/* English content - similar structure but in English */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      üöÄ Step 1: Development Environment Setup
                    </h3>

                    <div className="space-y-4">
                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">1. Install Visual Studio Code</h4>
                        <p className="text-sm mb-2">Download VS Code from:</p>
                        <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">
                          https://code.visualstudio.com/
                        </code>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">2. Install Live Server</h4>
                        <ul className="text-sm space-y-1 list-disc list-inside">
                          <li>Open VS Code</li>
                          <li>Go to Extensions (Ctrl+Shift+X)</li>
                          <li>Search for "Live Server" by Ritwick Dey</li>
                          <li>Click "Install"</li>
                        </ul>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">3. Run the application</h4>
                        <ul className="text-sm space-y-1 list-disc list-inside">
                          <li>Open <code className="bg-slate-800 px-1 rounded">index.html</code> in VS Code</li>
                          <li>Click "Go Live" in the bottom right corner</li>
                          <li>The application will open automatically in your browser</li>
                        </ul>
                      </div>
                    </div>
                  </section>

                  {/* Step 2 - English */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      ü§ñ Step 2: Configure Ollama
                    </h3>

                    <div className="space-y-4">
                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">1. Install Ollama</h4>
                        <div className="space-y-2 text-sm">
                          <div>
                            <strong>macOS:</strong>
                            <code className="bg-slate-800 px-2 py-1 rounded ml-2 text-blue-300">brew install ollama</code>
                          </div>
                          <div>
                            <strong>Linux:</strong>
                            <code className="bg-slate-800 px-2 py-1 rounded ml-2 text-blue-300">curl -fsSL https://ollama.com/install.sh | sh</code>
                          </div>
                          <div>
                            <strong>Windows:</strong> Download from <code className="bg-slate-800 px-1 rounded text-blue-300">https://ollama.com/download/windows</code>
                          </div>
                        </div>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">2. Start Ollama</h4>
                        <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama serve</code>
                      </div>

                      <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                        <h4 className="font-semibold text-green-400 mb-2">3. Download models</h4>
                        <div className="space-y-2 text-sm">
                          <div>
                            <strong>Main model (best for Spanish):</strong><br />
                            <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama pull gemma3n:e4b</code>
                          </div>
                          <div>
                            <strong>Alternative models:</strong><br />
                            <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama pull mistral:7b</code><br />
                            <code className="bg-slate-800 px-2 py-1 rounded text-blue-300">ollama pull mistral-nemo:12b</code>
                          </div>
                        </div>
                      </div>
                    </div>
                  </section>

                  {/* Commands - English */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      ‚å®Ô∏è Commands and Shortcuts
                    </h3>

                    <div className="bg-slate-900 p-4 rounded-lg border border-slate-700">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                          <h4 className="font-semibold text-green-400 mb-2">App shortcuts:</h4>
                          <ul className="space-y-1">
                            <li><code className="bg-slate-800 px-1 rounded">Cmd/Ctrl + H</code> - About</li>
                            <li><code className="bg-slate-800 px-1 rounded">Cmd/Ctrl + K</code> - Matrix</li>
                            <li><code className="bg-slate-800 px-1 rounded">Cmd/Ctrl + P</code> - Pong</li>
                          </ul>
                        </div>
                        <div>
                          <h4 className="font-semibold text-green-400 mb-2">Ollama commands:</h4>
                          <ul className="space-y-1">
                            <li><code className="bg-slate-800 px-1 rounded">ollama list</code> - List models</li>
                            <li><code className="bg-slate-800 px-1 rounded">ollama ps</code> - Active processes</li>
                            <li><code className="bg-slate-800 px-1 rounded">ollama serve</code> - Start server</li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </section>

                  {/* Troubleshooting - English */}
                  <section>
                    <h3 className="text-xl font-bold text-purple-400 mb-4 flex items-center">
                      üõ†Ô∏è Troubleshooting
                    </h3>

                    <div className="space-y-4">
                      <div className="bg-red-900/20 p-4 rounded-lg border border-red-700">
                        <h4 className="font-semibold text-red-400 mb-2">JSON Error</h4>
                        <p className="text-sm">If a JSON format error appears, use the manual editor that appears automatically to correct the content.</p>
                      </div>

                      <div className="bg-yellow-900/20 p-4 rounded-lg border border-yellow-700">
                        <h4 className="font-semibold text-yellow-400 mb-2">Ollama Connection</h4>
                        <p className="text-sm">Verify that Ollama is running: <code className="bg-slate-800 px-1 rounded">ollama serve</code></p>
                      </div>

                      <div className="bg-blue-900/20 p-4 rounded-lg border border-blue-700">
                        <h4 className="font-semibold text-blue-400 mb-2">Performance</h4>
                        <p className="text-sm">For less powerful computers, reduce the context window or use smaller models.</p>
                      </div>
                    </div>
                  </section>
                </div>
              )}
            </div>

            {/* Footer */}
            <div className="p-4 border-t border-slate-700 bg-slate-900 flex justify-end">
              <button
                onClick={onClose}
                className="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors"
              >
                {isSpanish ? "Cerrar" : "Close"}
              </button>
            </div>
          </div>
        </div>
      );
    };

    // Componente Panel de Historial
    const HistoryPanel = ({ onClose, history, onRegenerate, onLoad, onToggleFavorite, onDelete, language }) => {
      const isSpanish = language === 'espa√±ol';

      return (
        <div className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4">
          <div className="bg-slate-800 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden border border-slate-600">
            <div className="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-900">
              <h2 className="text-2xl font-bold text-white flex items-center">
                <History className="w-6 h-6 mr-2" />
                <span className="mx-2"></span>
                {isSpanish ? "Historial de Generaciones" : "Generation History"}
              </h2>
              <button onClick={onClose} className="text-slate-400 hover:text-white transition-colors">
                <X />
              </button>
            </div>

            <div className="p-6 overflow-y-auto max-h-[calc(90vh-80px)]">
              {history.length === 0 ? (
                <div className="text-center text-slate-400 py-8">
                  <History className="w-12 h-12 mx-auto mb-4 opacity-50" />
                  <p>{isSpanish ? "No hay generaciones en el historial" : "No generations in history"}</p>
                </div>
              ) : (
                <div className="space-y-4">
                  {history.map((item) => (
                    <div key={item.id} className="bg-slate-900/50 rounded-lg p-4 border border-slate-600">
                      <div className="flex justify-between items-start mb-3">
                        <div className="flex-1">
                          <h3 className="text-white font-medium mb-1">{item.formData.topic}</h3>
                          <p className="text-slate-400 text-sm">
                            {item.formData.category} ‚Ä¢ {item.formData.channelName}
                          </p>
                          <p className="text-slate-500 text-xs">
                            {new Date(item.timestamp).toLocaleString()}
                          </p>
                        </div>
                        <button
                          onClick={() => onToggleFavorite(item.id)}
                          className={`p-2 rounded transition-colors ${item.isFavorite
                            ? 'text-yellow-400 hover:text-yellow-300'
                            : 'text-slate-400 hover:text-yellow-400'
                            }`}
                          title={isSpanish ? "Marcar como favorito" : "Mark as favorite"}
                        >
                          {item.isFavorite ? <StarFilled /> : <Star />}
                        </button>
                      </div>

                      <div className="flex space-x-2">
                        <button
                          onClick={() => onLoad(item)}
                          className="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center"
                        >
                          <Eye className="w-3 h-3 mr-1" />
                          {isSpanish ? "Ver" : "View"}
                        </button>
                        <button
                          onClick={() => onRegenerate(item)}
                          className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center"
                        >
                          <RotateCcw className="w-3 h-3 mr-1" />
                          {isSpanish ? "Regenerar" : "Regenerate"}
                        </button>
                        <button
                          onClick={() => onDelete(item.id)}
                          className="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center"
                        >
                          <svg className="w-3 h-3 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                            <polyline points="3,6 5,6 21,6"></polyline>
                            <path d="M19,6v14a2,2,0,0,1-2-2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"></path>
                          </svg>
                          {isSpanish ? "Borrar" : "Delete"}
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    // Componente Panel de Favoritos
    const FavoritesPanel = ({ onClose, favorites, onRegenerate, onLoad, onToggleFavorite, language }) => {
      const isSpanish = language === 'espa√±ol';

      return (
        <div className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4">
          <div className="bg-slate-800 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden border border-slate-600">
            <div className="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-900">
              <h2 className="text-2xl font-bold text-white flex items-center">
                <StarFilled className="w-6 h-6 mr-2 text-yellow-400" />
                <span className="mx-2"></span>
                {isSpanish ? "Guiones Favoritos" : "Favorite Scripts"}
              </h2>
              <button onClick={onClose} className="text-slate-400 hover:text-white transition-colors">
                <X />
              </button>
            </div>

            <div className="p-6 overflow-y-auto max-h-[calc(90vh-80px)]">
              {favorites.length === 0 ? (
                <div className="text-center text-slate-400 py-8">
                  <Star className="w-12 h-12 mx-auto mb-4 opacity-50" />
                  <p>{isSpanish ? "No tienes guiones favoritos" : "You have no favorite scripts"}</p>
                </div>
              ) : (
                <div className="space-y-4">
                  {favorites.map((item) => (
                    <div key={item.id} className="bg-slate-900/50 rounded-lg p-4 border border-slate-600">
                      <div className="flex justify-between items-start mb-3">
                        <div className="flex-1">
                          <h3 className="text-white font-medium mb-1">{item.formData.topic}</h3>
                          <p className="text-slate-400 text-sm">
                            {item.formData.category} ‚Ä¢ {item.formData.channelName}
                          </p>
                          <p className="text-slate-500 text-xs">
                            {new Date(item.timestamp).toLocaleString()}
                          </p>
                        </div>
                        <button
                          onClick={() => onToggleFavorite(item.id)}
                          className="text-yellow-400 hover:text-yellow-300 p-2 rounded transition-colors"
                          title={isSpanish ? "Quitar de favoritos" : "Remove from favorites"}
                        >
                          <StarFilled />
                        </button>
                      </div>

                      <div className="flex space-x-2">
                        <button
                          onClick={() => onLoad(item)}
                          className="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center"
                        >
                          <Eye className="w-3 h-3 mr-1" />
                          {isSpanish ? "Ver" : "View"}
                        </button>
                        <button
                          onClick={() => onRegenerate(item)}
                          className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center"
                        >
                          <RotateCcw className="w-3 h-3 mr-1" />
                          {isSpanish ? "Regenerar" : "Regenerate"}
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    // Componente Tab Bar
    const TabBar = ({
      isOpen,
      onClose,
      onDashboard,
      onNewProject,
      onHistory,
      onFavorites,
      onInstallGuide,
      onIdeaGenerator,
      language
    }) => {
      const isSpanish = language === 'espa√±ol';

      return (
        <>
          {/* Overlay */}
          {isOpen && (
            <div
              className="fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity duration-300"
              onClick={onClose}
            />
          )}

          {/* Tab Bar */}
          <div
            className={`fixed top-0 left-0 h-full w-80 bg-slate-800 border-r border-slate-600 z-50 transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'
              }`}
          >
            {/* Header */}
            <div className="flex items-center justify-between p-6 border-b border-slate-700">
              <div className="flex items-center">
                <Play className="w-6 h-6 text-red-500 mr-3" />
                <h2 className="text-xl font-bold text-white">
                  {isSpanish ? "Men√∫ Principal" : "Main Menu"}
                </h2>
              </div>
              <button
                onClick={onClose}
                className="text-slate-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-slate-700"
              >
                <X />
              </button>
            </div>

            {/* Navigation Items */}
            <nav className="p-4 space-y-2">
              {/* Dashboard */}
              <button
                onClick={() => {
                  onDashboard();
                  onClose();
                }}
                className="w-full flex items-center p-4 text-left text-slate-200 hover:text-white hover:bg-slate-700 rounded-lg transition-colors group"
              >
                <div className="w-10 h-10 bg-slate-600 rounded-lg flex items-center justify-center mr-4 group-hover:bg-slate-500 transition-colors">
                  <Dashboard className="w-5 h-5 text-white" />
                </div>
                <div>
                  <h3 className="font-medium">
                    {isSpanish ? "Dashboard" : "Dashboard"}
                  </h3>
                  <p className="text-sm text-slate-400">
                    {isSpanish ? "Estad√≠sticas y acceso r√°pido" : "Statistics and quick access"}
                  </p>
                </div>
              </button>

              {/* Nuevo Proyecto */}
              <button
                onClick={() => {
                  onNewProject();
                  onClose();
                }}
                className="w-full flex items-center p-4 text-left text-slate-200 hover:text-white hover:bg-slate-700 rounded-lg transition-colors group"
              >
                <div className="w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center mr-4 group-hover:bg-purple-500 transition-colors">
                  <Zap className="w-5 h-5 text-white" />
                </div>
                <div>
                  <h3 className="font-medium">
                    {isSpanish ? "Nuevo Proyecto" : "New Project"}
                  </h3>
                  <p className="text-sm text-slate-400">
                    {isSpanish ? "Crear contenido desde cero" : "Create content from scratch"}
                  </p>
                </div>
              </button>

              {/* Generador de Ideas */}
              <button
                onClick={() => {
                  onIdeaGenerator();
                  onClose();
                }}
                className="w-full flex items-center p-4 text-left text-slate-200 hover:text-white hover:bg-slate-700 rounded-lg transition-colors group"
              >
                <div className="w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center mr-4 group-hover:bg-orange-500 transition-colors">
                  <svg className="w-5 h-5 text-white" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z" />
                  </svg>
                </div>
                <div>
                  <h3 className="font-medium">
                    {isSpanish ? "Generador de Ideas" : "Idea Generator"}
                  </h3>
                  <p className="text-sm text-slate-400">
                    {isSpanish ? "Genera ideas de contenido" : "Generate content ideas"}
                  </p>
                </div>
              </button>

              {/* Historial */}
              <button
                onClick={() => {
                  onHistory();
                  onClose();
                }}
                className="w-full flex items-center p-4 text-left text-slate-200 hover:text-white hover:bg-slate-700 rounded-lg transition-colors group"
              >
                <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-4 group-hover:bg-blue-500 transition-colors">
                  <History className="w-5 h-5 text-white" />
                </div>
                <div>
                  <h3 className="font-medium">
                    {isSpanish ? "Historial" : "History"}
                  </h3>
                  <p className="text-sm text-slate-400">
                    {isSpanish ? "Ver generaciones anteriores" : "View previous generations"}
                  </p>
                </div>
              </button>

              {/* Favoritos */}
              <button
                onClick={() => {
                  onFavorites();
                  onClose();
                }}
                className="w-full flex items-center p-4 text-left text-slate-200 hover:text-white hover:bg-slate-700 rounded-lg transition-colors group"
              >
                <div className="w-10 h-10 bg-yellow-600 rounded-lg flex items-center justify-center mr-4 group-hover:bg-yellow-500 transition-colors">
                  <StarFilled className="w-5 h-5 text-white" />
                </div>
                <div>
                  <h3 className="font-medium">
                    {isSpanish ? "Favoritos" : "Favorites"}
                  </h3>
                  <p className="text-sm text-slate-400">
                    {isSpanish ? "Guiones guardados como favoritos" : "Scripts saved as favorites"}
                  </p>
                </div>
              </button>

              {/* Separador */}
              <div className="border-t border-slate-600 my-4"></div>

              {/* Gu√≠a de Instalaci√≥n */}
              <button
                onClick={() => {
                  onInstallGuide();
                  onClose();
                }}
                className="w-full flex items-center p-4 text-left text-slate-200 hover:text-white hover:bg-slate-700 rounded-lg transition-colors group"
              >
                <div className="w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center mr-4 group-hover:bg-green-500 transition-colors">
                  <svg className="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                    <polyline points="14,2 14,8 20,8" />
                    <line x1="16" y1="13" x2="8" y2="13" />
                    <line x1="16" y1="17" x2="8" y2="17" />
                    <polyline points="10,9 9,9 8,9" />
                  </svg>
                </div>
                <div>
                  <h3 className="font-medium">
                    {isSpanish ? "Gu√≠a de Instalaci√≥n" : "Installation Guide"}
                  </h3>
                  <p className="text-sm text-slate-400">
                    {isSpanish ? "Instrucciones de configuraci√≥n" : "Setup instructions"}
                  </p>
                </div>
              </button>
            </nav>

            {/* Footer del Tab Bar */}
            <div className="absolute bottom-0 left-0 right-0 p-4 border-t border-slate-700 bg-slate-900">
              <div className="text-center">
                <p className="text-slate-400 text-xs">
                  {isSpanish ? "Generador YouTube" : "YouTube Generator"}
                </p>
                <p className="text-slate-500 text-xs mt-1">
                  v1.0 ‚Ä¢ AndresV22
                </p>
              </div>
            </div>
          </div>
        </>
      );
    };

    const IdeaGenerator = ({ onClose, onSelectIdea, language, formData, isGenerating, onGenerate, generatedIdeas, ideaTopic, onTopicChange, isTestingConnection, onTestConnection, abortControllerRef }) => {
      const isSpanish = language === 'espa√±ol';
      const [showRealTimePanel, setShowRealTimePanel] = useState(false);
      const [realTimeResponse, setRealTimeResponse] = useState('');
      const realTimePanelRef = useRef(null);

      // Auto-scroll del panel en tiempo real
      useEffect(() => {
        if (realTimePanelRef.current) {
          realTimePanelRef.current.scrollTop = realTimePanelRef.current.scrollHeight;
        }
      }, [realTimeResponse]);

      // Listener para eventos de progreso de generaci√≥n
      useEffect(() => {
        const handleProgressUpdate = (event) => {
          setRealTimeResponse(prev => prev + event.detail);
        };

        window.addEventListener('ideaGenerationProgress', handleProgressUpdate);

        return () => {
          window.removeEventListener('ideaGenerationProgress', handleProgressUpdate);
        };
      }, []);

      return (
        <div className="fixed inset-0 bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex">
          {/* Panel principal */}
          <div className={`transition-all duration-300 overflow-auto ${showRealTimePanel ? 'w-2/3' : 'w-full'}`}>
            <div className="py-8 px-4">
              <div className={`${showRealTimePanel ? 'max-w-none mx-4' : 'max-w-6xl mx-auto'}`}>
                <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-slate-700">
                  {/* Header */}
                  <div className="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-900">
                    <h2 className="text-2xl font-bold text-white flex items-center">
                      <svg className="w-6 h-6 mr-3 text-yellow-400" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z" />
                      </svg>
                      {isSpanish ? "Generador de Ideas" : "Idea Generator"}
                    </h2>
                  </div>

                  {/* Content */}
                  <div className="p-6 overflow-y-auto max-h-[calc(100vh-140px)]">
                    {/* Configuraci√≥n de conexi√≥n */}
                    <div className="bg-blue-900/30 border border-blue-700 rounded-lg p-4 mb-6">
                      <div className="flex items-center justify-between mb-3">
                        <h4 className="text-blue-300 font-medium">
                          {isSpanish ? "Estado de Ollama" : "Ollama Status"}
                        </h4>
                        <button
                          onClick={onTestConnection}
                          disabled={isTestingConnection}
                          className={`${isTestingConnection
                            ? 'bg-blue-600 opacity-50 cursor-not-allowed'
                            : 'bg-blue-600 hover:bg-blue-700'
                            } text-white px-3 py-1 rounded text-sm transition-colors flex items-center`}
                        >
                          {isTestingConnection ? (
                            <>
                              <Loader2 className="w-3 h-3 mr-1 animate-spin" />
                              {isSpanish ? "Probando..." : "Testing..."}
                            </>
                          ) : (
                            isSpanish ? "Probar Conexi√≥n" : "Test Connection"
                          )}
                        </button>
                      </div>
                      <div className="text-blue-200 text-sm">
                        <p>
                          {isSpanish ? "Modelo: " : "Model: "}
                          <code className="bg-slate-800 px-1 rounded">{formData.model}</code>
                        </p>
                        <p>
                          {isSpanish ? "URL: " : "URL: "}
                          <code className="bg-slate-800 px-1 rounded">{formData.baseUrl}</code>
                        </p>
                      </div>
                    </div>

                    {/* Input para tema */}
                    <div className="bg-slate-900/50 rounded-lg p-6 mb-6 border border-slate-600">
                      <h3 className="text-lg font-semibold text-white mb-4 flex items-center">
                        <svg className="w-5 h-5 mr-2 text-purple-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <circle cx="11" cy="11" r="8" />
                          <path d="M21 21l-4.35-4.35" />
                        </svg>
                        {isSpanish ? "¬øSobre qu√© tema quieres crear contenido?" : "What topic do you want to create content about?"}
                      </h3>

                      <div className="space-y-4">
                        <div>
                          <label className="block text-slate-300 font-medium mb-3">
                            {isSpanish ? "Tema de Inter√©s" : "Topic of Interest"}
                          </label>
                          <input
                            type="text"
                            value={ideaTopic}
                            onChange={(e) => onTopicChange(e.target.value)}
                            placeholder={isSpanish ?
                              "Ej: Inteligencia artificial, recetas saludables, gaming, tecnolog√≠a, fitness..." :
                              "Ex: Artificial intelligence, healthy recipes, gaming, technology, fitness..."
                            }
                            className="w-full bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            maxLength={100}
                          />
                          <div className="flex justify-between items-center mt-2">
                            <p className="text-slate-400 text-sm">
                              {isSpanish ?
                                "Describe el tema general del que quieres generar ideas de videos" :
                                "Describe the general topic you want to generate video ideas about"
                              }
                            </p>
                            <span className="text-sm font-mono text-slate-400">
                              {ideaTopic.length}/100
                            </span>
                          </div>
                        </div>

                        <div className="flex justify-center">
                          {isGenerating ? (
                            <div className="flex space-x-3">
                              <button
                                disabled={true}
                                className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-medium flex items-center opacity-50"
                              >
                                <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                                {isSpanish ? "Generando Ideas..." : "Generating Ideas..."}
                              </button>
                              <button
                                onClick={() => {
                                  if (abortControllerRef.current) {
                                    abortControllerRef.current.abort();
                                  }
                                }}
                                className="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center"
                              >
                                <svg className="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="currentColor">
                                  <rect x="6" y="6" width="12" height="12" rx="2" />
                                </svg>
                                {isSpanish ? "Detener" : "Stop"}
                              </button>
                            </div>
                          ) : (
                            <button
                              onClick={() => {
                                setRealTimeResponse('');
                                setShowRealTimePanel(true);
                                onGenerate();
                              }}
                              disabled={!ideaTopic.trim()}
                              className={`${ideaTopic.trim()
                                ? 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700'
                                : 'bg-gray-500 cursor-not-allowed'
                                } text-white px-8 py-3 rounded-lg font-medium flex items-center transition-colors`}
                            >
                              <svg className="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z" />
                              </svg>
                              {isSpanish ? "Generar 10 Ideas" : "Generate 10 Ideas"}
                            </button>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Ideas generadas */}
                    {generatedIdeas.length > 0 && (
                      <div className="space-y-4">
                        <h3 className="text-xl font-bold text-white mb-4 flex items-center">
                          <svg className="w-5 h-5 mr-2 text-green-400" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z" />
                          </svg>
                          {isSpanish ? "Ideas Generadas" : "Generated Ideas"}
                          <span className="ml-2 bg-green-600 text-white text-sm px-2 py-1 rounded-full">
                            {generatedIdeas.length}
                          </span>
                        </h3>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {generatedIdeas.map((idea, index) => (
                            <div key={index} className="bg-slate-900/50 rounded-lg p-6 border border-slate-600 hover:border-purple-500 transition-colors">
                              {/* N√∫mero e icono de categor√≠a */}
                              <div className="flex items-center justify-between mb-3">
                                <div className="flex items-center">
                                  <div className="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm mr-3">
                                    {index + 1}
                                  </div>
                                  <div className="text-xs">
                                    <span className="bg-blue-600 text-white px-2 py-1 rounded text-xs mr-2">
                                      {idea.category}
                                    </span>
                                    {idea.template && (
                                      <span className="bg-green-600 text-white px-2 py-1 rounded text-xs">
                                        {isSpanish ? "Template" : "Template"}
                                      </span>
                                    )}
                                  </div>
                                </div>
                              </div>

                              {/* T√≠tulo */}
                              <h4 className="text-white font-semibold text-lg mb-3 leading-tight">
                                {idea.title}
                              </h4>

                              {/* Descripci√≥n */}
                              <p className="text-slate-300 text-sm mb-4 leading-relaxed">
                                {idea.description}
                              </p>

                              {/* Detalles adicionales */}
                              {idea.keyPoints && (
                                <div className="mb-4">
                                  <h5 className="text-slate-400 text-xs font-medium mb-2 uppercase tracking-wide">
                                    {isSpanish ? "Puntos Clave:" : "Key Points:"}
                                  </h5>
                                  <ul className="text-slate-300 text-xs space-y-1">
                                    {idea.keyPoints.map((point, i) => (
                                      <li key={i} className="flex items-start">
                                        <span className="text-purple-400 mr-2">‚Ä¢</span>
                                        {point}
                                      </li>
                                    ))}
                                  </ul>
                                </div>
                              )}

                              {/* Informaci√≥n t√©cnica */}
                              <div className="flex flex-wrap gap-2 mb-4">
                                {idea.estimatedLength && (
                                  <span className="bg-slate-700 text-slate-300 px-2 py-1 rounded text-xs">
                                    üìè {idea.estimatedLength}
                                  </span>
                                )}
                                {idea.difficulty && (
                                  <span className="bg-slate-700 text-slate-300 px-2 py-1 rounded text-xs">
                                    üìä {idea.difficulty}
                                  </span>
                                )}
                                {idea.targetAudience && (
                                  <span className="bg-slate-700 text-slate-300 px-2 py-1 rounded text-xs">
                                    üë• {idea.targetAudience}
                                  </span>
                                )}
                              </div>

                              {/* Bot√≥n de acci√≥n */}
                              <button
                                onClick={() => onSelectIdea(idea)}
                                className="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center"
                              >
                                <svg className="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                  <path d="M9 18l6-6-6-6" />
                                </svg>
                                {isSpanish ? "Usar Esta Idea" : "Use This Idea"}
                              </button>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Estado vac√≠o */}
                    {!isGenerating && generatedIdeas.length === 0 && ideaTopic && (
                      <div className="text-center py-12">
                        <svg className="w-16 h-16 mx-auto text-slate-400 mb-4" viewBox="0 0 24 24" fill="currentColor">
                          <path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z" />
                        </svg>
                        <p className="text-slate-400 text-lg">
                          {isSpanish ?
                            "¬°Genera ideas incre√≠bles para tu contenido!" :
                            "Generate amazing ideas for your content!"
                          }
                        </p>
                        <p className="text-slate-500 text-sm mt-2">
                          {isSpanish ?
                            "Ingresa un tema y obt√©n 10 ideas √∫nicas con detalles completos" :
                            "Enter a topic and get 10 unique ideas with complete details"
                          }
                        </p>
                      </div>
                    )}
                  </div>

                  {/* Footer */}
                  <div className="p-4 border-t border-slate-700 bg-slate-900 flex justify-between items-center">
                    <div className="text-slate-400 text-sm">
                      {isSpanish ?
                        "üí° Cada idea incluye t√≠tulo, descripci√≥n, categor√≠a y template sugerido" :
                        "üí° Each idea includes title, description, category and suggested template"
                      }
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Panel lateral en tiempo real */}
          {showRealTimePanel && (
            <div className="fixed top-0 right-0 w-1/3 h-full bg-slate-900/95 border-l border-slate-700 z-40">
              <div className="sticky top-0 bg-slate-800 p-4 border-b border-slate-700 flex items-center justify-between">
                <div className="flex items-center">
                  <div className={`w-3 h-3 rounded-full mr-2 ${isGenerating ? 'bg-green-500 animate-pulse' : 'bg-slate-500'}`}></div>
                  <h3 className="text-white font-medium">
                    {isSpanish ? "Generaci√≥n de Ideas" : "Idea Generation"}
                  </h3>
                </div>
                <div className="flex items-center space-x-2">
                  <button
                    onClick={() => setShowRealTimePanel(false)}
                    className="text-slate-400 hover:text-white transition-colors"
                    title={isSpanish ? "Cerrar panel" : "Close panel"}
                  >
                    <X />
                  </button>
                </div>
              </div>

              <div
                ref={realTimePanelRef}
                className="p-4 h-[calc(100vh-80px)] overflow-y-auto"
              >
                <div className="bg-slate-800/50 rounded-lg p-4 border border-slate-600">
                  <div className="flex items-center mb-3">
                    <span className="text-slate-300 text-sm">
                      {isGenerating ?
                        (isSpanish ? "Generando ideas..." : "Generating ideas...") :
                        (isSpanish ? "Listo" : "Ready")
                      }
                    </span>
                  </div>

                  <div className="space-y-2">
                    <pre className="text-green-400 font-mono text-xs leading-relaxed whitespace-pre-wrap">
                      {realTimeResponse || (isSpanish ?
                        "Presiona 'Generar 10 Ideas' para ver el progreso de la IA en tiempo real." :
                        "Press 'Generate 10 Ideas' to see AI progress in real-time."
                      )}
                    </pre>
                  </div>

                  {realTimeResponse && (
                    <div className="mt-4 pt-3 border-t border-slate-600">
                      <button
                        onClick={() => navigator.clipboard.writeText(realTimeResponse)}
                        className="text-xs bg-slate-700 hover:bg-slate-600 text-slate-300 px-2 py-1 rounded transition-colors"
                      >
                        {isSpanish ? "Copiar Log" : "Copy Log"}
                      </button>
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Bot√≥n flotante para mostrar/ocultar panel */}
          {!showRealTimePanel && (
            <button
              onClick={() => setShowRealTimePanel(true)}
              className="fixed right-4 top-1/2 transform -translate-y-1/2 bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-l-lg shadow-lg transition-colors z-10"
              title={isSpanish ? "Ver respuesta en tiempo real" : "Show real-time response"}
            >
              <Eye className="w-5 h-5" />
            </button>
          )}

          {/* Bot√≥n flotante para mostrar/ocultar panel */}
          {!showRealTimePanel && (
            <button
              onClick={() => setShowRealTimePanel(true)}
              className="fixed right-4 top-1/2 transform -translate-y-1/2 bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-l-lg shadow-lg transition-colors z-10"
              title={isSpanish ? "Ver respuesta en tiempo real" : "Show real-time response"}
            >
              <Eye className="w-5 h-5" />
            </button>
          )}
        </div>
      );
    };

    // Componente para mostrar errores en el generador de ideas
    const IdeaGeneratorError = ({ error, onClose }) => {
      if (!error) return null;

      return (
        <div className="fixed bottom-4 right-4 z-50 max-w-sm">
          <div className="bg-red-500 bg-opacity-20 backdrop-blur-sm border border-red-400 border-opacity-50 rounded-xl p-4 shadow-lg">
            <div className="flex items-start justify-between">
              <div className="flex items-start space-x-3">
                <div className="flex-shrink-0">
                  <div className="w-6 h-6 bg-red-500 bg-opacity-30 rounded-full flex items-center justify-center">
                    <span className="text-red-300 text-sm">‚ùå</span>
                  </div>
                </div>
                <div className="flex-1">
                  <p className="text-red-100 text-sm font-medium mb-1">Error</p>
                  <p className="text-red-200 text-sm leading-relaxed">{error}</p>
                </div>
              </div>
              <button
                onClick={onClose}
                className="flex-shrink-0 text-red-300 hover:text-red-100 transition-colors ml-2"
              >
                <X className="w-4 h-4" />
              </button>
            </div>
          </div>
        </div>
      );
    };

    // Componente Modal de confirmaci√≥n para eliminar
    const DeleteConfirmModal = ({ isOpen, onConfirm, onCancel, language }) => {
      if (!isOpen) return null;

      const isSpanish = language === 'espa√±ol';

      return (
        <div className="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4">
          <div className="bg-slate-800 rounded-2xl p-6 border border-slate-600 max-w-md w-full">
            <div className="flex items-center mb-4">
              <div className="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center mr-4">
                <svg className="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                  <polyline points="3,6 5,6 21,6"></polyline>
                  <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"></path>
                  <line x1="10" y1="11" x2="10" y2="17"></line>
                  <line x1="14" y1="11" x2="14" y2="17"></line>
                </svg>
              </div>
              <h3 className="text-xl font-bold text-white">
                {isSpanish ? "Confirmar Eliminaci√≥n" : "Confirm Deletion"}
              </h3>
            </div>

            <p className="text-slate-300 mb-6">
              {isSpanish ?
                "¬øEst√°s seguro de que quieres eliminar este elemento del historial? Esta acci√≥n no se puede deshacer." :
                "Are you sure you want to delete this item from history? This action cannot be undone."
              }
            </p>

            <div className="flex justify-end space-x-3">
              <button
                onClick={onCancel}
                className="bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded-lg transition-colors"
              >
                {isSpanish ? "Cancelar" : "Cancel"}
              </button>
              <button
                onClick={onConfirm}
                className="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors"
              >
                {isSpanish ? "Eliminar" : "Delete"}
              </button>
            </div>
          </div>
        </div>
      );
    };


    const YouTubeContentGenerator = () => {
      const [showMatrixEffect, setShowMatrixEffect] = useState(false);
      const [currentStep, setCurrentStep] = useState(1);
      const [isGenerating, setIsGenerating] = useState(false);
      const [formData, setFormData] = useState({
        category: '',
        topic: '',
        scriptStyle: '',
        channelName: '',
        linkedVideo: '',
        model: 'gemma3n:e4b',
        baseUrl: 'http://localhost:11434/api/generate',
        language: 'espa√±ol',
        disableThinking: false,
        contextWindow: 20000,
        keyData: '',
        selectedTemplate: '',
        customTemplate: '',
      });
      const [results, setResults] = useState(null);
      const [error, setError] = useState('');
      const [isTestingConnection, setIsTestingConnection] = useState(false);
      const [realTimeResponse, setRealTimeResponse] = useState('');
      const [showManualEditor, setShowManualEditor] = useState(false);
      const [manualContent, setManualContent] = useState('');
      const [isProcessingManual, setIsProcessingManual] = useState(false);
      const [isRetryingGeneration, setIsRetryingGeneration] = useState(false);
      const [showRealTimePanel, setShowRealTimePanel] = useState(false);
      const [isEditingResults, setIsEditingResults] = useState(false);
      const [editableResults, setEditableResults] = useState(null);
      const realTimePanelRef = useRef(null);
      const abortControllerRef = useRef(null);
      const [showPongGame, setShowPongGame] = useState(false);
      const [showTip, setShowTip] = useState(true);
      const [currentTip, setCurrentTip] = useState('');
      const [showInstallationGuide, setShowInstallationGuide] = useState(false);
      const [scriptHistory, setScriptHistory] = useState([]);
      const [favoriteScripts, setFavoriteScripts] = useState([]);
      const [showHistoryPanel, setShowHistoryPanel] = useState(false);
      const [showFavoritesPanel, setShowFavoritesPanel] = useState(false);
      const [currentHistoryId, setCurrentHistoryId] = useState(null);
      const [showTabBar, setShowTabBar] = useState(false);
      const [showIdeaGenerator, setShowIdeaGenerator] = useState(false);
      const [ideaGeneratorTopic, setIdeaGeneratorTopic] = useState('');
      const [generatedIdeas, setGeneratedIdeas] = useState([]);
      const [isGeneratingIdeas, setIsGeneratingIdeas] = useState(false);
      const [ideaGenerationError, setIdeaGenerationError] = useState('');
      const [currentView, setCurrentView] = useState('dashboard'); // 'dashboard', 'generator', 'idea-generator'
      const [dashboardData, setDashboardData] = useState({
        totalGenerations: 0,
        favoriteCount: 0,
        categoriesUsed: {},
        modelsUsed: {},
        templatesUsed: {},
        generationsByDate: [],
        averageGenerationTime: 0,
        lastWeekActivity: [],
        totalWords: 0,
        mostUsedCategory: '',
        mostUsedModel: '',
        streakDays: 0,
        thisWeekGenerations: 0,
        lastWeekGenerations: 0
      });
      const [generationStartTime, setGenerationStartTime] = useState(null);
      const [showDeleteModal, setShowDeleteModal] = useState(false);
      const [itemToDelete, setItemToDelete] = useState(null);

      // Tips aleatorios para la aplicaci√≥n
      const generateRandomTip = (language) => {
        const tips = {
          espa√±ol: [
            "üí° Usa Cmd/Ctrl + H para conocer al creador de esta aplicaci√≥n",
            "üß† Si agregas datos clave espec√≠ficos, ayudar√°s a la IA a generar un gui√≥n con menos errores",
            "‚ö° Presiona Cmd/Ctrl + K para activar el efecto Matrix por 10 segundos",
            "üéÆ ¬øGeneraci√≥n muy lenta? Presiona Cmd/Ctrl + P para jugar Pong mientras esperas",
            "üìù Los templates especializados mejoran significativamente la calidad del contenido generado",
            "üéØ Cuanto m√°s espec√≠fico seas en el tema del video, mejor ser√° el resultado final",
            "üìä Puedes editar todos los resultados generados antes de exportarlos",
            "üîÑ Si no te gusta un resultado, puedes regenerar solo manteniendo los mismos datos",
            "üì± El panel en tiempo real te permite ver exactamente lo que est√° pensando la IA",
            "üíæ Exporta en PDF para obtener un documento profesional con todo el contenido",
            "üè∑Ô∏è Los tags generados est√°n optimizados para SEO y trending topics",
            "‚úèÔ∏è Puedes editar manualmente el JSON si la IA genera formato incorrecto",
            "‚è±Ô∏è Aumenta la ventana de contexto para guiones m√°s largos y detallados",
            "üé® Cada template tiene una estructura optimizada para su tipo de contenido",
            "üîó El video a enlazar al final ayuda a generar mejor engagement entre videos",
            "üöÄ Usa el Generador de Ideas para obtener 10 conceptos √∫nicos sobre cualquier tema",
            "üí° El Generador de Ideas incluye categor√≠a, template y puntos clave autom√°ticamente",
            "üéØ Cada idea generada puede cargarse directamente al formulario con un solo clic",
            "üìù Las ideas incluyen audiencia objetivo, duraci√≥n estimada y nivel de dificultad",
            "üìä Usa Cmd/Ctrl + 0 para ir r√°pidamente al Dashboard y ver tus estad√≠sticas",
            "üìà El Dashboard muestra tu productividad semanal y categor√≠as m√°s usadas",
            "üéØ Revisa tu racha de d√≠as consecutivos generando contenido en el Dashboard",
            "üìã Exporta todo tu historial como backup desde el Dashboard"
          ],
          english: [
            "üí° Use Cmd/Ctrl + H to learn about the creator of this application",
            "üß† Adding specific key data helps the AI generate scripts with fewer errors",
            "‚ö° Press Cmd/Ctrl + K to activate the Matrix effect for 10 seconds",
            "üéÆ Generation too slow? Press Cmd/Ctrl + P to play Pong while you wait",
            "üìù Specialized templates significantly improve the quality of generated content",
            "üéØ The more specific you are about the video topic, the better the final result",
            "üìä You can edit all generated results before exporting them",
            "üîÑ If you don't like a result, you can regenerate while keeping the same data",
            "üì± The real-time panel lets you see exactly what the AI is thinking",
            "üíæ Export to PDF to get a professional document with all content",
            "üè∑Ô∏è Generated tags are optimized for SEO and trending topics",
            "‚úèÔ∏è You can manually edit the JSON if the AI generates incorrect format",
            "‚è±Ô∏è Increase the context window for longer and more detailed scripts",
            "üé® Each template has an optimized structure for its content type",
            "üîó The linked video at the end helps generate better engagement between videos",
            "üöÄ Use the Idea Generator to get 10 unique concepts about any topic",
            "üí° The Idea Generator includes category, template and key points automatically",
            "üéØ Each generated idea can be loaded directly to the form with one click",
            "üìù Ideas include target audience, estimated duration and difficulty level",
            "üìä Use Cmd/Ctrl + 0 to quickly go to Dashboard and see your statistics",
            "üìà Dashboard shows your weekly productivity and most used categories",
            "üéØ Check your streak of consecutive days generating content in Dashboard",
            "üìã Export all your history as backup from Dashboard"
          ]
        };

        const languageTips = tips[language] || tips.espa√±ol;
        const randomIndex = Math.floor(Math.random() * languageTips.length);
        return languageTips[randomIndex];
      };

      // Funciones para localStorage 
      const loadFromStorage = () => {
        try {
          const history = JSON.parse(localStorage.getItem('youtubeGenerator_scriptHistory') || '[]');
          const favorites = JSON.parse(localStorage.getItem('youtubeGenerator_favoriteScripts') || '[]');
          setScriptHistory(history);
          setFavoriteScripts(favorites);
          console.log('Datos cargados desde localStorage');
        } catch (error) {
          console.error('Error cargando datos:', error);
          setScriptHistory([]);
          setFavoriteScripts([]);
        }
      };

      const saveToStorage = () => {
        try {
          localStorage.setItem('youtubeGenerator_scriptHistory', JSON.stringify(scriptHistory));
          localStorage.setItem('youtubeGenerator_favoriteScripts', JSON.stringify(favoriteScripts));
          console.log('Datos guardados en localStorage');
        } catch (error) {
          console.error('Error guardando datos:', error);
        }
      };

      useEffect(() => {
        loadFromStorage();
        const calculatedData = calculateDashboardData();
        setDashboardData(calculatedData);
      }, []);

      // Actualizar cuando cambien los datos
      useEffect(() => {
        if (scriptHistory.length >= 0) {
          saveToStorage();
          const calculatedData = calculateDashboardData();
          setDashboardData(calculatedData);
        }
      }, [scriptHistory, favoriteScripts]);

      // Funci√≥n para guardar en historial
      const saveToHistory = (generationData, results) => {
        const historyItem = {
          id: Date.now(),
          timestamp: new Date().toISOString(),
          formData: { ...generationData },
          results: { ...results },
          isFavorite: false
        };

        setScriptHistory(prev => {
          const updated = [historyItem, ...prev.slice(0, 14)]; // Mantener solo 15
          return updated;
        });

        setTimeout(() => {
          const newData = calculateDashboardData();
          setDashboardData(newData);
        }, 100);

        // Trackear el ID del elemento actual
        setCurrentHistoryId(historyItem.id);

        return historyItem.id; // Retornar el ID para uso inmediato
      };

      // Funci√≥n para marcar como favorito
      const toggleFavorite = (itemId) => {
        let updatedItem = null;

        // Actualizar en historial
        setScriptHistory(prev => {
          const updated = prev.map(item => {
            if (item.id === itemId) {
              updatedItem = { ...item, isFavorite: !item.isFavorite };
              return updatedItem;
            }
            return item;
          });
          return updated;
        });

        // Actualizar lista de favoritos
        setTimeout(() => {
          if (updatedItem) {
            setFavoriteScripts(prev => {
              if (updatedItem.isFavorite) {
                // Agregar a favoritos si no existe
                return prev.find(fav => fav.id === itemId) ? prev : [...prev, updatedItem];
              } else {
                // Remover de favoritos
                return prev.filter(fav => fav.id !== itemId);
              }
            });
          }
        }, 100);

        // Mostrar feedback visual
        const isSpanish = formData.language === 'espa√±ol';
        const willBeFavorite = !scriptHistory.find(item => item.id === itemId)?.isFavorite;
        const message = willBeFavorite
          ? (isSpanish ? '‚≠ê Agregado a favoritos' : '‚≠ê Added to favorites')
          : (isSpanish ? '‚≠ê Removido de favoritos' : '‚≠ê Removed from favorites');

        // Crear notificaci√≥n temporal
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in';
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
          document.body.removeChild(notification);
        }, 2000);
      };

      // Funci√≥n para eliminar del historial
      const deleteFromHistory = (itemId) => {
        // Actualizar historial
        setScriptHistory(prev => prev.filter(item => item.id !== itemId));

        // Tambi√©n remover de favoritos si estaba marcado como favorito
        setFavoriteScripts(prev => prev.filter(fav => fav.id !== itemId));

        // Mostrar feedback visual
        const isSpanish = formData.language === 'espa√±ol';
        const message = isSpanish ? 'üóëÔ∏è Elemento eliminado del historial' : 'üóëÔ∏è Item deleted from history';

        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in';
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
          document.body.removeChild(notification);
        }, 2000);
      };

      // Funci√≥n para mostrar modal de confirmaci√≥n
      const confirmDelete = (itemId) => {
        setItemToDelete(itemId);
        setShowDeleteModal(true);
      };

      // Funci√≥n para confirmar eliminaci√≥n
      const handleConfirmDelete = () => {
        if (itemToDelete) {
          deleteFromHistory(itemToDelete);
          setShowDeleteModal(false);
          setItemToDelete(null);
        }
      };

      // Funci√≥n para cancelar eliminaci√≥n
      const handleCancelDelete = () => {
        setShowDeleteModal(false);
        setItemToDelete(null);
      };

      // Funci√≥n para regenerar con datos existentes
      const regenerateFromHistory = (historyItem) => {
        // Cargar datos del formulario
        setFormData(historyItem.formData);
        setCurrentHistoryId(null); // Reset porque se va a generar uno nuevo

        // Ir al paso 2 y generar
        setCurrentStep(2);
        setResults(null);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(false);
        setShowManualEditor(false);
        setShowHistoryPanel(false);
        setShowFavoritesPanel(false);

        // Generar autom√°ticamente despu√©s de un breve delay
        setTimeout(() => {
          generateContent();
        }, 500);
      };

      // Funci√≥n para cargar datos sin generar
      const loadFromHistory = (historyItem) => {
        setCurrentView('generator');
        setFormData(historyItem.formData);
        setResults(historyItem.results);
        setCurrentHistoryId(historyItem.id); // Trackear el ID
        setCurrentStep(3);
        setShowHistoryPanel(false);
        setShowFavoritesPanel(false);
      };

      // Funciones del Tab Bar
      const handleNewProject = () => {
        setCurrentView('generator');
        setCurrentStep(1);
        setResults(null);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(false);
        setCurrentHistoryId(null);
        setShowManualEditor(false);
      };

      const handleShowHistory = () => {
        setShowHistoryPanel(true);
      };

      const handleShowFavorites = () => {
        setShowFavoritesPanel(true);
      };

      const handleShowInstallGuide = () => {
        setShowInstallationGuide(true);
      };

      // Modo desarrollador y about
      useEffect(() => {
        const handleKeyDown = (e) => {
          // Command + D (Mac) o Ctrl + D (Windows/Linux) - Modo desarrollador
          if ((e.metaKey || e.ctrlKey) && e.key === 'd') {
            e.preventDefault();

            // Detectar si ya est√° en modo desarrollador (si topic contiene "Casio F91W" o "Casio F91W Review")
            const isAlreadyInDevMode = formData.topic.includes('Casio F91W');
            const useEnglish = isAlreadyInDevMode && formData.language === 'espa√±ol';

            // Datos del modo desarrollador
            const devDataSpanish = {
              topic: 'Rese√±a Casio F91W',
              category: 'Tecnolog√≠a',
              keyData: 'Lanzado en junio de 1989, el Casio F91W es el reloj m√°s vendido de la historia con m√°s de 100 millones de unidades comercializadas. Creado por el dise√±ador Ry≈´suke Moriai con la filosof√≠a "peque√±o, plano y simple", cuesta solo $15-18 d√≥lares pero ofrece durabilidad excepcional con bater√≠a de 7-10 a√±os. Ha sido usado por Barack Obama, soldados de fuerzas especiales y celebridades, convirti√©ndose en un √≠cono cultural que trasciende clases sociales. Sus especificaciones incluyen: 37.5mm x 34.5mm x 8.5mm, 21 gramos de peso, resistencia al agua 30m, cron√≥metro con precisi√≥n 1/100 segundos, y el m√≥dulo 593 que permanece sin cambios desde 1989. Genera aproximadamente $45-60 millones anuales para Casio con 3 millones de unidades producidas cada a√±o, representando el triunfo del dise√±o funcional sobre la complejidad tecnol√≥gica moderna.',
              selectedTemplate: 'rese√±as-de-relojes',
              scriptStyle: 'Informativo y profesional',
              channelName: 'Relojes con Andr√©s',
              linkedVideo: 'Top 5 Relojes Casio que cambiaron al mundo',
              language: 'espa√±ol'
            };

            const devDataEnglish = {
              topic: 'Casio F91W Review',
              category: 'Technology',
              keyData: 'Released in June 1989, the Casio F91W is the best-selling watch in history with over 100 million units sold. Created by designer Ry≈´suke Moriai with the philosophy "small, flat and simple", it costs only $15-18 but offers exceptional durability with 7-10 year battery life. It has been worn by Barack Obama, special forces soldiers and celebrities, becoming a cultural icon that transcends social classes. Its specifications include: 37.5mm x 34.5mm x 8.5mm, 21 grams weight, 30m water resistance, stopwatch with 1/100 second precision, and the module 593 that remains unchanged since 1989. It generates approximately $45-60 million annually for Casio with 3 million units produced each year, representing the triumph of functional design over modern technological complexity.',
              selectedTemplate: 'watch-reviews',
              scriptStyle: 'Informative and professional',
              channelName: 'Watch Express',
              linkedVideo: 'Top 5 Casio Watches that changed the world',
              language: 'english'
            };

            const devData = useEnglish ? devDataEnglish : devDataSpanish;

            // Llenar formularios
            setFormData(prev => ({
              ...prev,
              ...devData
            }));

            // Mostrar notificaci√≥n
            const message = useEnglish ?
              'üõ†Ô∏è Developer mode activated!\nForms filled automatically (English version).' :
              'üõ†Ô∏è Modo desarrollador activado!\nFormularios llenados autom√°ticamente.';

            alert(message);
          }

          // Command + H (Mac) o Ctrl + H (Windows/Linux) - About
          if ((e.metaKey || e.ctrlKey) && e.key === 'h') {
            e.preventDefault();

            const isSpanish = formData.language === 'espa√±ol';
            const aboutMessage = isSpanish ?
              'üë®‚Äçüíª Generador de Contenido YouTube\n\nüõ†Ô∏è Creado por: AndresV22\nüìß GitHub: https://github.com/AndresV22\n\n‚ö° Tecnolog√≠as utilizadas:\n‚Ä¢ React + Tailwind CSS\n‚Ä¢ Ollama API\n‚Ä¢ jsPDF\n\nüéØ Caracter√≠sticas:\n‚Ä¢ Generaci√≥n con IA local\n‚Ä¢ Templates especializados\n‚Ä¢ Exportaci√≥n PDF/TXT\n‚Ä¢ Streaming en tiempo real\n\nüí° Atajos de teclado:\n‚Ä¢ Cmd/Ctrl + D: Modo desarrollador\n‚Ä¢ Cmd/Ctrl + H: Acerca de\n‚Ä¢ Cmd/Ctrl + K: Efecto Matrix\n‚Ä¢ Cmd/Ctrl + P: Juego Pong\n ‚Ä¢ Cmd/Ctrl + I: Generador de Ideas\n ‚Ä¢ Cmd/Ctrl + 0: Dashboard' :
              'üë®‚Äçüíª YouTube Content Generator\n\nüõ†Ô∏è Created by: AndresV22\nüìß GitHub: https://github.com/AndresV22\n\n‚ö° Technologies used:\n‚Ä¢ React + Tailwind CSS\n‚Ä¢ Ollama API\n‚Ä¢ jsPDF\n\nüéØ Features:\n‚Ä¢ Local AI generation\n‚Ä¢ Specialized templates\n‚Ä¢ PDF/TXT export\n‚Ä¢ Real-time streaming\n\nüí° Keyboard shortcuts:\n‚Ä¢ Cmd/Ctrl + D: Developer mode\n‚Ä¢ Cmd/Ctrl + H: About\n‚Ä¢ Cmd/Ctrl + K: Matrix effect\n‚Ä¢ Cmd/Ctrl + P: Pong game\n ‚Ä¢ Cmd/Ctrl + I: Idea Generator\n ‚Ä¢ Cmd/Ctrl + 0: Dashboard';

            alert(aboutMessage);
          }

          // Command + K (Mac) o Ctrl + K (Windows/Linux) - Matrix Effect
          if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
            e.preventDefault();

            const isSpanish = formData.language === 'espa√±ol';
            const message = isSpanish ?
              'üî¥ Entrando a la Matrix...\n¬°Efecto activado por 10 segundos!' :
              'üî¥ Entering the Matrix...\nEffect activated for 10 seconds!';

            alert(message);

            // Activar efecto Matrix
            setShowMatrixEffect(true);

            // Desactivar despu√©s de 10 segundos
            setTimeout(() => {
              setShowMatrixEffect(false);
            }, 10000);
          }

          // Command + P (Mac) o Ctrl + P (Windows/Linux) - Pong Game
          if ((e.metaKey || e.ctrlKey) && e.key === 'p') {
            e.preventDefault();

            const isSpanish = formData.language === 'espa√±ol';

            if (!showPongGame) {
              const message = isSpanish ?
                'üéÆ ¬°Activando Pong!\n¬°√ösalo mientras esperas la generaci√≥n!' :
                'üéÆ Activating Pong!\nUse it while waiting for generation!';

              alert(message);
              setShowPongGame(true);
            } else {
              setShowPongGame(false);
            }
          }

          if ((e.metaKey || e.ctrlKey) && e.key === 'i') {
            e.preventDefault();

            const isSpanish = formData.language === 'espa√±ol';

            if (!showIdeaGenerator) {
              const message = isSpanish ?
                'üí° ¬°Activando Generador de Ideas!\n¬°Genera 10 conceptos √∫nicos para tu contenido!' :
                'üí° Activating Idea Generator!\nGenerate 10 unique concepts for your content!';

              alert(message);
              setShowIdeaGenerator(true);
            } else {
              setShowIdeaGenerator(false);
            }
          }

          if ((e.metaKey || e.ctrlKey) && e.key === '0') {
            e.preventDefault();

            const isSpanish = formData.language === 'espa√±ol';
            const message = isSpanish ?
              'üìä ¬°Navegando al Dashboard!\n¬°Ve tus estad√≠sticas y acceso r√°pido!' :
              'üìä Navigating to Dashboard!\nSee your statistics and quick access!';

            handleDashboard();

            // Solo mostrar alerta si no estamos ya en dashboard
            if (currentView !== 'dashboard') {
              alert(message);
            }
          }
        };

        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [formData.language, formData.topic]);

      // Mostrar tip aleatorio al cargar la aplicaci√≥n
      useEffect(() => {
        const tip = generateRandomTip(formData.language);
        setCurrentTip(tip);
        setShowTip(true);
      }, []); // Solo al montar el componente

      // Actualizar tip cuando cambie el idioma
      useEffect(() => {
        if (currentTip) {
          const tip = generateRandomTip(formData.language);
          setCurrentTip(tip);
        }
      }, [formData.language]);

      const availableModels = [
        'gemma3n:e4b',
        'mistral:7b',
        'mistral-nemo:12b',
      ];

      const categories = {
        espa√±ol: [
          'Entretenimiento',
          'Educaci√≥n',
          'Tecnolog√≠a',
          'Gaming',
          'Lifestyle',
          'Negocios',
          'Salud y Fitness',
          'Cocina',
          'Viajes',
          'M√∫sica',
          'Arte y Dise√±o',
          'Ciencia',
          'Historia',
          'Deportes',
          'Moda',
          'Comedia'
        ],
        english: [
          'Entertainment',
          'Education',
          'Technology',
          'Gaming',
          'Lifestyle',
          'Business',
          'Health & Fitness',
          'Cooking',
          'Travel',
          'Music',
          'Art & Design',
          'Science',
          'History',
          'Sports',
          'Fashion',
          'Comedy'
        ]
      };

      const scriptStyles = {
        espa√±ol: [
          'Informativo y profesional',
          'Casual y conversacional',
          'Energ√©tico y din√°mico',
          'Narrativo y storytelling',
          'Tutorial paso a paso',
          'Debate y an√°lisis',
          'Inspiracional y motivacional',
          'Humor√≠stico y entretenido'
        ],
        english: [
          'Informative and professional',
          'Casual and conversational',
          'Energetic and dynamic',
          'Narrative and storytelling',
          'Step-by-step tutorial',
          'Debate and analysis',
          'Inspirational and motivational',
          'Humorous and entertaining'
        ]
      };

      const templates = {
        espa√±ol: {
          'rese√±as-de-relojes': {
            name: 'Rese√±as de Relojes',
            description: 'Template optimizado para rese√±as de relojes inteligentes y tradicionales',
            structure: `
1. Hook inicial con el problema que resuelve el reloj
2. Dise√±o y materiales utilizados
3. Funciones y especificaciones t√©cnicas
4. Experiencia de usuario y facilidad de uso.
5. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
6. C√≥mo se ve en la mu√±eca.
7. Puntaje del 1 al 10 en las categor√≠as de funciones, durabilidad, resistencia, tama√±o y dise√±o con un puntaje promedio final.
8. Conclusi√≥n (SIN DESPEDIDA) y hook convincente y natural a video enlazado "${formData.linkedVideo}"`,
            promptAddition: 'El gui√≥n debe incluir detalles t√©cnicos espec√≠ficos, comparaciones con modelos similares, y una evaluaci√≥n objetiva basada en pruebas reales.'
          },
          'rese√±as-tecnologicas': {
            name: 'Rese√±as Tecnol√≥gicas',
            description: 'Template optimizado para reviews de gadgets, apps y tecnolog√≠a',
            structure: `
1. Hook inicial con el problema que resuelve el producto
2. Especificaciones t√©cnicas principales
3. Pruebas de rendimiento y casos de uso
4. Comparaci√≥n con competidores
5. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
6. Pros y contras detallados
7. Veredicto final y recomendaci√≥n de compra`,
            promptAddition: 'El gui√≥n debe incluir datos t√©cnicos espec√≠ficos, comparaciones directas con productos similares, y una evaluaci√≥n objetiva basada en pruebas reales.'
          },
          'contenido-educativo': {
            name: 'Contenido Educativo',
            description: 'Para tutoriales, explicaciones y contenido formativo',
            structure: `
1. Presentaci√≥n del tema y objetivos de aprendizaje
2. Conceptos b√°sicos y fundamentos
3. Explicaci√≥n paso a paso con ejemplos pr√°cticos
4. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
5. Errores comunes y c√≥mo evitarlos
6. Ejercicios o actividades para practicar
7. Resumen y pr√≥ximos pasos`,
            promptAddition: 'El contenido debe ser did√°ctico, usar ejemplos claros y progresivos, incluir analog√≠as para facilitar comprensi√≥n, y proporcionar recursos adicionales para profundizar.'
          },
          'maquillaje': {
            name: 'Maquillaje y Belleza',
            description: 'Para tutoriales de makeup, skincare y belleza',
            structure: `
1. Look final y ocasi√≥n para usarlo
2. Productos necesarios y alternativas econ√≥micas
3. Preparaci√≥n de la piel paso a paso
4. Aplicaci√≥n detallada con t√©cnicas espec√≠ficas
5. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
6. Tips y trucos profesionales
7. Cuidado y duraci√≥n del look`,
            promptAddition: 'Incluir nombres espec√≠ficos de productos, tonos recomendados para diferentes tipos de piel, t√©cnicas profesionales, y consejos de durabilidad.'
          },
          'moda': {
            name: 'Moda y Estilo',
            description: 'Para outfits, tendencias y consejos de estilo',
            structure: `
1. Tendencia o estilo a presentar
2. Inspiraci√≥n y referencias de celebridades/influencers
3. Piezas clave y c√≥mo combinarlas
4. Adaptaci√≥n a diferentes tipos de cuerpo
5. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
6. Opciones para diferentes presupuestos
7. Styling tips y accesorios`,
            promptAddition: 'Mencionar marcas espec√≠ficas, rangos de precios, opciones para diferentes presupuestos, y consejos para diferentes tipos de cuerpo y ocasiones.'
          },
          'gaming': {
            name: 'Gaming',
            description: 'Para gameplay, reviews de juegos y contenido gaming',
            structure: `
1. Presentaci√≥n del juego y primeras impresiones
2. Mec√°nicas de juego y controles
3. Historia, gr√°ficos y audio
4. Gameplay y momentos destacados
5. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
6. Comparaci√≥n con otros t√≠tulos del g√©nero
7. Puntuaci√≥n final y recomendaci√≥n`,
            promptAddition: 'Incluir detalles t√©cnicos del juego, comparaciones con entregas anteriores o t√≠tulos similares, mencionar plataformas disponibles y requisitos del sistema.'
          },
          'estilo-de-vida': {
            name: 'Estilo de Vida',
            description: 'Para vlogs, rutinas diarias y contenido lifestyle',
            structure: `
1. Introducci√≥n personal y contexto del d√≠a/tema
2. Rutina matutina o preparaci√≥n
3. Actividades principales del contenido
4. Momentos espont√°neos y behind the scenes
5. Call to action para suscribirse y ver m√°s rese√±as y para convertirse en miembro.
6. Reflexiones personales y aprendizajes
7. Planes futuros y despedida casual`,
            promptAddition: 'Mantener un tono personal y aut√©ntico, incluir an√©cdotas personales, momentos espont√°neos, y crear conexi√≥n emocional con la audiencia.'
          },
          'personalizado': {
            name: 'Template Personalizado',
            description: 'Define tu propia estructura personalizada',
            structure: '',
            promptAddition: ''
          }
        },
        english: {
          'watch-reviews': {
            name: 'Watch Reviews',
            description: 'Template optimized for smart and traditional watch reviews',
            structure: `
1. Initial hook with the problem the watch solves
2. Design and materials used
3. Features and technical specifications
4. User experience and ease of use
5. Call to action to subscribe and check memberships
6. How it looks on the wrist
7. Score from 1 to 10 in features, durability, resistance, size and design with an average final score
8. Conclusion (NO FAREWELL) and convincing, natural hook to linked video "${formData.linkedVideo}"`,
            promptAddition: 'The script should include specific technical details, comparisons with similar models, and objective evaluation based on real tests.'
          },
          'tech-reviews': {
            name: 'Tech Reviews',
            description: 'Template optimized for gadget, app and technology reviews',
            structure: `
1. Initial hook with the problem the product solves
2. Main technical specifications
3. Performance tests and use cases
4. Comparison with competitors
5. Call to action to subscribe and check memberships
6. Detailed pros and cons
7. Final verdict and purchase recommendation`,
            promptAddition: 'The script should include specific technical data, direct comparisons with similar products, and objective evaluation based on real tests.'
          },
          'educational-content': {
            name: 'Educational Content',
            description: 'For tutorials, explanations and educational content',
            structure: `
1. Topic presentation and learning objectives
2. Basic concepts and fundamentals
3. Step-by-step explanation with practical examples
4. Common mistakes and how to avoid them
5. Call to action to subscribe and check memberships
6. Exercises or activities to practice
7. Summary and next steps`,
            promptAddition: 'Content should be didactic, use clear and progressive examples, include analogies to facilitate understanding, and provide additional resources for deeper learning.'
          },
          'makeup': {
            name: 'Makeup & Beauty',
            description: 'For makeup tutorials, skincare and beauty content',
            structure: `
1. Final look and occasion to wear it
2. Necessary products and budget alternatives
3. Skin preparation step by step
4. Detailed application with specific techniques
5. Call to action to subscribe and check memberships
6. Professional tips and tricks
7. Look care and duration`,
            promptAddition: 'Include specific product names, recommended shades for different skin types, professional techniques, and durability tips.'
          },
          'fashion': {
            name: 'Fashion & Style',
            description: 'For outfits, trends and style advice',
            structure: `
1. Trend or style to present
2. Inspiration and celebrity/influencer references
3. Key pieces and how to combine them
4. Adaptation to different body types
5. Call to action to subscribe and check memberships
6. Options for different budgets
7. Styling tips and accessories`,
            promptAddition: 'Mention specific brands, price ranges, options for different budgets, and advice for different body types and occasions.'
          },
          'gaming': {
            name: 'Gaming',
            description: 'For gameplay, game reviews and gaming content',
            structure: `
1. Game presentation and first impressions
2. Game mechanics and controls
3. Story, graphics and audio
4. Gameplay and highlights
5. Call to action to subscribe and check memberships
6. Comparison with other titles in the genre
7. Final score and recommendation`,
            promptAddition: 'Include technical game details, comparisons with previous entries or similar titles, mention available platforms and system requirements.'
          },
          'lifestyle': {
            name: 'Lifestyle',
            description: 'For vlogs, daily routines and lifestyle content',
            structure: `
1. Personal introduction and context of the day/topic
2. Morning routine or preparation
3. Main content activities
4. Spontaneous moments and behind the scenes
5. Call to action to subscribe and check memberships
6. Personal reflections and learnings
7. Future plans and casual farewell`,
            promptAddition: 'Maintain a personal and authentic tone, include personal anecdotes, spontaneous moments, and create emotional connection with the audience.'
          },
          'custom': {
            name: 'Custom Template',
            description: 'Define your own custom structure',
            structure: '',
            promptAddition: ''
          }
        }
      };

      const getCurrentTemplates = () => templates[formData.language] || templates.espa√±ol;

      const getCurrentCategories = () => categories[formData.language] || categories.espa√±ol;
      const getCurrentScriptStyles = () => scriptStyles[formData.language] || scriptStyles.espa√±ol;
      const handleTemplateChange = (templateKey) => {
        setFormData(prev => ({
          ...prev,
          selectedTemplate: templateKey,
          customTemplate: templateKey === 'personalizado' || templateKey === 'custom' ? prev.customTemplate : ''
        }));
      };

      const getSelectedTemplateData = () => {
        const templates = getCurrentTemplates();
        const key = formData.selectedTemplate;
        return templates[key] || null;
      };

      // Auto-scroll del panel en tiempo real
      useEffect(() => {
        if (realTimePanelRef.current) {
          realTimePanelRef.current.scrollTop = realTimePanelRef.current.scrollHeight;
        }
      }, [realTimeResponse]);

      const handleInputChange = (field, value) => {
        setFormData(prev => ({ ...prev, [field]: value }));
        setError('');
      };

      const validateStep = (step) => {
        switch (step) {
          case 1:
            return formData.baseUrl && formData.model && formData.category && formData.language;
          case 2:
            return formData.topic &&
              formData.topic.length <= 100 &&
              formData.scriptStyle &&
              formData.channelName &&
              formData.channelName.length <= 100 &&
              formData.linkedVideo.length <= 100 &&
              formData.keyData.length <= 840;
          default:
            return true;
        }
      };

      const nextStep = () => {
        if (validateStep(currentStep)) {
          setCurrentStep(prev => prev + 1);
        } else {
          setError(formData.language === 'espa√±ol' ? 'Por favor completa todos los campos requeridos' : 'Please complete all required fields');
        }
      };

      const prevStep = () => {
        setCurrentStep(prev => prev - 1);
        setError('');
      };

      const generatePrompt = () => {
        const isSpanish = formData.language === 'espa√±ol';

        if (isSpanish) {
          return `Eres un experto creador de contenido para YouTube. Tu tarea es generar contenido COMPLETO y EXTENSO para un video en ESPA√ëOL.

INFORMACI√ìN DEL VIDEO:
- Categor√≠a: ${formData.category}
- Tema: ${formData.topic}${formData.keyData ? `\n- Datos clave a incluir: ${formData.keyData}` : ''}${formData.selectedTemplate && getSelectedTemplateData() ? `\n- Template seleccionado: ${getSelectedTemplateData().name}` : ''}${formData.selectedTemplate && (formData.selectedTemplate === 'personalizado' && formData.customTemplate) ? `\n- Estructura personalizada: ${formData.customTemplate}` : ''}
- Estilo: ${formData.scriptStyle}
- Canal: ${formData.channelName}
- Video a enlazar: ${formData.linkedVideo}

INSTRUCCIONES CR√çTICAS:
1. Responde √öNICAMENTE con un JSON v√°lido
2. NO agregues texto explicativo antes o despu√©s del JSON
3. NO uses markdown ni bloques de c√≥digo
4. NO utilices etiquetas como \`\`\`json o <think> </think>
5. NO incluyas saltos de l√≠nea dentro de los strings del JSON
6. Escapa adecuadamente las comillas dentro del contenido: usa \\" para comillas literales
7. El JSON debe tener EXACTAMENTE esta estructura:

{
 "titles": ["T√≠tulo 1", "T√≠tulo 2", "T√≠tulo 3", "T√≠tulo 4", "T√≠tulo 5"],
  "thumbnails": ["Frase 1", "Frase 2", "Frase 3", "Frase 4", "Frase 5"],
  "description": "Descripci√≥n optimizada para SEO aqu√≠...",
  "tags": ["tag1", "tag2", "tag3", "tag4", "tag5", "tag6", "tag7", "tag8", "tag9", "tag10", "tag11", "tag12", "tag13", "tag14", "tag15", "tag16", "tag17", "tag18", "tag19", "tag20"],
  "pinnedComment": "Comentario fijado sugerido aqu√≠...",
  "communityPost": "Post para Community Tab aqu√≠...",
  "script": "GUI√ìN COMPLETO AQU√ç...",
}

ESPECIFICACIONES DEL CONTENIDO EN ESPA√ëOL:
- T√≠tulos: 5 t√≠tulos llamativos, clickbait y virales en espa√±ol
- Miniaturas: 5 frases cortas e impactantes para thumbnails en espa√±ol, no m√°s de 5 palabras cada una
- Gui√≥n: Debe ser MUY EXTENSO (m√≠nimo 2000 palabras), en espa√±ol, con:
  * Hook potente inicial SIN saludos tradicionales
  * Desarrollo completo del tema con m√∫ltiples secciones
  * Ejemplos, an√©cdotas y casos pr√°cticos detallados
  * Call-to-action a mitad del video: "Si te est√° gustando este contenido, no olvides suscribirte y darle me gusta. Tambi√©n revisa las membres√≠as del canal para desbloquear contenido exclusivo"
  * M√∫ltiples ganchos de retenci√≥n a lo largo del video
  * Explicaciones paso a paso cuando sea necesario
  * Conclusi√≥n enlazando naturalmente con "${formData.linkedVideo}"
  * SIN despedidas tradicionales
- Descripci√≥n: Una descripci√≥n optimizada para SEO (m√°ximo 500 caracteres) que incluya keywords relevantes
- Tags: 20 tags relevantes y populares relacionados con el tema, separados por comas, sin s√≠mbolo '#'
- Comentario fijado: Un comentario escrito por el autor del video para fijar, que genere engagement y promueva interacci√≥n
- Post comunidad: Un post atractivo para la pesta√±a Community para llamar a los sucriptores a interactuar y ver el nuevo video

IMPORTANTE: El gui√≥n debe ser EXTENSO y DETALLADO, como si fuera para un video de 15-20 minutos m√≠nimo. ${formData.selectedTemplate && getSelectedTemplateData() && getSelectedTemplateData().promptAddition ? `\n\nINSTRUCCIONES DEL TEMPLATE:\n${getSelectedTemplateData().promptAddition}` : ''}${formData.selectedTemplate && (formData.selectedTemplate === 'personalizado' && formData.customTemplate) ? `\n\nESTRUCTURA PERSONALIZADA A SEGUIR:\n${formData.customTemplate}` : ''}`;
        } else {
          return `You are an expert YouTube content creator. Your task is to generate COMPLETE and EXTENSIVE content for a video in ENGLISH.

VIDEO INFORMATION:
- Category: ${formData.category}
- Topic: ${formData.topic}${formData.keyData ? `\n- Key data to include: ${formData.keyData}` : ''}${formData.selectedTemplate && getSelectedTemplateData() ? `\n- Selected template: ${getSelectedTemplateData().name}` : ''}${formData.selectedTemplate && (formData.selectedTemplate === 'custom' && formData.customTemplate) ? `\n- Custom structure: ${formData.customTemplate}` : ''}
- Style: ${formData.scriptStyle}
- Channel: ${formData.channelName}
- Video to link: ${formData.linkedVideo}

CRITICAL INSTRUCTIONS:
1. Respond ONLY with valid JSON
2. DO NOT add explanatory text before or after the JSON
3. DO NOT use markdown or code blocks
4. DO NOT use tags like \`\`\`json or <think> </think>
5. DO NOT include line breaks within JSON strings
6. Properly escape quotes within content: use \\" for literal quotes
7. The JSON must have EXACTLY this structure:

{
    "titles": ["Title 1", "Title 2", "Title 3", "Title 4", "Title 5"],
  "thumbnails": ["Phrase 1", "Phrase 2", "Phrase 3", "Phrase 4", "Phrase 5"],
  "description": "SEO optimized description here...",
  "tags": ["tag1", "tag2", "tag3", "tag4", "tag5", "tag6", "tag7", "tag8", "tag9", "tag10", "tag11", "tag12", "tag13", "tag14", "tag15", "tag16", "tag17", "tag18", "tag19", "tag20"],
  "pinnedComment": "Suggested pinned comment here...",
  "communityPost": "Community Tab post here...",
  "script": "COMPLETE SCRIPT HERE...",
}

CONTENT SPECIFICATIONS IN ENGLISH:
- Titles: 5 catchy, clickbait and viral titles in English
- Thumbnails: 5 short and impactful phrases for thumbnails in English, no more than 5 words per thumbnail
- Script: Must be VERY EXTENSIVE (minimum 2000 words), in English, with:
  * Powerful initial hook WITHOUT traditional greetings
  * Complete topic development with multiple sections
  * Detailed examples, anecdotes and practical cases
  * Call-to-action in the middle of the video: "If you're enjoying this content, don't forget to subscribe and hit the like button. Also check out the channel memberships to unlock exclusive content"
  * Multiple retention hooks throughout the video
  * Step-by-step explanations when necessary
  * Conclusion naturally linking to "${formData.linkedVideo}"
  * NO traditional farewells
- Description: An SEO optimized description (maximum 500 characters) including relevant keywords
- Tags: 20 relevant and popular tags related to the topic, separated by commas
- Pinned comment: A suggested pinned comment from the author that generates engagement and promotes interaction
- Community post: An attractive post for the Community tab to encourage subscribers to interact and watch the new video

IMPORTANT: The script must be EXTENSIVE and DETAILED, as if it were for a 15-20 minute video minimum.${formData.selectedTemplate && getSelectedTemplateData() && getSelectedTemplateData().promptAddition ? `\n\nTEMPLATE INSTRUCTIONS:\n${getSelectedTemplateData().promptAddition}` : ''}${formData.selectedTemplate && (formData.selectedTemplate === 'custom' && formData.customTemplate) ? `\n\nCUSTOM STRUCTURE TO FOLLOW:\n${formData.customTemplate}` : ''}`;
        }
      };

      const testOllamaConnection = async () => {
        setIsTestingConnection(true);
        setError('');

        // Crear controlador para cancelar
        const abortController = new AbortController();
        abortControllerRef.current = abortController;

        try {
          const testBody = {
            model: formData.model,
            prompt: formData.language === 'espa√±ol' ?
              'Responde con exactamente este JSON: {"test": "success", "message": "conexi√≥n funcionando"}' :
              'Respond with exactly this JSON: {"test": "success", "message": "connection working"}',
            options: {
              think: false,
            }
          };

          console.log('Testing Ollama connection with:', testBody);

          const response = await fetch(formData.baseUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(testBody),
            signal: abortController.signal
          });

          console.log('Response status:', response.status);
          console.log('Response ok:', response.ok);

          const contentType = response.headers.get("Content-Type");
          console.log("Content type:", contentType);

          if (response.ok) {
            const rawText = await response.text();
            // Eliminar etiquetas <think>...</think> y bloques ```json o ```
            let noThinkingText = rawText
              .replace(/<think>[\s\S]*?<\/think>\n?/g, '')
              .replace(/```json[\s\S]*?```/g, '')
              .replace(/```/g, '')
              .trim();
            console.log('Raw response text:', noThinkingText);

            let data;
            try {
              data = JSON.parse(noThinkingText);
              console.log('Successfully parsed as JSON');
            } catch (rawParseError) {
              console.log('Processing as NDJSON...');
              const lines = noThinkingText.trim().split('\n').filter(line => line.trim());
              const jsonObjects = [];

              lines.forEach((line, index) => {
                try {
                  const parsed = JSON.parse(line);
                  jsonObjects.push(parsed);
                } catch (lineError) {
                  console.log(`Line ${index + 1} is not JSON:`, line);
                }
              });

              if (jsonObjects.length === 0) {
                throw new Error(`No valid JSON objects found in response:\n${noThinkingText.substring(0, 200)}...`);
              }

              data = jsonObjects[jsonObjects.length - 1];
            }

            setError('');
            const successMsg = formData.language === 'espa√±ol' ?
              `‚úÖ Conexi√≥n exitosa!\n\nTipo: ${contentType}\nRespuesta: "${data.response?.substring(0, 100) || 'OK'}..."` :
              `‚úÖ Connection successful!\n\nType: ${contentType}\nResponse: "${data.response?.substring(0, 100) || 'OK'}..."`;
            alert(successMsg);
          } else {
            const errorText = await response.text();
            throw new Error(`HTTP ${response.status}: ${response.statusText}\nResponse: ${errorText}`);
          }
        } catch (err) {
          if (err.name === 'AbortError') {
            const cancelMsg = formData.language === 'espa√±ol' ?
              'Prueba de conexi√≥n cancelada por el usuario' :
              'Connection test cancelled by user';
            setError(cancelMsg);
            return;
          }

          console.error('Complete error:', err);
          let errorMessage = formData.language === 'espa√±ol' ?
            `‚ùå Error de conexi√≥n:\n\n` : `‚ùå Connection error:\n\n`;
          errorMessage += `Type: ${err.name || 'Error'}\n`;
          errorMessage += `Message: ${err.message}\n\n`;

          if (err.message === 'Failed to fetch') {
            errorMessage += formData.language === 'espa√±ol' ?
              `Posibles causas:\n‚Ä¢ Ollama no ejecut√°ndose (ollama serve)\n‚Ä¢ URL incorrecta: ${formData.baseUrl}\n‚Ä¢ Modelo no descargado: ollama pull ${formData.model}` :
              `Possible causes:\n‚Ä¢ Ollama not running (ollama serve)\n‚Ä¢ Incorrect URL: ${formData.baseUrl}\n‚Ä¢ Model not downloaded: ollama pull ${formData.model}`;
          }

          setError(errorMessage);
        } finally {
          setIsTestingConnection(false);
          abortControllerRef.current = null;
        }
      };

      const cancelTestConnection = () => {
        if (abortControllerRef.current) {
          abortControllerRef.current.abort();
        }
      };

      const generateContentWithStreaming = async () => {
        setGenerationStartTime(Date.now());
        setIsGenerating(true);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(true);

        // Crear controlador para cancelar
        const abortController = new AbortController();
        abortControllerRef.current = abortController;

        try {
          const prompt = generatePrompt();
          const requestBody = {
            model: formData.model,
            prompt: prompt,
            stream: true, // Habilitar streaming
            options: {
              num_predict: formData.contextWindow,
              temperature: 0.7,
              ...(formData.disableThinking && {
                think: false,
                reasoning: false,
                no_reasoning: true
              })
            }
          };

          console.log('Generating content with streaming:', requestBody);

          const response = await fetch(formData.baseUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody),
            signal: abortController.signal
          });

          if (!response.ok) {
            const errorText = await response.text();
            let errorMessage = `Error ${response.status}: ${response.statusText}\n\n${errorText}`;

            if (response.status === 404) {
              errorMessage += formData.language === 'espa√±ol' ?
                `\n\nEl modelo "${formData.model}" no est√° disponible.\nDesc√°rgalo: ollama pull ${formData.model}` :
                `\n\nModel "${formData.model}" not available.\nDownload: ollama pull ${formData.model}`;
            }

            throw new Error(errorMessage);
          }

          // Leer el stream
          const reader = response.body.getReader();
          const decoder = new TextDecoder();
          let fullResponse = '';
          let currentChunk = '';

          const isSpanish = formData.language === 'espa√±ol';
          setRealTimeResponse(isSpanish ? 'ü§ñ Iniciando generaci√≥n...\n\n' : 'ü§ñ Starting generation...\n\n');

          while (true) {
            const { done, value } = await reader.read();

            if (done) break;

            // Verificar si fue cancelado
            if (abortController.signal.aborted) {
              reader.cancel();
              throw new Error('AbortError');
            }

            const chunk = decoder.decode(value, { stream: true });
            currentChunk += chunk;

            // Procesar l√≠neas completas
            const lines = currentChunk.split('\n');
            currentChunk = lines.pop(); // Guardar l√≠nea incompleta

            for (const line of lines) {
              if (line.trim()) {
                try {
                  const data = JSON.parse(line);
                  if (data.response) {
                    // Filtrar pensamiento si est√° desactivado
                    let responseText = data.response;
                    if (formData.disableThinking) {
                      // Filtrar tags de pensamiento comunes en modelos como DeepSeek
                      responseText = responseText.replace(/<think>[\s\S]*?<\/think>/g, '');
                      responseText = responseText.replace(/<thinking>[\s\S]*?<\/thinking>/g, '');
                      responseText = responseText.replace(/\[ÊÄùËÄÉ\][\s\S]*?\[\/ÊÄùËÄÉ\]/g, '');
                      responseText = responseText.replace(/\[Thinking\][\s\S]*?\[\/Thinking\]/g, '');
                      responseText = responseText.replace(/^ÊÄùËÄÉÔºö.*?(?=\n|$)/gm, '');
                      responseText = responseText.replace(/^Thinking:.*?(?=\n|$)/gm, '');
                    }

                    if (responseText) {
                      fullResponse += responseText;
                      setRealTimeResponse(prev => prev + responseText);
                    }
                  }

                  // Si est√° done, hemos terminado
                  if (data.done) {
                    const finalMsg = isSpanish ?
                      '\n\n‚úÖ Generaci√≥n completada. Procesando resultado...' :
                      '\n\n‚úÖ Generation completed. Processing result...';
                    setRealTimeResponse(prev => prev + finalMsg);
                    break;
                  }
                } catch (parseError) {
                  console.log('Could not parse streaming line:', line);
                }
              }
            }
          }

          // Procesar respuesta final
          console.log('Full response length:', fullResponse.length);

          // Funci√≥n para limpiar y reparar JSON
          const cleanAndRepairJSON = (content) => {
            let cleaned = content;

            // 1. Eliminar bloques de c√≥digo y etiquetas de pensamiento
            cleaned = cleaned
              .replace(/```json/gi, '')
              .replace(/```/g, '')
              .replace(/<think>[\s\S]*?<\/think>/gi, '')
              .replace(/<thinking>[\s\S]*?<\/thinking>/gi, '')
              .trim();

            // 2. Buscar el inicio y final del JSON
            const jsonStart = cleaned.indexOf('{');
            const jsonEnd = cleaned.lastIndexOf('}');

            if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {
              cleaned = cleaned.substring(jsonStart, jsonEnd + 1);
            }

            // 3. Reparar saltos de l√≠nea dentro de strings del JSON
            // Primero, encontrar y reparar el campo "script" con mejor manejo de comillas
            cleaned = cleaned.replace(/"script":\s*"([\s\S]*?)"(?=\s*[,}])/g, (match, scriptContent) => {
              // MEJORADO: Manejo m√°s robusto de comillas y caracteres especiales
              const escapedScript = scriptContent
                .replace(/\\"/g, '___TEMP_ESCAPED_QUOTE___') // Preservar comillas ya escapadas temporalmente
                .replace(/"/g, '\\"') // Escapar comillas dobles sueltas
                .replace(/___TEMP_ESCAPED_QUOTE___/g, '\\"') // Restaurar comillas escapadas
                .replace(/\\\\/g, '\\') // Normalizar backslashes dobles
                .replace(/\r\n/g, '\\n') // Convertir CRLF a \n
                .replace(/\n/g, '\\n') // Escapar saltos de l√≠nea
                .replace(/\r/g, '\\n') // Convertir CR a \n
                .replace(/\t/g, '\\t') // Escapar tabs
                .replace(/'/g, "\\'"); // Escapar comillas simples tambi√©n

              return `"script": "${escapedScript}"`;
            });

            // 4. Reparar arrays de t√≠tulos y thumbnails que pueden tener saltos de l√≠nea
            cleaned = cleaned.replace(/"(titles|thumbnails)":\s*\[([\s\S]*?)\]/g, (match, fieldName, arrayContent) => {
              // Limpiar el contenido del array
              const cleanArray = arrayContent
                .replace(/\n\s*/g, ' ') // Reemplazar saltos de l√≠nea con espacios
                .replace(/,\s*,/g, ',') // Eliminar comas duplicadas
                .replace(/,\s*]/g, ']'); // Eliminar comas antes del cierre

              return `"${fieldName}": [${cleanArray}]`;
            });

            // 5. Reparar comas finales y estructura general
            cleaned = cleaned
              .replace(/,(\s*[}\]])/g, '$1') // Eliminar comas antes de } o ]
              .replace(/([}\]])(\s*)([{\[])/g, '$1,$2$3') // A√±adir comas entre objetos/arrays
              .replace(/}\s*{/g, '},{') // Separar objetos adyacentes
              .replace(/]\s*\[/g, '],['); // Separar arrays adyacentes

            // 6. Asegurar que termine correctamente
            if (!cleaned.endsWith('}') && !cleaned.endsWith(']')) {
              cleaned += '}';
            }

            return cleaned;
          };

          let cleanedContent = cleanAndRepairJSON(fullResponse);

          console.log('Cleaned content: ', cleanedContent);

          try {
            const parsedResults = validateAndFixJSON(cleanedContent);

            // Extract only the required fields, ignore any extras
            const { titles, thumbnails, description, tags, pinnedComment, communityPost, script } = parsedResults;
            if (!titles || !thumbnails || !description || !tags || !pinnedComment || !communityPost || !script) {
              throw new Error('Invalid response structure: missing required fields');
            }
            setResults({ titles, thumbnails, description, tags, pinnedComment, communityPost, script });
            const newHistoryId = saveToHistory(formData, { titles, thumbnails, description, tags, pinnedComment, communityPost, script });
            setCurrentHistoryId(newHistoryId);
            setCurrentStep(3);

            const successMsg = isSpanish ?
              '\n\nüéâ ¬°Contenido generado exitosamente!' :
              '\n\nüéâ Content generated successfully!';
            setRealTimeResponse(prev => prev + successMsg);

          } catch (parseError) {
            let errorMessage = formData.language === 'espa√±ol' ?
              `Error procesando respuesta JSON:\n\nError: ${parseError.message}\n` :
              `Error processing JSON response:\n\nError: ${parseError.message}\n`;
            setError(errorMessage);
            setManualContent(fullResponse); // Guardar el contenido para edici√≥n manual
            setShowManualEditor(true); // Mostrar el editor
            const errorMsg = isSpanish ?
              '\n\n‚ùå Error al procesar JSON. Puedes editarlo manualmente o intentar generar de nuevo.' :
              '\n\n‚ùå Error processing JSON. You can edit it manually or try generating again.';
            setRealTimeResponse(prev => prev + errorMsg);
            return; // No lanzar error, solo mostrar editor
          }

        } catch (err) {
          if (err.name === 'AbortError' || err.message === 'AbortError') {
            const cancelMsg = formData.language === 'espa√±ol' ?
              '\n\nüõë Generaci√≥n cancelada por el usuario' :
              '\n\nüõë Generation cancelled by user';
            setRealTimeResponse(prev => prev + cancelMsg);
            setError(formData.language === 'espa√±ol' ?
              'Generaci√≥n cancelada por el usuario' :
              'Generation cancelled by user');
            return;
          }

          console.error('Generation error:', err);
          let errorMessage = formData.language === 'espa√±ol' ?
            `Error al generar contenido:\n\n${err.message}` :
            `Error generating content:\n\n${err.message}`;
          setError(errorMessage);

          const errorMsg = formData.language === 'espa√±ol' ?
            `\n\n‚ùå Error: ${err.message}` :
            `\n\n‚ùå Error: ${err.message}`;
          setRealTimeResponse(prev => prev + errorMsg);
        } finally {
          setIsGenerating(false);
          abortControllerRef.current = null;
        }
      };

      // Funci√≥n para generar el prompt de ideas
      const generateIdeaPrompt = (topic) => {
        const isSpanish = formData.language === 'espa√±ol';

        if (isSpanish) {
          return `Eres un experto en generaci√≥n de contenido para YouTube. Tu tarea es generar exactamente 10 ideas creativas y √∫nicas de videos sobre el tema: "${topic}".

INSTRUCCIONES CR√çTICAS:
1. Responde √öNICAMENTE con un JSON v√°lido
2. NO agregues texto explicativo antes o despu√©s del JSON
3. NO uses markdown ni bloques de c√≥digo
4. NO utilices etiquetas como \`\`\`json
5. El JSON debe tener EXACTAMENTE esta estructura:

{
  "ideas": [
    {
      "title": "T√≠tulo atractivo del video aqu√≠",
      "description": "Descripci√≥n detallada de un p√°rrafo explicando el concepto, objetivo y contenido del video. Debe ser espec√≠fica y dar una visi√≥n clara de lo que incluir√≠a el video.",
      "category": "Categor√≠a apropiada",
      "template": "template-sugerido",
      "keyPoints": ["Punto clave 1", "Punto clave 2", "Punto clave 3"],
      "estimatedLength": "10-15 minutos",
      "difficulty": "Principiante|Intermedio|Avanzado",
      "targetAudience": "Audiencia objetivo"
    }
  ]
}

MAPEO ESTRICTO DE CATEGOR√çAS Y TEMPLATES:
- Para rese√±as de relojes/smartwatches ‚Üí category: "Tecnolog√≠a", template: "rese√±as-de-relojes"
- Para reviews de gadgets/electr√≥nicos ‚Üí category: "Tecnolog√≠a", template: "rese√±as-tecnologicas"
- Para tutoriales de maquillaje/belleza ‚Üí category: "Lifestyle", template: "maquillaje"
- Para consejos de moda/outfits ‚Üí category: "Lifestyle", template: "moda"
- Para gaming/videojuegos ‚Üí category: "Gaming", template: "gaming"
- Para vlogs/rutinas diarias ‚Üí category: "Lifestyle", template: "estilo-de-vida"
- Para tutoriales educativos ‚Üí category: "Educaci√≥n", template: "contenido-educativo"
- Para contenido de entretenimiento ‚Üí category: "Entretenimiento", template: ""
- Para fitness/ejercicio ‚Üí category: "Salud y Fitness", template: ""
- Para recetas/cocina ‚Üí category: "Cocina", template: ""
- Para viajes ‚Üí category: "Viajes", template: ""
- Para m√∫sica ‚Üí category: "M√∫sica", template: ""
- Para arte/dise√±o ‚Üí category: "Arte y Dise√±o", template: ""
- Para ciencia ‚Üí category: "Ciencia", template: ""
- Para historia ‚Üí category: "Historia", template: ""
- Para deportes ‚Üí category: "Deportes", template: ""
- Para negocios/emprendimiento ‚Üí category: "Negocios", template: ""
- Para comedia ‚Üí category: "Comedia", template: ""

CATEGOR√çAS V√ÅLIDAS: ${getCurrentCategories().join(', ')}
TEMPLATES DISPONIBLES: ${Object.keys(getCurrentTemplates()).join(', ')}

IMPORTANTE: 
- Analiza cuidadosamente el contenido de cada idea para asignar la categor√≠a M√ÅS ESPEC√çFICA
- Si el video es una rese√±a de producto tecnol√≥gico, usa "Tecnolog√≠a" no "Negocios"
- Si hay un template espec√≠fico que coincida perfectamente con el tipo de contenido, √∫salo
- Cada idea debe tener exactamente 3 puntos clave relevantes
Aseg√∫rate de que todas las ideas sean √∫nicas, variadas y relevantes para "${topic}".

EJEMPLOS DE MAPEO CORRECTO:
- "Rese√±a del Apple Watch Series 9" ‚Üí category: "Tecnolog√≠a", template: "rese√±as-de-relojes"
- "Tutorial de maquillaje para principiantes" ‚Üí category: "Lifestyle", template: "maquillaje"
- "Review del iPhone 15 Pro" ‚Üí category: "Tecnolog√≠a", template: "rese√±as-tecnologicas"
- "C√≥mo vestirse para una entrevista" ‚Üí category: "Lifestyle", template: "moda"
- "Gameplay de Cyberpunk 2077" ‚Üí category: "Gaming", template: "gaming"`;
        } else {
          return `You are an expert in YouTube content generation. Your task is to generate exactly 10 creative and unique video ideas about the topic: "${topic}".

CRITICAL INSTRUCTIONS:
1. Respond ONLY with valid JSON
2. DO NOT add explanatory text before or after the JSON
3. DO NOT use markdown or code blocks
4. DO NOT use tags like \`\`\`json
5. The JSON must have EXACTLY this structure:

{
  "ideas": [
    {
      "title": "Attractive video title here",
      "description": "Detailed paragraph description explaining the concept, objective and video content. Should be specific and give a clear vision of what the video would include.",
      "category": "Appropriate category",
      "template": "suggested-template",
      "keyPoints": ["Key point 1", "Key point 2", "Key point 3"],
      "estimatedLength": "10-15 minutes",
      "difficulty": "Beginner|Intermediate|Advanced",
      "targetAudience": "Target audience"
    }
  ]
}

STRICT CATEGORY AND TEMPLATE MAPPING:
- For watch/smartwatch reviews ‚Üí category: "Technology", template: "watch-reviews"
- For gadget/electronics reviews ‚Üí category: "Technology", template: "tech-reviews"
- For makeup/beauty tutorials ‚Üí category: "Lifestyle", template: "makeup"
- For fashion/outfit advice ‚Üí category: "Lifestyle", template: "fashion"
- For gaming/videogames ‚Üí category: "Gaming", template: "gaming"
- For vlogs/daily routines ‚Üí category: "Lifestyle", template: "lifestyle"
- For educational tutorials ‚Üí category: "Education", template: "educational-content"
- For entertainment content ‚Üí category: "Entertainment", template: ""
- For fitness/exercise ‚Üí category: "Health & Fitness", template: ""
- For recipes/cooking ‚Üí category: "Cooking", template: ""
- For travel ‚Üí category: "Travel", template: ""
- For music ‚Üí category: "Music", template: ""
- For art/design ‚Üí category: "Art & Design", template: ""
- For science ‚Üí category: "Science", template: ""
- For history ‚Üí category: "History", template: ""
- For sports ‚Üí category: "Sports", template: ""
- For business/entrepreneurship ‚Üí category: "Business", template: ""
- For comedy ‚Üí category: "Comedy", template: ""

VALID CATEGORIES: ${getCurrentCategories().join(', ')}
AVAILABLE TEMPLATES: ${Object.keys(getCurrentTemplates()).join(', ')}

IMPORTANT: 
- Carefully analyze each idea's content to assign the MOST SPECIFIC category
- If the video is a tech product review, use "Technology" not "Business"
- If there's a specific template that perfectly matches the content type, use it
- Each idea must have exactly 3 relevant key points
- Make sure all ideas are unique, varied and relevant to "${topic}".`;
        }
      };

      // Funci√≥n principal para generar ideas
      // Funci√≥n principal para generar ideas
      const generateIdeas = async () => {
        if (!ideaGeneratorTopic.trim()) {
          const isSpanish = formData.language === 'espa√±ol';
          setIdeaGenerationError(isSpanish ? 'Por favor ingresa un tema' : 'Please enter a topic');
          return;
        }

        setIsGeneratingIdeas(true);
        setIdeaGenerationError('');
        setGeneratedIdeas([]);

        // Crear controlador para cancelar
        const abortController = new AbortController();
        abortControllerRef.current = abortController;

        try {
          const prompt = generateIdeaPrompt(ideaGeneratorTopic);
          const requestBody = {
            model: formData.model,
            prompt: prompt,
            stream: true, // Habilitar streaming para ideas tambi√©n
            options: {
              num_predict: 4000,
              temperature: 0.8,
              ...(formData.disableThinking && {
                think: false,
                reasoning: false,
                no_reasoning: true
              })
            }
          };

          console.log('Generating ideas with streaming:', requestBody);

          const response = await fetch(formData.baseUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody),
            signal: abortController.signal
          });

          if (!response.ok) {
            const errorText = await response.text();
            let errorMessage = `Error ${response.status}: ${response.statusText}\n\n${errorText}`;

            if (response.status === 404) {
              errorMessage += formData.language === 'espa√±ol' ?
                `\n\nEl modelo "${formData.model}" no est√° disponible.\nDesc√°rgalo: ollama pull ${formData.model}` :
                `\n\nModel "${formData.model}" not available.\nDownload: ollama pull ${formData.model}`;
            }

            throw new Error(errorMessage);
          }

          // Leer el stream
          const reader = response.body.getReader();
          const decoder = new TextDecoder();
          let fullResponse = '';
          let currentChunk = '';

          const isSpanish = formData.language === 'espa√±ol';

          // Funci√≥n para actualizar el panel en tiempo real
          const updateRealTimeResponse = (text) => {
            // Buscar el componente IdeaGenerator activo y actualizar su estado
            const event = new CustomEvent('ideaGenerationProgress', { detail: text });
            window.dispatchEvent(event);
          };

          updateRealTimeResponse(isSpanish ? 'ü§ñ Iniciando generaci√≥n de ideas...\n\n' : 'ü§ñ Starting idea generation...\n\n');

          while (true) {
            const { done, value } = await reader.read();

            if (done) break;

            if (abortController.signal.aborted) {
              reader.cancel();
              throw new Error('AbortError');
            }

            const chunk = decoder.decode(value, { stream: true });
            currentChunk += chunk;

            const lines = currentChunk.split('\n');
            currentChunk = lines.pop();

            for (const line of lines) {
              if (line.trim()) {
                try {
                  const data = JSON.parse(line);
                  if (data.response) {
                    let responseText = data.response;
                    if (formData.disableThinking) {
                      responseText = responseText.replace(/<think>[\s\S]*?<\/think>/g, '');
                      responseText = responseText.replace(/<thinking>[\s\S]*?<\/thinking>/g, '');
                    }

                    if (responseText) {
                      fullResponse += responseText;
                      updateRealTimeResponse(responseText);
                    }
                  }

                  if (data.done) {
                    const finalMsg = isSpanish ?
                      '\n\n‚úÖ Generaci√≥n completada. Procesando ideas...' :
                      '\n\n‚úÖ Generation completed. Processing ideas...';
                    updateRealTimeResponse(finalMsg);
                    break;
                  }
                } catch (parseError) {
                  console.log('Could not parse streaming line:', line);
                }
              }
            }
          }

          // Procesar respuesta final
          console.log('Full response length:', fullResponse.length);

          let cleanedResponse = fullResponse
            .replace(/```json/gi, '')
            .replace(/```/g, '')
            .replace(/<think>[\s\S]*?<\/think>/gi, '')
            .replace(/<thinking>[\s\S]*?<\/thinking>/gi, '')
            .trim();

          const jsonStart = cleanedResponse.indexOf('{');
          const jsonEnd = cleanedResponse.lastIndexOf('}');

          if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {
            cleanedResponse = cleanedResponse.substring(jsonStart, jsonEnd + 1);
          }

          console.log('Cleaned response:', cleanedResponse);

          const parsedResponse = JSON.parse(cleanedResponse);

          if (!parsedResponse.ideas || !Array.isArray(parsedResponse.ideas)) {
            throw new Error('Invalid response format: missing ideas array');
          }

          if (parsedResponse.ideas.length !== 10) {
            console.warn(`Expected 10 ideas, got ${parsedResponse.ideas.length}`);
          }

          const validatedIdeas = parsedResponse.ideas.slice(0, 10).map((idea, index) => {
            // Validar y corregir categor√≠a
            let validCategory = idea.category;
            const availableCategories = getCurrentCategories();
            if (!availableCategories.includes(validCategory)) {
              // Buscar categor√≠a similar o usar la primera disponible
              validCategory = availableCategories.find(cat =>
                cat.toLowerCase().includes(validCategory?.toLowerCase()) ||
                validCategory?.toLowerCase().includes(cat.toLowerCase())
              ) || availableCategories[0];
            }

            // Validar y corregir template
            let validTemplate = idea.template;
            const availableTemplates = Object.keys(getCurrentTemplates());
            if (validTemplate && !availableTemplates.includes(validTemplate)) {
              // Buscar template similar o dejar vac√≠o
              validTemplate = availableTemplates.find(temp =>
                temp.toLowerCase().includes(validTemplate?.toLowerCase()) ||
                validTemplate?.toLowerCase().includes(temp.toLowerCase())
              ) || '';
            }

            return {
              title: idea.title || `Idea ${index + 1}`,
              description: idea.description || 'Descripci√≥n no disponible',
              category: validCategory,
              template: validTemplate || '',
              keyPoints: Array.isArray(idea.keyPoints) ? idea.keyPoints.slice(0, 3) : [],
              estimatedLength: idea.estimatedLength || '10-15 minutos',
              difficulty: idea.difficulty || 'Intermedio',
              targetAudience: idea.targetAudience || 'General'
            };
          });

          setGeneratedIdeas(validatedIdeas);

          const successMsg = isSpanish ?
            `\n\nüéâ ¬°${validatedIdeas.length} ideas generadas exitosamente!` :
            `\n\nüéâ ${validatedIdeas.length} ideas generated successfully!`;
          updateRealTimeResponse(successMsg);

          // Mostrar notificaci√≥n temporal
          const notification = document.createElement('div');
          notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in';
          notification.textContent = isSpanish ?
            `‚úÖ ¬°${validatedIdeas.length} ideas generadas exitosamente!` :
            `‚úÖ ${validatedIdeas.length} ideas generated successfully!`;
          document.body.appendChild(notification);

          setTimeout(() => {
            if (document.body.contains(notification)) {
              document.body.removeChild(notification);
            }
          }, 3000);

        } catch (err) {
          if (err.name === 'AbortError') {
            const isSpanish = formData.language === 'espa√±ol';
            const cancelMsg = isSpanish ?
              'Generaci√≥n de ideas cancelada por el usuario' :
              'Idea generation cancelled by user';
            setIdeaGenerationError(cancelMsg);
            return;
          }

          console.error('Idea generation error:', err);
          const isSpanish = formData.language === 'espa√±ol';
          let errorMessage = isSpanish ?
            `Error al generar ideas:\n\n${err.message}` :
            `Error generating ideas:\n\n${err.message}`;
          setIdeaGenerationError(errorMessage);
        } finally {
          setIsGeneratingIdeas(false);
          abortControllerRef.current = null;
        }
      };

      // Funci√≥n para seleccionar una idea y navegar al Step 2
      const selectIdeaAndNavigate = (idea) => {
        // Cargar datos de la idea al formulario
        setFormData(prev => ({
          ...prev,
          topic: idea.title,
          category: idea.category,
          selectedTemplate: idea.template,
          keyData: idea.keyPoints.join('. ') + '.',
          // Mantener el resto de configuraci√≥n existente
        }));

        // Cerrar el generador de ideas y ir al generator
        setCurrentView('generator');
        setCurrentStep(2);
        setResults(null);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(false);
        setCurrentHistoryId(null);
        setShowManualEditor(false);

        // Mostrar notificaci√≥n
        const isSpanish = formData.language === 'espa√±ol';
        const message = isSpanish ?
          `üí° Idea cargada: "${idea.title}"` :
          `üí° Idea loaded: "${idea.title}"`;

        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in';
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
          if (document.body.contains(notification)) {
            document.body.removeChild(notification);
          }
        }, 3000);
      };

      // Funci√≥n para manejar la apertura del generador
      const handleShowIdeaGenerator = () => {
        setCurrentView('idea-generator');
        setIdeaGenerationError('');
        setGeneratedIdeas([]);
        setIdeaGeneratorTopic('');
      };

      // Funci√≥n para cambiar el tema en el generador
      const handleIdeaTopicChange = (value) => {
        setIdeaGeneratorTopic(value);
        setIdeaGenerationError('');
      };

      // Validar JSON antes de parsear
      const validateAndFixJSON = (jsonString) => {
        try {
          // Intento de parsing inicial
          return JSON.parse(jsonString);
        } catch (firstError) {
          console.log('First parsing failed, attempting repairs...', firstError.message);

          // Reparaciones adicionales
          let repaired = jsonString;

          // Reparar comillas no escapadas comunes
          repaired = repaired.replace(/([^\\])"([^"]*)"([^,\]\}])/g, '$1\\"$2\\"$3');

          // Reparar arrays mal formateados
          repaired = repaired.replace(/\[\s*"([^"]*)"([^,\]]*)\s*\]/g, '["$1"]');

          // Intentar parsing nuevamente
          try {
            return JSON.parse(repaired);
          } catch (secondError) {
            console.log('Second parsing failed:', secondError.message);
            throw new Error(`JSON parsing failed: ${firstError.message}`);
          }
        }
      };

      const processManualContent = () => {
        setIsProcessingManual(true);
        setError('');

        try {
          // Usar la misma funci√≥n de limpieza mejorada
          const cleanAndRepairJSON = (content) => {
            let cleaned = content;

            cleaned = cleaned
              .replace(/```json/gi, '')
              .replace(/```/g, '')
              .replace(/<think>[\s\S]*?<\/think>/gi, '')
              .replace(/<thinking>[\s\S]*?<\/thinking>/gi, '')
              .trim();

            const jsonStart = cleaned.indexOf('{');
            const jsonEnd = cleaned.lastIndexOf('}');

            if (jsonStart !== -1 && jsonEnd !== -1 && jsonEnd > jsonStart) {
              cleaned = cleaned.substring(jsonStart, jsonEnd + 1);
            }

            cleaned = cleaned.replace(/"script":\s*"([\s\S]*?)"(?=\s*[,}])/g, (match, scriptContent) => {
              // MEJORADO: Manejo m√°s robusto de comillas y caracteres especiales
              const escapedScript = scriptContent
                .replace(/\\"/g, '___TEMP_ESCAPED_QUOTE___') // Preservar comillas ya escapadas temporalmente
                .replace(/"/g, '\\"') // Escapar comillas dobles sueltas
                .replace(/___TEMP_ESCAPED_QUOTE___/g, '\\"') // Restaurar comillas escapadas
                .replace(/\\\\/g, '\\') // Normalizar backslashes dobles
                .replace(/\r\n/g, '\\n') // Convertir CRLF a \n
                .replace(/\n/g, '\\n') // Escapar saltos de l√≠nea
                .replace(/\r/g, '\\n') // Convertir CR a \n
                .replace(/\t/g, '\\t') // Escapar tabs
                .replace(/'/g, "\\'"); // Escapar comillas simples tambi√©n

              return `"script": "${escapedScript}"`;
            });

            cleaned = cleaned.replace(/"(titles|thumbnails)":\s*\[([\s\S]*?)\]/g, (match, fieldName, arrayContent) => {
              const cleanArray = arrayContent
                .replace(/\n\s*/g, ' ')
                .replace(/,\s*,/g, ',')
                .replace(/,\s*]/g, ']');

              return `"${fieldName}": [${cleanArray}]`;
            });

            cleaned = cleaned
              .replace(/,(\s*[}\]])/g, '$1')
              .replace(/([}\]])(\s*)([{\[])/g, '$1,$2$3')
              .replace(/}\s*{/g, '},{')
              .replace(/]\s*\[/g, '],[');

            if (!cleaned.endsWith('}') && !cleaned.endsWith(']')) {
              cleaned += '}';
            }
            console.log('Cleaned manual content:', cleaned);
            return cleaned;
          };

          let cleanedContent = cleanAndRepairJSON(manualContent); // CORREGIDO: usar manualContent
          const parsedResults = validateAndFixJSON(cleanedContent);

          // Validar estructura
          const { titles, thumbnails, description, tags, pinnedComment, communityPost, script } = parsedResults;
          if (!titles || !thumbnails || !description || !tags || !pinnedComment || !communityPost || !script) {
            throw new Error('Invalid response structure: missing required fields');
          }
          setResults({ titles, thumbnails, description, tags, pinnedComment, communityPost, script });

          const newHistoryId = saveToHistory(formData, { titles, thumbnails, description, tags, pinnedComment, communityPost, script });
          setCurrentHistoryId(newHistoryId);
          setCurrentStep(3);
          setShowManualEditor(false);

          const isSpanish = formData.language === 'espa√±ol';
          const successMsg = isSpanish ?
            'Contenido procesado exitosamente desde el editor manual' :
            'Content successfully processed from manual editor';
          alert(successMsg);

        } catch (parseError) {
          const isSpanish = formData.language === 'espa√±ol';
          const errorMessage = isSpanish ?
            `Error al procesar JSON manual: ${parseError.message}` :
            `Error processing manual JSON: ${parseError.message}`;
          setError(errorMessage);
        } finally {
          setIsProcessingManual(false);
        }
      };

      const retryGeneration = async () => {
        setIsRetryingGeneration(true);
        setShowManualEditor(false);
        setError('');
        setManualContent('');

        // Peque√±a pausa para mejor UX
        setTimeout(() => {
          generateContent();
          setIsRetryingGeneration(false);
        }, 500);
      };

      const cancelGeneration = () => {
        if (abortControllerRef.current) {
          abortControllerRef.current.abort();
        }
      };

      const generateContent = generateContentWithStreaming;

      const copyToClipboard = (text) => {
        navigator.clipboard.writeText(text);
      };

      const startEditingResults = () => {
        setEditableResults({
          titles: [...results.titles],
          thumbnails: [...results.thumbnails],
          description: results.description,
          tags: [...results.tags],
          pinnedComment: results.pinnedComment,
          communityPost: results.communityPost,
          script: results.script
        });
        setIsEditingResults(true);
      };

      const saveEditedResults = () => {
        setResults(editableResults);
        setIsEditingResults(false);

        const isSpanish = formData.language === 'espa√±ol';
        const message = isSpanish ?
          '‚úÖ Cambios guardados exitosamente' :
          '‚úÖ Changes saved successfully';
        alert(message);
      };

      const cancelEditing = () => {
        setIsEditingResults(false);
        setEditableResults(null);
      };

      const updateEditableTitle = (index, value) => {
        setEditableResults(prev => ({
          ...prev,
          titles: prev.titles.map((title, i) => i === index ? value : title)
        }));
      };

      const updateEditableThumbnail = (index, value) => {
        setEditableResults(prev => ({
          ...prev,
          thumbnails: prev.thumbnails.map((thumb, i) => i === index ? value : thumb)
        }));
      };

      const updateEditableScript = (value) => {
        setEditableResults(prev => ({
          ...prev,
          script: value
        }));
      };

      const updateEditableDescription = (value) => {
        setEditableResults(prev => ({
          ...prev,
          description: value
        }));
      };

      const updateEditableTags = (value) => {
        setEditableResults(prev => ({
          ...prev,
          tags: value.split(',').map(tag => tag.trim()).filter(tag => tag)
        }));
      };

      const updateEditablePinnedComment = (value) => {
        setEditableResults(prev => ({
          ...prev,
          pinnedComment: value
        }));
      };

      const updateEditableCommunityPost = (value) => {
        setEditableResults(prev => ({
          ...prev,
          communityPost: value
        }));
      };

      const downloadResults = () => {
        if (!results) return;

        const isSpanish = formData.language === 'espa√±ol';
        const header = isSpanish ?
          `GENERADOR DE CONTENIDO YOUTUBE - ${formData.channelName}` :
          `YOUTUBE CONTENT GENERATOR - ${formData.channelName}`;

        const labels = isSpanish ? {
          category: 'CATEGOR√çA', topic: 'TEMA', style: 'ESTILO', language: 'IDIOMA',
          model: 'MODELO', titles: 'T√çTULOS', thumbnails: 'MINIATURAS',
          description: 'DESCRIPCI√ìN SEO', tags: 'TAGS', pinnedComment: 'COMENTARIO FIJADO',
          communityPost: 'POST COMUNIDAD', script: 'GUI√ìN', linkedVideo: 'VIDEO A ENLAZAR'
        } : {
          category: 'CATEGORY', topic: 'TOPIC', style: 'STYLE', language: 'LANGUAGE',
          model: 'MODEL', titles: 'TITLES', thumbnails: 'THUMBNAILS',
          description: 'SEO DESCRIPTION', tags: 'TAGS', pinnedComment: 'PINNED COMMENT',
          communityPost: 'COMMUNITY POST', script: 'SCRIPT', linkedVideo: 'LINKED VIDEO'
        };

        const content = `${header}
=====================================

${labels.category}: ${formData.category}
${labels.topic}: ${formData.topic}
${labels.style}: ${formData.scriptStyle}
${labels.language}: ${formData.language}
${labels.model}: ${formData.model}

${labels.titles}:
${results.titles.map((title, i) => `${i + 1}. ${title}`).join('\n')}

${labels.thumbnails}:
${results.thumbnails.map((thumb, i) => `${i + 1}. ${thumb}`).join('\n')}

${labels.description}:
${results.description}

${labels.tags}:
${results.tags.join(', ')}

${labels.pinnedComment}:
${results.pinnedComment}

${labels.communityPost}:
${results.communityPost}

${labels.script}:
${results.script}

${labels.linkedVideo}: ${formData.linkedVideo}
`;

        const blob = new Blob([content], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `contenido-youtube-${formData.channelName}-${formData.language}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      };

      const exportToPDF = () => {
        if (!results) return;

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        const isSpanish = formData.language === 'espa√±ol';

        // Configuraci√≥n de colores y fuentes
        const colors = {
          primary: [88, 28, 135], // Purple
          secondary: [51, 65, 85], // Slate
          text: [30, 41, 59], // Dark slate
          accent: [168, 85, 247] // Light purple
        };

        let yPosition = 20;
        const pageWidth = doc.internal.pageSize.width;
        const margin = 20;
        const contentWidth = pageWidth - (margin * 2);

        const addWrappedText = (text, x, y, maxWidth, fontSize = 12, isBold = false) => {
          doc.setFontSize(fontSize);
          if (isBold) {
            doc.setFont(undefined, 'bold');
          } else {
            doc.setFont(undefined, 'normal');
          }

          const lines = doc.splitTextToSize(text, maxWidth);

          // CORREGIDO: Sin justificaci√≥n autom√°tica para evitar overflow
          doc.text(lines, x, y);

          const lineHeight = fontSize * 0.6;
          return y + (lines.length * lineHeight);
        };

        // Header con gradiente simulado
        doc.setFillColor(...colors.primary);
        doc.rect(0, 0, pageWidth, 40, 'F');

        doc.setTextColor(255, 255, 255);
        doc.setFontSize(24);
        doc.setFont(undefined, 'bold');
        const title = isSpanish ? 'CONTENIDO YOUTUBE GENERADO' : 'GENERATED YOUTUBE CONTENT';
        doc.text(title, pageWidth / 2, 25, { align: 'center' });

        // Informaci√≥n del canal
        yPosition = 50;
        doc.setTextColor(...colors.text);
        doc.setFontSize(16);
        doc.setFont(undefined, 'bold');
        yPosition = addWrappedText(formData.channelName, margin, yPosition, contentWidth, 16, true);

        yPosition += 10;
        doc.setFontSize(12);
        doc.setTextColor(...colors.secondary);
        const date = new Date().toLocaleDateString(isSpanish ? 'es-ES' : 'en-US');
        const generatedText = isSpanish ? `Generado el ${date}` : `Generated on ${date}`;
        doc.text(generatedText, margin, yPosition);
        yPosition += 15;

        // L√≠nea separadora
        doc.setDrawColor(...colors.accent);
        doc.setLineWidth(1);
        doc.line(margin, yPosition, pageWidth - margin, yPosition);
        yPosition += 15;

        // Informaci√≥n del proyecto
        const projectInfo = [
          [isSpanish ? 'Categor√≠a:' : 'Category:', formData.category],
          [isSpanish ? 'Tema:' : 'Topic:', formData.topic],
          [isSpanish ? 'Estilo:' : 'Style:', formData.scriptStyle],
          [isSpanish ? 'Idioma:' : 'Language:', formData.language],
          [isSpanish ? 'Modelo IA:' : 'AI Model:', formData.model]
        ];

        if (formData.selectedTemplate && getSelectedTemplateData()) {
          projectInfo.push([
            isSpanish ? 'Template:' : 'Template:',
            getSelectedTemplateData().name
          ]);
        }

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const infoTitle = isSpanish ? 'INFORMACI√ìN DEL PROYECTO' : 'PROJECT INFORMATION';
        yPosition = addWrappedText(infoTitle, margin, yPosition, contentWidth, 12, true);
        yPosition += 5;

        doc.setFontSize(12);
        doc.setTextColor(...colors.text);
        projectInfo.forEach(([label, value]) => {
          doc.setFont(undefined, 'bold');
          doc.text(label, margin, yPosition);
          doc.setFont(undefined, 'normal');
          const labelWidth = doc.getTextWidth(label);
          yPosition = addWrappedText(value, margin + labelWidth + 5, yPosition, contentWidth - labelWidth - 5, 10);
          yPosition += 3;
        });

        yPosition += 10;

        // Funci√≥n para verificar si necesitamos nueva p√°gina
        const checkNewPage = (spaceNeeded) => {
          if (yPosition + spaceNeeded > doc.internal.pageSize.height - margin) {
            doc.addPage();
            yPosition = margin;
          }
        };

        // T√≠tulos sugeridos
        checkNewPage(40);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const titlesHeader = isSpanish ? 'T√çTULOS SUGERIDOS' : 'SUGGESTED TITLES';
        yPosition = addWrappedText(titlesHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 10;

        doc.setFontSize(12);
        doc.setTextColor(...colors.text);
        results.titles.forEach((title, index) => {
          checkNewPage(15);
          doc.setFont(undefined, 'bold');
          doc.text(`${index + 1}.`, margin + 5, yPosition);
          doc.setFont(undefined, 'normal');
          yPosition = addWrappedText(title, margin + 15, yPosition, contentWidth - 15, 10);
          yPosition += 5;
        });

        yPosition += 10;

        // Frases para miniaturas
        checkNewPage(40);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const thumbnailsHeader = isSpanish ? 'FRASES PARA MINIATURAS' : 'THUMBNAIL PHRASES';
        yPosition = addWrappedText(thumbnailsHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 10;

        doc.setFontSize(12);
        doc.setTextColor(...colors.text);
        results.thumbnails.forEach((thumb, index) => {
          checkNewPage(15);
          doc.setFont(undefined, 'bold');
          doc.text(`${index + 1}.`, margin + 5, yPosition);
          doc.setFont(undefined, 'normal');
          yPosition = addWrappedText(`"${thumb}"`, margin + 15, yPosition, contentWidth - 15, 10);
          yPosition += 5;
        });

        yPosition += 15;

        yPosition += 10;

        // Descripci√≥n SEO
        checkNewPage(40);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const descriptionHeader = isSpanish ? 'DESCRIPCI√ìN SEO' : 'SEO DESCRIPTION';
        yPosition = addWrappedText(descriptionHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 10;

        doc.setFontSize(11);
        doc.setTextColor(...colors.text);
        doc.setFont(undefined, 'normal');
        yPosition = addWrappedText(results.description, margin + 5, yPosition, contentWidth - 10, 11);
        yPosition += 5;

        // Mostrar contador de caracteres
        doc.setFontSize(8);
        doc.setTextColor(...colors.secondary);
        const charCount = isSpanish ? `${results.description.length}/500 caracteres` : `${results.description.length}/500 characters`;
        doc.text(charCount, pageWidth - margin, yPosition, { align: 'right' });
        yPosition += 15;

        // Tags relevantes
        checkNewPage(60);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const tagsHeader = isSpanish ? 'TAGS RELEVANTES' : 'RELEVANT TAGS';
        yPosition = addWrappedText(tagsHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 10;

        // Mostrar tags en formato de grid
        doc.setFontSize(10);
        doc.setTextColor(...colors.text);
        doc.setFont(undefined, 'normal');
        let currentX = margin + 5;
        let currentY = yPosition;
        const tagSpacing = 5;
        const maxTagWidth = (contentWidth - 10) / 4; // 4 columnas

        results.tags.forEach((tag, index) => {
          const tagText = `#${tag}`;
          const tagWidth = doc.getTextWidth(tagText) + 10;

          // Si no cabe en la l√≠nea actual, pasar a la siguiente
          if (currentX + tagWidth > pageWidth - margin) {
            currentX = margin + 5;
            currentY += 15;
            checkNewPage(15);
          }

          // Dibujar fondo del tag
          doc.setFillColor(59, 130, 246); // Azul
          doc.roundedRect(currentX, currentY - 8, tagWidth, 12, 2, 2, 'F');

          // Dibujar texto del tag
          doc.setTextColor(255, 255, 255);
          doc.text(tagText, currentX + 5, currentY);

          currentX += tagWidth + tagSpacing;
        });

        yPosition = currentY + 20;

        // Comentario fijado
        checkNewPage(40);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const pinnedHeader = isSpanish ? 'COMENTARIO FIJADO SUGERIDO' : 'SUGGESTED PINNED COMMENT';
        yPosition = addWrappedText(pinnedHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 10;

        doc.setFontSize(11);
        doc.setTextColor(...colors.text);
        doc.setFont(undefined, 'normal');
        yPosition = addWrappedText(results.pinnedComment, margin + 5, yPosition, contentWidth - 10, 11);
        yPosition += 15;

        // Post para comunidad
        checkNewPage(40);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const communityHeader = isSpanish ? 'POST PARA COMUNIDAD' : 'COMMUNITY POST';
        yPosition = addWrappedText(communityHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 10;

        doc.setFontSize(11);
        doc.setTextColor(...colors.text);
        doc.setFont(undefined, 'normal');
        yPosition = addWrappedText(results.communityPost, margin + 5, yPosition, contentWidth - 10, 11);
        yPosition += 15;

        // Gui√≥n completo
        checkNewPage(40);
        doc.setFillColor(248, 250, 252);
        doc.rect(margin, yPosition - 5, contentWidth, 15, 'F');

        doc.setFontSize(12);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(...colors.primary);
        const scriptHeader = isSpanish ? 'GUI√ìN COMPLETO' : 'COMPLETE SCRIPT';
        yPosition = addWrappedText(scriptHeader, margin + 5, yPosition + 5, contentWidth - 10, 12, true);
        yPosition += 5;

        // Estad√≠sticas del gui√≥n
        const wordCount = results.script.split(' ').length;
        const statsText = isSpanish ?
          `Palabras: ${wordCount} | Tiempo estimado: ${Math.ceil(wordCount / 150)} minutos` :
          `Words: ${wordCount} | Estimated time: ${Math.ceil(wordCount / 150)} minutes`;

        doc.setFontSize(8);
        doc.setTextColor(...colors.secondary);
        doc.text(statsText, margin + 5, yPosition + 8);
        yPosition += 15;

        // Contenido del gui√≥n
        doc.setFontSize(11);
        doc.setTextColor(...colors.text);
        doc.setFont(undefined, 'normal');

        // Dividir el script en p√°rrafos para mejor formato
        const paragraphs = results.script.split('\n\n');
        paragraphs.forEach((paragraph) => {
          if (paragraph.trim()) {
            checkNewPage(30);

            // CORREGIDO: Manejo manual sin justificaci√≥n autom√°tica
            const lines = doc.splitTextToSize(paragraph.trim(), contentWidth - 10);
            doc.text(lines, margin + 5, yPosition);

            // Calcular nueva posici√≥n Y
            const lineHeight = 9 * 0.6;
            yPosition += (lines.length * lineHeight) + 8;
          }
        });

        // Footer en cada p√°gina
        const totalPages = doc.internal.getNumberOfPages();
        for (let i = 1; i <= totalPages; i++) {
          doc.setPage(i);
          doc.setFontSize(8);
          doc.setTextColor(...colors.secondary);

          // L√≠nea superior del footer
          doc.setDrawColor(...colors.accent);
          doc.setLineWidth(0.5);
          doc.line(margin, doc.internal.pageSize.height - 25, pageWidth - margin, doc.internal.pageSize.height - 25);

          // Texto del footer
          const footerLeft = isSpanish ? `Generado con Ollama | ${formData.model}` : `Generated with Ollama | ${formData.model}`;
          const footerRight = isSpanish ? `P√°gina ${i} de ${totalPages}` : `Page ${i} of ${totalPages}`;

          doc.text(footerLeft, margin, doc.internal.pageSize.height - 15);
          doc.text(footerRight, pageWidth - margin, doc.internal.pageSize.height - 15, { align: 'right' });

          // Link al canal
          if (formData.linkedVideo) {
            const linkText = isSpanish ? `Pr√≥ximo video: ${formData.linkedVideo}` : `Next video: ${formData.linkedVideo}`;
            doc.text(linkText, pageWidth / 2, doc.internal.pageSize.height - 10, { align: 'center' });
          }
        }

        // Guardar el PDF
        const fileName = `youtube-content-${formData.channelName.toLowerCase().replace(/\s+/g, '-')}-${formData.language}.pdf`;
        doc.save(fileName);
      };

      const resetGenerator = () => {
        setCurrentStep(1);
        setFormData({
          category: '',
          topic: '',
          scriptStyle: '',
          channelName: '',
          linkedVideo: '',
          keyData: '',
          selectedTemplate: '',
          customTemplate: '',
          model: 'gemma3n:e4b',
          baseUrl: 'http://localhost:11434/api/generate',
          language: 'espa√±ol',
          disableThinking: false,
        });
        setResults(null);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(false);
        setCurrentHistoryId(null);
      };

      const regenerateContent = () => {
        // Mantener los mismos datos del formulario pero volver al paso de generaci√≥n
        setCurrentStep(2);
        setResults(null);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(false);
        setShowManualEditor(false);
      };

      const isSpanish = formData.language === 'espa√±ol';

      // Funci√≥n para calcular datos del dashboard
      const calculateDashboardData = () => {
        try {
          const history = JSON.parse(localStorage.getItem('youtubeGenerator_scriptHistory') || '[]');
          const favorites = JSON.parse(localStorage.getItem('youtubeGenerator_favoriteScripts') || '[]');

          const totalGenerations = history.length;
          const favoriteCount = favorites.length;

          // Calcular categor√≠as usadas
          const categoriesUsed = history.reduce((acc, gen) => {
            const category = gen.formData?.category;
            if (category) {
              acc[category] = (acc[category] || 0) + 1;
            }
            return acc;
          }, {});

          // Calcular modelos usados
          const modelsUsed = history.reduce((acc, gen) => {
            const model = gen.formData?.model;
            if (model) {
              acc[model] = (acc[model] || 0) + 1;
            }
            return acc;
          }, {});

          // Calcular templates usados
          const templatesUsed = history.reduce((acc, gen) => {
            const template = gen.formData?.selectedTemplate;
            if (template) {
              acc[template] = (acc[template] || 0) + 1;
            }
            return acc;
          }, {});

          // Calcular total de palabras
          const totalWords = history.reduce((sum, gen) => {
            const wordCount = gen.results?.script?.split(' ').length || 0;
            return sum + wordCount;
          }, 0);

          // Calcular actividad de la √∫ltima semana
          const lastWeekActivity = Array.from({ length: 7 }, (_, i) => {
            const checkDate = new Date();
            checkDate.setDate(checkDate.getDate() - i);

            const dayGenerations = history.filter(gen => {
              const genDate = new Date(gen.timestamp);
              return genDate.toDateString() === checkDate.toDateString();
            }).length;

            return {
              date: checkDate.toISOString().split('T')[0],
              value: dayGenerations
            };
          }).reverse();

          // Calcular generaciones de esta semana
          const thisWeekGenerations = history.filter(gen => {
            const genDate = new Date(gen.timestamp);
            const today = new Date();
            const weekAgo = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);
            const genDateOnly = new Date(genDate.getFullYear(), genDate.getMonth(), genDate.getDate());
            return genDateOnly >= weekAgo;
          }).length;

          // Calcular generaciones de la semana pasada para tendencia
          const lastWeekGenerations = history.filter(gen => {
            const genDate = new Date(gen.timestamp);
            const today = new Date();
            const twoWeeksAgo = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 14);
            const weekAgo = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7);
            const genDateOnly = new Date(genDate.getFullYear(), genDate.getMonth(), genDate.getDate());
            return genDateOnly >= twoWeeksAgo && genDateOnly < weekAgo;
          }).length;

          // Encontrar categor√≠a m√°s usada
          const mostUsedCategory = Object.entries(categoriesUsed)
            .sort(([, a], [, b]) => b - a)[0]?.[0] || '';

          // Encontrar modelo m√°s usado
          const mostUsedModel = Object.entries(modelsUsed)
            .sort(([, a], [, b]) => b - a)[0]?.[0] || '';

          // Calcular racha de d√≠as (d√≠as consecutivos con al menos una generaci√≥n)
          let streakDays = 0;
          const today = new Date();
          for (let i = 0; i < 30; i++) {
            const checkDate = new Date(today);
            checkDate.setDate(checkDate.getDate() - i);

            const hasGeneration = history.some(gen => {
              const genDate = new Date(gen.timestamp);
              return genDate.toDateString() === checkDate.toDateString();
            });

            if (hasGeneration) {
              streakDays++;
            } else if (i > 0) { // No romper la racha el primer d√≠a si hoy no hay generaciones
              break;
            }
          }

          return {
            totalGenerations,
            favoriteCount,
            categoriesUsed,
            modelsUsed,
            templatesUsed,
            generationsByDate: lastWeekActivity,
            lastWeekActivity,
            totalWords,
            mostUsedCategory,
            mostUsedModel,
            streakDays,
            thisWeekGenerations,
            lastWeekGenerations,
            averageGenerationTime: 0 // Se puede implementar m√°s tarde
          };
        } catch (error) {
          console.error('Error calculating dashboard data:', error);
          return {
            totalGenerations: 0,
            favoriteCount: 0,
            categoriesUsed: {},
            modelsUsed: {},
            templatesUsed: {},
            generationsByDate: [],
            lastWeekActivity: [],
            totalWords: 0,
            mostUsedCategory: '',
            mostUsedModel: '',
            streakDays: 0,
            thisWeekGenerations: 0,
            lastWeekGenerations: 0,
            averageGenerationTime: 0
          };
        }
      };

      // Funci√≥n para actualizar datos del dashboard despu√©s de nueva generaci√≥n
      const updateDashboardData = (newGenerationData) => {
        const newData = calculateDashboardData();
        setDashboardData(newData);
      };

      // Funciones de navegaci√≥n desde dashboard
      const navigateToGenerator = () => {
        setCurrentView('generator');
        setCurrentStep(1);
        setResults(null);
        setError('');
        setRealTimeResponse('');
        setShowRealTimePanel(false);
        setCurrentHistoryId(null);
        setShowManualEditor(false);
      };

      const handleDashboard = () => {
        setCurrentView('dashboard');
        setCurrentStep(1);
        setResults(null);
        setError('');
        setShowRealTimePanel(false);
        setCurrentHistoryId(null);
        setShowManualEditor(false);

        // Recalcular datos del dashboard
        const newData = calculateDashboardData();
        setDashboardData(newData);
      };



      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
          {/* Tab Bar Toggle Button */}
          <button
            onClick={() => setShowTabBar(true)}
            disabled={isGenerating || isGeneratingIdeas}
            className={`fixed top-4 left-4 z-30 bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-xl shadow-lg transition-colors group ${isGenerating || isGeneratingIdeas ? 'opacity-50 cursor-not-allowed' : ''}`}
            title={isSpanish ? "Abrir men√∫" : "Open menu"}
          >
            <svg
              className="w-6 h-6 transition-transform group-hover:scale-110"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeWidth="2"
            >
              <line x1="3" y1="6" x2="21" y2="6" />
              <line x1="3" y1="12" x2="21" y2="12" />
              <line x1="3" y1="18" x2="21" y2="18" />
            </svg>
          </button>

          {/* Tab Bar */}
          <TabBar
            isOpen={showTabBar}
            onClose={() => setShowTabBar(false)}
            onDashboard={handleDashboard}
            onNewProject={handleNewProject}
            onHistory={handleShowHistory}
            onFavorites={handleShowFavorites}
            onInstallGuide={handleShowInstallGuide}
            onIdeaGenerator={handleShowIdeaGenerator}
            language={formData.language}
          />

          {/* Matrix Effect */}
          {showMatrixEffect && <MatrixEffect />}

          {/* Pong Game */}
          {showPongGame && (
            <PongGame onClose={() => setShowPongGame(false)} />
          )}

          {/* Tip Alert */}
          {showTip && currentTip && (
            <TipAlert
              tip={currentTip}
              onClose={() => setShowTip(false)}
              language={formData.language}
            />
          )}

          {/* Installation Guide */}
          {showInstallationGuide && (
            <InstallationGuide
              onClose={() => setShowInstallationGuide(false)}
              language={formData.language}
            />
          )}

          {/* History Panel */}
          {showHistoryPanel && (
            <HistoryPanel
              onClose={() => setShowHistoryPanel(false)}
              history={scriptHistory}
              onRegenerate={regenerateFromHistory}
              onLoad={loadFromHistory}
              onToggleFavorite={toggleFavorite}
              onDelete={confirmDelete}
              language={formData.language}
            />
          )}

          {/* Favorites Panel */}
          {showFavoritesPanel && (
            <FavoritesPanel
              onClose={() => setShowFavoritesPanel(false)}
              favorites={favoriteScripts}
              onRegenerate={regenerateFromHistory}
              onLoad={loadFromHistory}
              onToggleFavorite={toggleFavorite}
              language={formData.language}
            />
          )}

          <div className="flex">
            {/* Panel principal */}
            <div className={`transition-all duration-300 ${showRealTimePanel ? 'w-2/3' : 'w-full'}`}>
              <div className="container mx-auto px-4 py-8">

                {/* Header din√°mico */}
                <div className="text-center mb-12">
                  <div className="flex items-center justify-center mb-4">
                    <Play className="w-8 h-8 text-red-500 mr-3" />
                    <h1 className="text-4xl font-bold text-white">
                      {currentView === 'dashboard' ? (
                        isSpanish ? "Dashboard de YouTube" : "YouTube Dashboard"
                      ) : (
                        isSpanish ? "Generador YouTube con Ollama" : "YouTube Generator with Ollama"
                      )}
                    </h1>
                  </div>
                  <p className="text-slate-300 text-lg">
                    {currentView === 'dashboard' ? (
                      isSpanish ?
                        "Estad√≠sticas de tu productividad y acceso r√°pido a todas las herramientas" :
                        "Your productivity statistics and quick access to all tools"
                    ) : (
                      isSpanish ?
                        "Genera contenido profesional para YouTube usando modelos locales con Ollama" :
                        "Generate professional YouTube content using local models with Ollama"
                    )}
                  </p>
                </div>

                {/* Main Content */}
                <div className="max-w-4xl mx-auto">
                  {/* Renderizado condicional basado en currentView */}
                  {currentView === 'dashboard' ? (
                    <DashboardMain
                      onNavigateToGenerator={navigateToGenerator}
                      onShowHistory={() => setShowHistoryPanel(true)}
                      onShowFavorites={() => setShowFavoritesPanel(true)}
                      onShowIdeaGenerator={handleShowIdeaGenerator}
                      onShowInstallGuide={() => setShowInstallationGuide(true)}
                      dashboardData={dashboardData}
                      scriptHistory={scriptHistory}
                      favoriteScripts={favoriteScripts}
                      onLoadFromHistory={loadFromHistory}
                      language={formData.language}
                    />
                  ) : currentView === 'idea-generator' ? (
                    <IdeaGenerator
                      onClose={() => setCurrentView('dashboard')}
                      onSelectIdea={selectIdeaAndNavigate}
                      language={formData.language}
                      formData={formData}
                      isGenerating={isGeneratingIdeas}
                      onGenerate={generateIdeas}
                      generatedIdeas={generatedIdeas}
                      ideaTopic={ideaGeneratorTopic}
                      onTopicChange={handleIdeaTopicChange}
                      isTestingConnection={isTestingConnection}
                      onTestConnection={testOllamaConnection}
                      abortControllerRef={abortControllerRef}
                    />) : (
                    <div>
                      {/* Progress Bar - solo mostrar si no estamos en dashboard */}
                      <div className="max-w-2xl mx-auto mb-8">
                        <div className="flex items-center justify-between mb-4">
                          {[1, 2, 3].map((step) => (
                            <div key={step} className="flex items-center">
                              <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold ${currentStep >= step ? 'bg-purple-600 text-white' : 'bg-slate-700 text-slate-400'
                                }`}>
                                {step}
                              </div>
                              {step < 3 && (
                                <div className={`w-16 h-1 mx-2 ${currentStep > step ? 'bg-purple-600' : 'bg-slate-700'
                                  }`} />
                              )}
                            </div>
                          ))}
                        </div>
                        <div className="flex justify-between text-sm text-slate-400">
                          <span>{isSpanish ? "Configuraci√≥n" : "Configuration"}</span>
                          <span>{isSpanish ? "Detalles" : "Details"}</span>
                          <span>{isSpanish ? "Resultados" : "Results"}</span>
                        </div>
                      </div>

                      {/* Main Content */}
                      <div className="max-w-4xl mx-auto">
                        {/* Step 1 */}
                        {currentStep === 1 && (
                          <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                            <h2 className="text-2xl font-bold text-white mb-6 flex items-center">
                              <Zap className="w-6 h-6 text-yellow-500 mr-2" />
                              <span className="mx-2"></span>
                              {isSpanish ? "Configuraci√≥n de Ollama y Contenido" : "Ollama and Content Configuration"}
                            </h2>

                            <div className="space-y-6">
                              {/* Ollama Configuration */}
                              <div className="bg-blue-900/30 border border-blue-700 rounded-lg p-4">
                                <div className="flex items-center justify-between mb-3">
                                  <h4 className="text-blue-300 font-medium">
                                    {isSpanish ? "Configuraci√≥n de Ollama" : "Ollama Configuration"}
                                  </h4>
                                  <div className="flex space-x-2">
                                    {isTestingConnection ? (
                                      <>
                                        <button
                                          onClick={testOllamaConnection}
                                          disabled={true}
                                          className="bg-blue-600 text-white px-3 py-1 rounded text-sm flex items-center opacity-50"
                                        >
                                          <Loader2 className="w-3 h-3 mr-1 animate-spin" />
                                          {isSpanish ? "Probando..." : "Testing..."}
                                        </button>
                                        <button
                                          onClick={cancelTestConnection}
                                          className="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                        >
                                          {isSpanish ? "Cancelar" : "Cancel"}
                                        </button>
                                      </>
                                    ) : (
                                      <button
                                        onClick={testOllamaConnection}
                                        className="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors flex items-center"
                                      >
                                        {isSpanish ? "Probar Conexi√≥n" : "Test Connection"}
                                      </button>
                                    )}
                                  </div>
                                </div>

                                <div className="space-y-4">
                                  <div>
                                    <label className="block text-blue-200 font-medium mb-2">
                                      {isSpanish ? "URL de Ollama" : "Ollama URL"}
                                    </label>
                                    <input
                                      type="text"
                                      value={formData.baseUrl}
                                      onChange={(e) => handleInputChange('baseUrl', e.target.value)}
                                      placeholder="http://localhost:11434/api/generate"
                                      className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    />
                                  </div>

                                  <div>
                                    <label className="block text-blue-200 font-medium mb-2">
                                      {isSpanish ? "Modelo" : "Model"}
                                    </label>
                                    <select
                                      value={formData.model}
                                      onChange={(e) => handleInputChange('model', e.target.value)}
                                      className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    >
                                      {availableModels.map((model) => (
                                        <option key={model} value={model}>{model}</option>
                                      ))}
                                    </select>
                                  </div>

                                  <div>
                                    <label className="block text-blue-200 font-medium mb-2">
                                      {isSpanish ? "Ventana de contexto" : "Context window"}
                                    </label>
                                    <div className="flex items-center space-x-2">
                                      <input
                                        type="range"
                                        min="8000"
                                        max="32000"
                                        step="1000"
                                        value={formData.contextWindow}
                                        onChange={(e) => handleInputChange('contextWindow', Number(e.target.value))}
                                        className="w-32 sm:w-40 bg-slate-900 border border-slate-600 rounded-lg"
                                      />
                                      <span className="text-blue-300 font-mono w-14 text-right">
                                        {formData.contextWindow}
                                      </span>
                                    </div>
                                  </div>

                                  {/* Opci√≥n para desactivar pensamiento */}
                                  {(formData.model.includes('deepseek') || formData.model.includes('r1')) && (
                                    <div className="bg-yellow-900/30 border border-yellow-700 rounded-lg p-3">
                                      <div className="flex items-start space-x-3">
                                        <input
                                          type="checkbox"
                                          id="disableThinking"
                                          checked={formData.disableThinking}
                                          onChange={(e) => handleInputChange('disableThinking', e.target.checked)}
                                          className="mt-1 w-4 h-4 text-purple-600 bg-slate-800 border-slate-600 rounded focus:ring-purple-500"
                                        />
                                        <div>
                                          <label htmlFor="disableThinking" className="text-yellow-200 font-medium text-sm cursor-pointer">
                                            {isSpanish ? "üß† Desactivar Pensamiento del Modelo" : "üß† Disable Model Thinking"}
                                          </label>
                                          <p className="text-yellow-300 text-xs mt-1">
                                            {isSpanish ?
                                              "Evita que el modelo muestre su razonamiento interno. Recomendado para respuestas m√°s directas." :
                                              "Prevents the model from showing its internal reasoning. Recommended for more direct responses."
                                            }
                                          </p>
                                        </div>
                                      </div>
                                    </div>
                                  )}

                                  <div className="text-blue-200 text-sm space-y-1">
                                    <p>
                                      {isSpanish ? "1. Inicia Ollama: " : "1. Start Ollama: "}
                                      <code className="bg-slate-800 px-1 rounded">ollama serve</code>
                                    </p>
                                    <p>
                                      {isSpanish ? "2. Modelo requerido: " : "2. Required model: "}
                                      <code className="bg-slate-800 px-1 rounded">ollama pull {formData.model}</code>
                                    </p>
                                  </div>
                                </div>
                              </div>

                              <div className="border-t border-slate-600 pt-6">
                                <h3 className="text-lg font-semibold text-white mb-4">
                                  {isSpanish ? "Configuraci√≥n del Contenido" : "Content Configuration"}
                                </h3>

                                <div className="space-y-4">
                                  <div>
                                    <label className="block text-slate-300 font-medium mb-3">
                                      {isSpanish ? "Idioma del Contenido" : "Content Language"}
                                    </label>
                                    <select
                                      value={formData.language}
                                      onChange={(e) => handleInputChange('language', e.target.value)}
                                      className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    >
                                      <option value="espa√±ol">üá™üá∏ Espa√±ol</option>
                                      <option value="english">üá∫üá∏ English</option>
                                    </select>
                                  </div>

                                  <div>
                                    <label className="block text-slate-300 font-medium mb-3">
                                      {isSpanish ? "Categor√≠a del Video" : "Video Category"}
                                    </label>
                                    <select
                                      value={formData.category}
                                      onChange={(e) => handleInputChange('category', e.target.value)}
                                      className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    >
                                      <option value="">
                                        {isSpanish ? "Selecciona una categor√≠a" : "Select a category"}
                                      </option>
                                      {getCurrentCategories().map((cat) => (
                                        <option key={cat} value={cat}>{cat}</option>
                                      ))}
                                    </select>
                                  </div>

                                  <div>
                                    <label className="block text-slate-300 font-medium mb-3">
                                      {isSpanish ? "Template de Contenido (Opcional)" : "Content Template (Optional)"}
                                    </label>
                                    <select
                                      value={formData.selectedTemplate}
                                      onChange={(e) => handleTemplateChange(e.target.value)}
                                      className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    >
                                      <option value="">
                                        {isSpanish ? "Selecciona un template" : "Select a template"}
                                      </option>
                                      {Object.entries(getCurrentTemplates()).map(([key, template]) => (
                                        <option key={key} value={key}>{template.name}</option>
                                      ))}
                                    </select>

                                    {formData.selectedTemplate && getSelectedTemplateData() && (
                                      <div className="mt-3 p-4 bg-slate-900/50 rounded-lg border border-slate-600">
                                        <h4 className="text-slate-200 font-medium mb-2">
                                          {getSelectedTemplateData().name}
                                        </h4>
                                        <p className="text-slate-400 text-sm mb-3">
                                          {getSelectedTemplateData().description}
                                        </p>
                                        {(formData.selectedTemplate === 'personalizado' || formData.selectedTemplate === 'custom') ? (
                                          <div>
                                            <label className="block text-slate-300 font-medium mb-2">
                                              {isSpanish ? "Define tu estructura personalizada:" : "Define your custom structure:"}
                                            </label>
                                            <textarea
                                              value={formData.customTemplate}
                                              onChange={(e) => handleInputChange('customTemplate', e.target.value)}
                                              placeholder={isSpanish ?
                                                "Ej:\n1. Introducci√≥n del tema\n2. Desarrollo principal\n3. Ejemplos pr√°cticos\n4. Conclusiones..." :
                                                "Ex:\n1. Topic introduction\n2. Main development\n3. Practical examples\n4. Conclusions..."
                                              }
                                              rows="6"
                                              className="w-full bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-y font-mono text-sm"
                                            />
                                          </div>
                                        ) : (
                                          <div>
                                            <h5 className="text-slate-300 font-medium mb-2">
                                              {isSpanish ? "Estructura sugerida:" : "Suggested structure:"}
                                            </h5>
                                            <pre className="text-slate-300 text-sm whitespace-pre-wrap font-mono bg-slate-800 p-3 rounded border border-slate-600">
                                              {getSelectedTemplateData().structure}
                                            </pre>
                                          </div>
                                        )}
                                      </div>
                                    )}

                                    <p className="text-slate-400 text-sm mt-2">
                                      {isSpanish ?
                                        "Los templates proporcionan estructura espec√≠fica optimizada para cada tipo de contenido." :
                                        "Templates provide specific structure optimized for each type of content."
                                      }
                                    </p>
                                  </div>
                                </div>
                              </div>
                            </div>

                            {error && (
                              <div className="mt-4 p-4 bg-red-900/50 border border-red-700 rounded-lg">
                                <pre className="text-red-300 whitespace-pre-wrap text-sm">{error}</pre>
                              </div>
                            )}

                            <div className="flex justify-end mt-8">
                              <button
                                onClick={nextStep}
                                className="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                              >
                                {isSpanish ? "Continuar " : "Continue "}
                                <ChevronRight className="w-4 h-4 ml-2" />
                              </button>
                            </div>
                          </div>
                        )}

                        {/* Step 2 */}
                        {currentStep === 2 && (
                          <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                            <h2 className="text-2xl font-bold text-white mb-6 flex items-center">
                              <Edit3 className="w-6 h-6 text-green-500 mr-2" />
                              {isSpanish ? "Detalles del Contenido" : "Content Details"}
                            </h2>

                            <div className="space-y-6">
                              <div>
                                <label className="block text-slate-300 font-medium mb-3">
                                  {isSpanish ? "Tema del Video" : "Video Topic"}
                                </label>
                                <input
                                  type="text"
                                  value={formData.topic}
                                  onChange={(e) => {
                                    if (e.target.value.length <= 100) {
                                      handleInputChange('topic', e.target.value);
                                    }
                                  }}
                                  maxLength={100}
                                  placeholder={isSpanish ?
                                    "Ej: C√≥mo ganar dinero con criptomonedas en 2024" :
                                    "Ex: How to make money with cryptocurrencies in 2024"
                                  }
                                  className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                />
                                <div className="flex justify-between items-center mt-2">
                                  <p className="text-slate-400 text-sm">
                                    {isSpanish ?
                                      "Describe el tema espec√≠fico de tu video de forma concisa" :
                                      "Describe your video topic specifically and concisely"
                                    }
                                  </p>
                                  <span className={`text-sm font-mono ${formData.topic.length > 90 ? 'text-yellow-400' :
                                    formData.topic.length === 100 ? 'text-red-400' : 'text-slate-400'
                                    }`}>
                                    {formData.topic.length}/100
                                  </span>
                                </div>
                              </div>

                              <div>
                                <label className="block text-slate-300 font-medium mb-3">
                                  {isSpanish ? "Datos Clave (Opcional)" : "Key Data (Optional)"}
                                </label>
                                <textarea
                                  value={formData.keyData}
                                  onChange={(e) => {
                                    if (e.target.value.length <= 840) {
                                      handleInputChange('keyData', e.target.value);
                                    }
                                  }}
                                  maxLength={840}
                                  placeholder={isSpanish ?
                                    "Ej: Estad√≠sticas importantes, fechas clave, nombres espec√≠ficos, datos t√©cnicos, precios actuales, estudios relevantes, definiciones importantes..." :
                                    "Ex: Important statistics, key dates, specific names, technical data, current prices, relevant studies, important definitions..."
                                  }
                                  rows="4"
                                  className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-y"
                                />
                                <div className="flex justify-between items-center mt-2">
                                  <p className="text-slate-400 text-sm">
                                    {isSpanish ?
                                      "Agrega informaci√≥n espec√≠fica, datos t√©cnicos, fechas o hechos importantes que quieres incluir en el gui√≥n para evitar errores." :
                                      "Add specific information, technical data, dates or important facts you want included in the script to avoid errors."
                                    }
                                  </p>
                                  <span className={`text-sm font-mono ${formData.keyData.length > 840 ? 'text-yellow-400' :
                                    formData.keyData.length === 840 ? 'text-red-400' : 'text-slate-400'
                                    }`}>
                                    {formData.keyData.length}/840
                                  </span>
                                </div>
                              </div>

                              <div>
                                <label className="block text-slate-300 font-medium mb-3">
                                  {isSpanish ? "Estilo del Gui√≥n" : "Script Style"}

                                </label>
                                <select
                                  value={formData.scriptStyle}
                                  onChange={(e) => handleInputChange('scriptStyle', e.target.value)}
                                  className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                >
                                  <option value="">
                                    {isSpanish ? "Selecciona un estilo" : "Select a style"}
                                  </option>
                                  {getCurrentScriptStyles().map((style) => (
                                    <option key={style} value={style}>{style}</option>
                                  ))}
                                </select>
                              </div>

                              <div>
                                <label className="block text-slate-300 font-medium mb-3">
                                  {isSpanish ? "Nombre del Canal" : "Channel Name"}
                                </label>
                                <input
                                  type="text"
                                  value={formData.channelName}
                                  onChange={(e) => {
                                    if (e.target.value.length <= 100) {
                                      handleInputChange('channelName', e.target.value);
                                    }
                                  }}
                                  maxLength={100}
                                  placeholder={isSpanish ?
                                    "Ej: TechMaster Pro" :
                                    "Ex: TechMaster Pro"
                                  }
                                  className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                />
                                <div className="flex justify-between items-center mt-2">
                                  <p className="text-slate-400 text-sm">
                                    {isSpanish ?
                                      "El nombre de tu canal de YouTube" :
                                      "Your YouTube channel name"
                                    }
                                  </p>
                                  <span className={`text-sm font-mono ${formData.channelName.length > 90 ? 'text-yellow-400' :
                                    formData.channelName.length === 100 ? 'text-red-400' : 'text-slate-400'
                                    }`}>
                                    {formData.channelName.length}/100
                                  </span>
                                </div>
                              </div>

                              <div>
                                <label className="block text-slate-300 font-medium mb-3">
                                  {isSpanish ? "Video a Enlazar al Final (Opcional)" : "Video to Link at the End (Optional)"}
                                </label>
                                <input
                                  type="text"
                                  value={formData.linkedVideo}
                                  onChange={(e) => {
                                    if (e.target.value.length <= 100) {
                                      handleInputChange('linkedVideo', e.target.value);
                                    }
                                  }}
                                  maxLength={100}
                                  placeholder={isSpanish ?
                                    "Ej: Curso completo de trading avanzado" :
                                    "Ex: Complete advanced trading course"
                                  }
                                  className="w-full bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                />
                                <div className="flex justify-between items-center mt-2">
                                  <p className="text-slate-400 text-sm">
                                    {isSpanish ?
                                      "Video que se mencionar√° al final del gui√≥n para generar engagement" :
                                      "Video to mention at the end of the script to generate engagement"
                                    }
                                  </p>
                                  <span className={`text-sm font-mono ${formData.linkedVideo.length > 90 ? 'text-yellow-400' :
                                    formData.linkedVideo.length === 100 ? 'text-red-400' : 'text-slate-400'
                                    }`}>
                                    {formData.linkedVideo.length}/100
                                  </span>
                                </div>
                              </div>
                            </div>

                            {error && (
                              <div className="mt-4 p-4 bg-red-900/50 border border-red-700 rounded-lg">
                                <pre className="text-red-300 whitespace-pre-wrap text-sm">{error}</pre>
                              </div>
                            )}

                            <div className="flex justify-between mt-8">
                              <button
                                onClick={prevStep}
                                disabled={isGenerating}
                                className={`${isGenerating
                                  ? 'bg-gray-500 cursor-not-allowed opacity-50'
                                  : 'bg-slate-600 hover:bg-slate-700'
                                  } text-white px-6 py-3 rounded-lg font-medium transition-colors`}
                              >
                                {isSpanish ? "Anterior" : "Previous"}
                              </button>
                              <div className="flex space-x-3">
                                {isGenerating ? (
                                  <>
                                    <button
                                      onClick={generateContent}
                                      disabled={true}
                                      className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-medium flex items-center opacity-50"
                                    >
                                      <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                                      {isSpanish ? "Generando..." : "Generating..."}
                                    </button>
                                    <button
                                      onClick={cancelGeneration}
                                      className="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition-colors"
                                    >
                                      {isSpanish ? "Cancelar" : "Cancel"}
                                    </button>
                                  </>
                                ) : (
                                  <button
                                    onClick={() => {
                                      if (validateStep(2)) {
                                        generateContent();
                                      } else {
                                        // Validaciones espec√≠ficas con mensajes detallados
                                        if (formData.topic && formData.topic.length > 100) {
                                          setError(formData.language === 'espa√±ol' ? 'El tema del video no puede exceder 100 caracteres' : 'Video topic cannot exceed 100 characters');
                                        } else if (formData.channelName && formData.channelName.length > 100) {
                                          setError(formData.language === 'espa√±ol' ? 'El nombre del canal no puede exceder 100 caracteres' : 'Channel name cannot exceed 100 characters');
                                        } else if (formData.linkedVideo && formData.linkedVideo.length > 100) {
                                          setError(formData.language === 'espa√±ol' ? 'El video a enlazar no puede exceder 100 caracteres' : 'Linked video cannot exceed 100 characters');
                                        } else if (formData.keyData && formData.keyData.length > 840) {
                                          setError(formData.language === 'espa√±ol' ? 'Los datos clave no pueden exceder 500 caracteres' : 'Key data cannot exceed 500 characters');
                                        } else {
                                          setError(formData.language === 'espa√±ol' ? 'Por favor completa todos los campos requeridos' : 'Please complete all required fields');
                                        }
                                      }
                                    }}
                                    disabled={!validateStep(2)}
                                    className={`${validateStep(2)
                                      ? 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700'
                                      : 'bg-gray-500 cursor-not-allowed'
                                      } text-white px-8 py-3 rounded-lg font-medium flex items-center transition-colors`}
                                  >
                                    <Zap className="w-4 h-4 mr-2" />
                                    <span className="ml-1">{isSpanish ? " Generar Contenido" : "Generate Content"}</span>
                                  </button>
                                )}
                              </div>
                            </div>
                          </div>
                        )}

                        {/* Editor Manual */}
                        {showManualEditor && (
                          <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                            <h2 className="text-2xl font-bold text-white mb-6 flex items-center">
                              <Edit3 className="w-6 h-6 text-yellow-500 mr-2" />
                              {isSpanish ? "Editor Manual de Contenido" : "Manual Content Editor"}
                            </h2>

                            <div className="bg-amber-900/30 border border-amber-700 rounded-lg p-4 mb-6">
                              <p className="text-amber-200 text-sm">
                                {isSpanish ?
                                  "La IA gener√≥ contenido con formato incorrecto. Puedes editarlo manualmente aqu√≠ y luego procesarlo." :
                                  "The AI generated content with incorrect format. You can manually edit it here and then process it."
                                }
                              </p>
                            </div>

                            <div className="space-y-4">
                              <label className="block text-slate-300 font-medium mb-3">
                                {isSpanish ? "Contenido Generado (Editable)" : "Generated Content (Editable)"}
                              </label>
                              <textarea
                                value={manualContent}
                                onChange={(e) => setManualContent(e.target.value)}
                                className="w-full h-64 bg-slate-900 border border-slate-600 rounded-lg px-4 py-3 text-white font-mono text-sm placeholder-slate-400 focus:ring-2 focus:ring-yellow-500 focus:border-transparent resize-y"
                                placeholder={isSpanish ?
                                  'Pega aqu√≠ el JSON corregido...' :
                                  'Paste the corrected JSON here...'
                                }
                              />

                              <div className="bg-slate-900/50 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-2">
                                  {isSpanish ? "Formato esperado:" : "Expected format:"}
                                </p>
                                <pre className="text-green-400 text-xs font-mono">
                                  {`{
                              "titles": ["T√≠tulo 1", "T√≠tulo 2", "T√≠tulo 3", "T√≠tulo 4", "T√≠tulo 5"],
                              "thumbnails": ["Frase 1", "Frase 2", "Frase 3", "Frase 4", "Frase 5"],
                              "description": "Descripci√≥n SEO optimizada aqu√≠...",
                              "tags": ["tag1", "tag2", "tag3", "tag4", "tag5"],
                              "pinnedComment": "Comentario fijado sugerido aqu√≠...",
                              "communityPost": "Post para Community Tab aqu√≠...",
                              "script": "Gui√≥n completo aqu√≠..."
                            }`}
                                </pre>
                              </div>
                            </div>

                            {error && (
                              <div className="mt-4 p-4 bg-red-900/50 border border-red-700 rounded-lg">
                                <pre className="text-red-300 whitespace-pre-wrap text-sm">{error}</pre>
                              </div>
                            )}

                            <div className="flex justify-between mt-8">
                              <button
                                onClick={() => {
                                  setShowManualEditor(false);
                                  setError('');
                                }}
                                className="bg-slate-600 hover:bg-slate-700 text-white px-6 py-3 rounded-lg font-medium transition-colors"
                              >
                                {isSpanish ? "Cancelar" : "Cancel"}
                              </button>

                              <div className="flex space-x-3">
                                {isRetryingGeneration ? (
                                  <button
                                    disabled={true}
                                    className="bg-blue-600 text-white px-6 py-3 rounded-lg font-medium flex items-center opacity-50"
                                  >
                                    <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                                    {isSpanish ? "Reintentando..." : "Retrying..."}
                                  </button>
                                ) : (
                                  <button
                                    onClick={retryGeneration}
                                    className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                                  >
                                    <Zap className="w-4 h-4 mr-2" />
                                    {isSpanish ? "Intentar de Nuevo" : "Try Again"}
                                  </button>
                                )}

                                <button
                                  onClick={() => setManualContent('')}
                                  className="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition-colors"
                                >
                                  {isSpanish ? "Limpiar" : "Clear"}
                                </button>

                                {isProcessingManual ? (
                                  <button
                                    disabled={true}
                                    className="bg-yellow-600 text-white px-8 py-3 rounded-lg font-medium flex items-center opacity-50"
                                  >
                                    <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                                    {isSpanish ? "Procesando..." : "Processing..."}
                                  </button>
                                ) : (
                                  <button
                                    onClick={processManualContent}
                                    disabled={!manualContent.trim()}
                                    className="bg-yellow-600 hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-lg font-medium flex items-center transition-colors"
                                  >
                                    <Zap className="w-4 h-4 mr-2" />
                                    {isSpanish ? "Procesar JSON" : "Process JSON"}
                                  </button>
                                )}
                              </div>
                            </div>
                          </div>
                        )}

                        {/* Step 3 - Results */}
                        {currentStep === 3 && results && (
                          <div className="space-y-6">
                            {/* Editor Mode Toggle */}
                            <div className="flex justify-between items-center">
                              <h2 className="text-2xl font-bold text-white">
                                {isSpanish ? "Resultados Generados" : "Generated Results"}
                              </h2>
                              <div className="flex space-x-3">
                                {!isEditingResults ? (
                                  <button
                                    onClick={startEditingResults}
                                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium flex items-center transition-colors"
                                  >
                                    <Edit3 className="w-4 h-4 mr-2" />
                                    {isSpanish ? "Editar Resultados" : "Edit Results"}
                                  </button>
                                ) : (
                                  <div className="flex space-x-2">
                                    <button
                                      onClick={saveEditedResults}
                                      className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors"
                                    >
                                      {isSpanish ? "Guardar" : "Save"}
                                    </button>
                                    <button
                                      onClick={cancelEditing}
                                      className="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors"
                                    >
                                      {isSpanish ? "Cancelar" : "Cancel"}
                                    </button>
                                  </div>
                                )}
                                {currentStep === 3 && results && currentHistoryId && (
                                  <button
                                    onClick={() => toggleFavorite(currentHistoryId)}
                                    className={`px-4 py-2 rounded-lg font-medium flex items-center transition-colors ${scriptHistory.find(item => item.id === currentHistoryId && item.isFavorite)
                                      ? 'bg-yellow-600 hover:bg-yellow-700 text-white'
                                      : 'bg-slate-600 hover:bg-slate-700 text-white'
                                      }`}
                                    title={isSpanish ? "Marcar como favorito" : "Mark as favorite"}
                                  >
                                    {scriptHistory.find(item => item.id === currentHistoryId && item.isFavorite)
                                      ? <StarFilled className="w-4 h-4 mr-2" />
                                      : <Star className="w-4 h-4 mr-2" />}
                                    {scriptHistory.find(item => item.id === currentHistoryId && item.isFavorite)
                                      ? (isSpanish ? "Favorito" : "Favorited")
                                      : (isSpanish ? "Favorito" : "Favorite")}
                                  </button>
                                )}
                              </div>
                            </div>

                            {/* Titles */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <h3 className="text-xl font-bold text-white mb-4">
                                {isSpanish ? "T√≠tulos Sugeridos" : "Suggested Titles"}
                              </h3>
                              <div className="space-y-3">
                                {(isEditingResults ? editableResults.titles : results.titles).map((title, index) => (
                                  <div key={index} className="flex items-center justify-between bg-slate-900/50 p-4 rounded-lg">
                                    {isEditingResults ? (
                                      <input
                                        type="text"
                                        value={title}
                                        onChange={(e) => updateEditableTitle(index, e.target.value)}
                                        className="flex-1 bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                      />
                                    ) : (
                                      <span className="text-slate-200 flex-1">{title}</span>
                                    )}
                                    {!isEditingResults && (
                                      <button
                                        onClick={() => copyToClipboard(title)}
                                        className="ml-4 bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                      >
                                        {isSpanish ? "Copiar" : "Copy"}
                                      </button>
                                    )}
                                  </div>
                                ))}
                              </div>
                            </div>

                            {/* Thumbnails */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <h3 className="text-xl font-bold text-white mb-4">
                                {isSpanish ? "Frases para Miniaturas" : "Thumbnail Phrases"}
                              </h3>
                              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {(isEditingResults ? editableResults.thumbnails : results.thumbnails).map((thumb, index) => (
                                  <div key={index} className="bg-slate-900/50 p-4 rounded-lg text-center">
                                    {isEditingResults ? (
                                      <input
                                        type="text"
                                        value={thumb}
                                        onChange={(e) => updateEditableThumbnail(index, e.target.value)}
                                        className="w-full bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white text-center focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-2"
                                      />
                                    ) : (
                                      <>
                                        <div className="text-yellow-400 font-bold text-lg mb-2">{thumb}</div>
                                        <button
                                          onClick={() => copyToClipboard(thumb)}
                                          className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                        >
                                          {isSpanish ? "Copiar" : "Copy"}
                                        </button>
                                      </>
                                    )}
                                  </div>
                                ))}
                              </div>
                            </div>

                            {/* Description */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <h3 className="text-xl font-bold text-white mb-4">
                                {isSpanish ? "Descripci√≥n SEO" : "SEO Description"}
                              </h3>
                              <div className="bg-slate-900/50 p-4 rounded-lg">
                                {isEditingResults ? (
                                  <div>
                                    <textarea
                                      value={editableResults.description}
                                      onChange={(e) => updateEditableDescription(e.target.value)}
                                      className="w-full bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y"
                                      rows="4"
                                      maxLength={500}
                                    />
                                    <div className="text-right text-sm text-slate-400 mt-1">
                                      {editableResults.description.length}/500
                                    </div>
                                  </div>
                                ) : (
                                  <>
                                    <div className="text-slate-200 mb-3">{results.description}</div>
                                    <div className="flex justify-between items-center">
                                      <span className="text-sm text-slate-400">{results.description.length}/500 {isSpanish ? 'caracteres' : 'characters'}</span>
                                      <button
                                        onClick={() => copyToClipboard(results.description)}
                                        className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                      >
                                        {isSpanish ? "Copiar" : "Copy"}
                                      </button>
                                    </div>
                                  </>
                                )}
                              </div>
                            </div>

                            {/* Tags */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <h3 className="text-xl font-bold text-white mb-4">
                                {isSpanish ? "Tags Relevantes" : "Relevant Tags"}
                              </h3>
                              <div className="bg-slate-900/50 p-4 rounded-lg">
                                {isEditingResults ? (
                                  <div>
                                    <textarea
                                      value={editableResults.tags.join(', ')}
                                      onChange={(e) => updateEditableTags(e.target.value)}
                                      className="w-full bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y"
                                      rows="3"
                                      placeholder={isSpanish ? "tag1, tag2, tag3..." : "tag1, tag2, tag3..."}
                                    />
                                    <div className="text-right text-sm text-slate-400 mt-1">
                                      {editableResults.tags.length}/20 tags
                                    </div>
                                  </div>
                                ) : (
                                  <>
                                    <div className="flex flex-wrap gap-2 mb-3">
                                      {results.tags.map((tag, index) => (
                                        <span key={index} className="bg-blue-600 text-white px-2 py-1 rounded text-sm">
                                          #{tag}
                                        </span>
                                      ))}
                                    </div>
                                    <div className="flex justify-between items-center">
                                      <span className="text-sm text-slate-400">{results.tags.length}/20 tags</span>
                                      <button
                                        onClick={() => copyToClipboard(results.tags.join(', '))}
                                        className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                      >
                                        {isSpanish ? "Copiar" : "Copy"}
                                      </button>
                                    </div>
                                  </>
                                )}
                              </div>
                            </div>

                            {/* Pinned Comment */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <h3 className="text-xl font-bold text-white mb-4">
                                {isSpanish ? "Comentario Fijado Sugerido" : "Suggested Pinned Comment"}
                              </h3>
                              <div className="bg-slate-900/50 p-4 rounded-lg">
                                {isEditingResults ? (
                                  <textarea
                                    value={editableResults.pinnedComment}
                                    onChange={(e) => updateEditablePinnedComment(e.target.value)}
                                    className="w-full bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y"
                                    rows="3"
                                  />
                                ) : (
                                  <>
                                    <div className="text-slate-200 mb-3">{results.pinnedComment}</div>
                                    <button
                                      onClick={() => copyToClipboard(results.pinnedComment)}
                                      className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                    >
                                      {isSpanish ? "Copiar" : "Copy"}
                                    </button>
                                  </>
                                )}
                              </div>
                            </div>

                            {/* Community Post */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <h3 className="text-xl font-bold text-white mb-4">
                                {isSpanish ? "Post para Comunidad" : "Community Post"}
                              </h3>
                              <div className="bg-slate-900/50 p-4 rounded-lg">
                                {isEditingResults ? (
                                  <textarea
                                    value={editableResults.communityPost}
                                    onChange={(e) => updateEditableCommunityPost(e.target.value)}
                                    className="w-full bg-slate-800 border border-slate-600 rounded px-3 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y"
                                    rows="4"
                                  />
                                ) : (
                                  <>
                                    <div className="text-slate-200 mb-3 whitespace-pre-wrap">{results.communityPost}</div>
                                    <button
                                      onClick={() => copyToClipboard(results.communityPost)}
                                      className="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"
                                    >
                                      {isSpanish ? "Copiar" : "Copy"}
                                    </button>
                                  </>
                                )}
                              </div>
                            </div>

                            {/* Script */}
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-8 border border-slate-700">
                              <div className="flex items-center justify-between mb-4">
                                <h3 className="text-xl font-bold text-white">
                                  {isSpanish ? "Gui√≥n Completo" : "Complete Script"}
                                </h3>
                                {!isEditingResults && (
                                  <div className="flex space-x-2">
                                    <div className="text-sm text-slate-400 px-3 py-1 bg-slate-700 rounded">
                                      {(isEditingResults ? editableResults.script : results.script).split(' ').length} {isSpanish ? 'palabras' : 'words'}
                                    </div>
                                    <button
                                      onClick={() => copyToClipboard(results.script)}
                                      className="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors"
                                    >
                                      {isSpanish ? "Copiar Gui√≥n" : "Copy Script"}
                                    </button>
                                  </div>
                                )}
                              </div>
                              <div className="bg-slate-900/50 p-6 rounded-lg">
                                {isEditingResults ? (
                                  <textarea
                                    value={editableResults.script}
                                    onChange={(e) => updateEditableScript(e.target.value)}
                                    className="w-full h-96 bg-slate-800 border border-slate-600 rounded-lg px-4 py-3 text-white font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y"
                                  />
                                ) : (
                                  <pre className="text-slate-200 whitespace-pre-wrap font-mono text-sm leading-relaxed">
                                    {results.script}
                                  </pre>
                                )}
                              </div>
                              {isEditingResults && (
                                <div className="mt-4 text-sm text-slate-400">
                                  {editableResults.script.split(' ').length} {isSpanish ? 'palabras' : 'words'} ‚Ä¢
                                  {isSpanish ? ' Tiempo estimado: ' : ' Estimated time: '}
                                  {Math.ceil(editableResults.script.split(' ').length / 150)} {isSpanish ? 'minutos' : 'minutes'}
                                </div>
                              )}
                            </div>

                            {/* Actions */}
                            {!isEditingResults && (
                              <div className="flex justify-center space-x-4 flex-wrap gap-y-3">
                                <button
                                  onClick={() => setShowHistoryPanel(true)}
                                  className="bg-slate-600 hover:bg-slate-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                                >
                                  <History className="w-4 h-4 mr-2" />
                                  {isSpanish ? "Ver Historial" : "View History"}
                                </button>

                                <button
                                  onClick={() => setShowFavoritesPanel(true)}
                                  className="bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                                >
                                  <Star className="w-4 h-4 mr-2" />
                                  {isSpanish ? "Ver Favoritos" : "View Favorites"}
                                </button>
                                <button
                                  onClick={downloadResults}
                                  className="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                                >
                                  <Download className="w-4 h-4 mr-2" />
                                  {isSpanish ? "Descargar TXT" : "Download TXT"}
                                </button>

                                <button
                                  onClick={exportToPDF}
                                  className="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                                >
                                  <Download className="w-4 h-4 mr-2" />
                                  {isSpanish ? "Exportar PDF" : "Export PDF"}
                                </button>

                                <button
                                  onClick={regenerateContent}
                                  className="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium flex items-center transition-colors"
                                >
                                  <Zap className="w-4 h-4 mr-2" />
                                  {isSpanish ? "Generar de Nuevo" : "Generate Again"}
                                </button>

                                <button
                                  onClick={resetGenerator}
                                  className="bg-slate-600 hover:bg-slate-700 text-white px-6 py-3 rounded-lg font-medium transition-colors"
                                >
                                  {isSpanish ? "Nuevo Proyecto" : "New Project"}
                                </button>
                              </div>
                            )}
                          </div>
                        )}
                      </div>


                    </div>
                  )}


                </div>
              </div>


              {/* Footer */}
              <footer className="bg-slate-900/50 border-t border-slate-700 py-6 mt-12">
                <div className="container mx-auto px-4 text-center">
                  <p className="text-slate-400 text-sm">
                    Copyright ¬© 2025{" "}
                    <a
                      href="https://github.com/AndresV22"
                      target="_blank"
                      rel="noopener noreferrer"
                      className="text-purple-400 hover:text-purple-300 transition-colors font-medium"
                    >
                      AndresV22
                    </a>
                    {" "} ‚Ä¢ {" "}
                    <button
                      onClick={() => setShowInstallationGuide(true)}
                      className="text-blue-400 hover:text-blue-300 transition-colors font-medium"
                    >
                      {isSpanish ? "üìñ Gu√≠a de Instalaci√≥n" : "üìñ Installation Guide"}
                    </button>
                  </p>
                </div>
              </footer>
            </div>
            {/* Panel lateral en tiempo real */}
            {showRealTimePanel && (
              <div className="w-1/3 bg-slate-900/95 border-l border-slate-700 min-h-screen relative">
                <div className="sticky top-0 bg-slate-800 p-4 border-b border-slate-700 flex items-center justify-between">
                  <div className="flex items-center">
                    <div className={`w-3 h-3 rounded-full mr-2 ${isGenerating ? 'bg-green-500 animate-pulse' : 'bg-slate-500'}`}></div>
                    <h3 className="text-white font-medium">
                      {isSpanish ? "Respuesta en Tiempo Real" : "Real-time Response"}
                    </h3>
                  </div>
                  <div className="flex items-center space-x-2">
                    <button
                      onClick={() => setShowRealTimePanel(false)}
                      className="text-slate-400 hover:text-white transition-colors"
                      title={isSpanish ? "Cerrar panel" : "Close panel"}
                    >
                      <X />
                    </button>
                  </div>
                </div>

                <div
                  ref={realTimePanelRef}
                  className="p-4 h-[calc(100vh-80px)] overflow-y-auto"
                >
                  <div className="bg-slate-800/50 rounded-lg p-4 border border-slate-600">
                    <div className="flex items-center mb-3">
                      <span className="text-slate-300 text-sm">
                        {isGenerating ?
                          (isSpanish ? "Generando..." : "Generating...") :
                          (isSpanish ? "Listo" : "Ready")
                        }
                      </span>
                    </div>

                    <div className="space-y-2">
                      <pre className="text-green-400 font-mono text-xs leading-relaxed whitespace-pre-wrap">
                        {realTimeResponse || (isSpanish ?
                          "Presiona 'Generar Contenido' para ver la respuesta de Ollama en tiempo real. Si ya lo presionaste, espera a que inicie." :
                          "Press 'Generate Content' to see Ollama's response in real-time. If you have already pressed it, wait for it to start."
                        )}
                      </pre>
                    </div>

                    {realTimeResponse && (
                      <div className="mt-4 pt-3 border-t border-slate-600">
                        <button
                          onClick={() => copyToClipboard(realTimeResponse)}
                          className="text-xs bg-slate-700 hover:bg-slate-600 text-slate-300 px-2 py-1 rounded transition-colors"
                        >
                          {isSpanish ? "Copiar Log" : "Copy Log"}
                        </button>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            )}

            {/* Bot√≥n flotante para mostrar/ocultar panel */}
            {!showRealTimePanel && currentStep === 2 && (
              <button
                onClick={() => setShowRealTimePanel(true)}
                className="fixed right-4 top-1/2 transform -translate-y-1/2 bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-l-lg shadow-lg transition-colors z-10"
                title={isSpanish ? "Ver respuesta en tiempo real" : "Show real-time response"}
              >
                <Eye className="w-5 h-5" />
              </button>
            )}

            {ideaGenerationError && (
              <IdeaGeneratorError
                error={ideaGenerationError}
                onClose={() => setIdeaGenerationError('')}
              />
            )}

            {/* Modal de confirmaci√≥n de eliminaci√≥n */}
            <DeleteConfirmModal
              isOpen={showDeleteModal}
              onConfirm={handleConfirmDelete}
              onCancel={handleCancelDelete}
              language={formData.language}
            />
          </div>
        </div>
      );

    };

    ReactDOM.render(<YouTubeContentGenerator />, document.getElementById('root'));
  </script>
</body>

</html>